<Window x:Class="Kalendarz1.MarketIntelligence.Views.MarketIntelligenceWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Kalendarz1.MarketIntelligence.Views"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        Title="ðŸ“Š Market Intelligence - PiÃ³rkowscy"
        Height="900" Width="1400"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#0F172A">

    <Window.Resources>
        <!-- Dark Corporate Theme -->
        <SolidColorBrush x:Key="BgPrimary" Color="#0F172A"/>
        <SolidColorBrush x:Key="BgSecondary" Color="#1E293B"/>
        <SolidColorBrush x:Key="BgTertiary" Color="#334155"/>
        <SolidColorBrush x:Key="BgElevated" Color="#475569"/>

        <SolidColorBrush x:Key="AccentPrimary" Color="#6366F1"/>
        <SolidColorBrush x:Key="AccentLight" Color="#A5B4FC"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#E2E8F0"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#94A3B8"/>
        <SolidColorBrush x:Key="TextMuted" Color="#64748B"/>

        <SolidColorBrush x:Key="StatusSuccess" Color="#22C55E"/>
        <SolidColorBrush x:Key="StatusWarning" Color="#F59E0B"/>
        <SolidColorBrush x:Key="StatusDanger" Color="#EF4444"/>
        <SolidColorBrush x:Key="StatusInfo" Color="#3B82F6"/>

        <!-- Converters -->
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>

        <!-- Expander Style for Dark Theme -->
        <Style TargetType="Expander">
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
        </Style>

        <!-- Indicator Card Style -->
        <Style x:Key="IndicatorCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BgSecondary}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16,12"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="MinWidth" Value="180"/>
        </Style>

        <!-- Alert Panel Style -->
        <Style x:Key="AlertPanel" TargetType="Border">
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="0,4"/>
        </Style>

        <!-- Article Card Style -->
        <Style x:Key="ArticleCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BgSecondary}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,6"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- Tab Style -->
        <Style TargetType="TabItem">
            <Setter Property="Foreground" Value="{StaticResource TextSecondary}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Foreground" Value="{StaticResource AccentLight}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Button Style -->
        <Style x:Key="FilterButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource BgTertiary}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="4,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource BgElevated}"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Header -->
            <RowDefinition Height="Auto"/>
            <!-- Indicators -->
            <RowDefinition Height="Auto"/>
            <!-- Alerts -->
            <RowDefinition Height="*"/>
            <!-- Content -->
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <Border Grid.Row="0" Background="{StaticResource BgSecondary}" Padding="20,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸ“Š" FontSize="28" VerticalAlignment="Center" Margin="0,0,12,0"/>
                    <StackPanel>
                        <TextBlock Text="MARKET INTELLIGENCE"
                                   FontSize="20" FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimary}"/>
                        <TextBlock Text="Dashboard informacji rynkowych â€¢ PiÃ³rkowscy Sp. z o.o."
                                   FontSize="12"
                                   Foreground="{StaticResource TextSecondary}"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock x:Name="txtLastUpdate"
                               Text="Ostatnia aktualizacja: --"
                               Foreground="{StaticResource TextMuted}"
                               VerticalAlignment="Center"
                               Margin="0,0,16,0"/>
                    <Button x:Name="btnRefresh" Content="ðŸ”„ OdÅ›wieÅ¼"
                            Style="{StaticResource FilterButton}"
                            Click="BtnRefresh_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- INDICATORS BAR -->
        <Border Grid.Row="1" Background="{StaticResource BgPrimary}" Padding="16,8">
            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                <ItemsControl x:Name="icIndicators">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource IndicatorCard}" Cursor="Hand">
                                <StackPanel>
                                    <TextBlock Text="{Binding Name}"
                                               Foreground="{StaticResource TextSecondary}"
                                               FontSize="11"
                                               Margin="0,0,0,4"/>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding DisplayValue}"
                                                   Foreground="{StaticResource TextPrimary}"
                                                   FontSize="18"
                                                   FontWeight="Bold"/>
                                        <TextBlock Text="{Binding TrendIcon}"
                                                   FontSize="14"
                                                   Margin="8,0,0,0"
                                                   VerticalAlignment="Center">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="{StaticResource TextMuted}"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Trend}" Value="up">
                                                            <Setter Property="Foreground" Value="{StaticResource StatusSuccess}"/>
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Trend}" Value="down">
                                                            <Setter Property="Foreground" Value="{StaticResource StatusDanger}"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </StackPanel>
                                    <TextBlock Text="{Binding TrendValue}"
                                               Foreground="{StaticResource TextMuted}"
                                               FontSize="10"
                                               Margin="0,2,0,0"/>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>

        <!-- ALERTS PANEL -->
        <Border x:Name="pnlAlerts" Grid.Row="2" Background="{StaticResource BgPrimary}" Padding="16,8" Visibility="Collapsed">
            <ItemsControl x:Name="icAlerts">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource AlertPanel}">
                            <Border.Style>
                                <Style TargetType="Border" BasedOn="{StaticResource AlertPanel}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Severity}" Value="critical">
                                            <Setter Property="Background" Value="#7F1D1D"/>
                                            <Setter Property="BorderBrush" Value="#EF4444"/>
                                            <Setter Property="BorderThickness" Value="1"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Severity}" Value="warning">
                                            <Setter Property="Background" Value="#78350F"/>
                                            <Setter Property="BorderBrush" Value="#F59E0B"/>
                                            <Setter Property="BorderThickness" Value="1"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="{Binding SeverityIcon}"
                                           FontSize="16" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                <TextBlock Grid.Column="1" Text="{Binding Title}"
                                           Foreground="{StaticResource TextPrimary}"
                                           FontWeight="SemiBold"
                                           TextWrapping="Wrap"
                                           VerticalAlignment="Center"/>
                                <TextBlock Grid.Column="2" Text="{Binding FormattedDate}"
                                           Foreground="{StaticResource TextMuted}"
                                           VerticalAlignment="Center"
                                           Margin="12,0,0,0"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>

        <!-- MAIN CONTENT -->
        <Grid Grid.Row="3" Margin="16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <!-- Articles List -->
                <ColumnDefinition Width="8"/>
                <ColumnDefinition Width="*"/>
                <!-- Side Panel -->
            </Grid.ColumnDefinitions>

            <!-- LEFT: ARTICLES LIST -->
            <Border Grid.Column="0" Background="{StaticResource BgSecondary}" CornerRadius="8" Padding="16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Filters -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                        <ComboBox x:Name="cmbCategory" Width="150" Margin="0,0,8,0"
                                  SelectionChanged="CmbCategory_SelectionChanged">
                            <ComboBoxItem Content="Wszystkie" IsSelected="True"/>
                            <ComboBoxItem Content="HPAI"/>
                            <ComboBoxItem Content="Konkurencja"/>
                            <ComboBoxItem Content="Ceny"/>
                            <ComboBoxItem Content="Eksport"/>
                            <ComboBoxItem Content="Analizy"/>
                            <ComboBoxItem Content="Regulacje"/>
                            <ComboBoxItem Content="Swiat"/>
                            <ComboBoxItem Content="Klienci"/>
                            <ComboBoxItem Content="Pogoda"/>
                        </ComboBox>
                        <ComboBox x:Name="cmbSeverity" Width="120" Margin="0,0,8,0"
                                  SelectionChanged="CmbSeverity_SelectionChanged">
                            <ComboBoxItem Content="Wszystkie" IsSelected="True"/>
                            <ComboBoxItem Content="critical"/>
                            <ComboBoxItem Content="warning"/>
                            <ComboBoxItem Content="info"/>
                            <ComboBoxItem Content="positive"/>
                        </ComboBox>
                        <TextBox x:Name="txtSearch" Width="200"
                                 Background="{StaticResource BgTertiary}"
                                 Foreground="{StaticResource TextPrimary}"
                                 BorderThickness="0" Padding="8,6"
                                 Text=""
                                 TextChanged="TxtSearch_TextChanged">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Style.Triggers>
                                        <Trigger Property="Text" Value="">
                                            <Setter Property="Background" Value="{StaticResource BgTertiary}"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                    </StackPanel>

                    <!-- Articles -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="icArticles">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Style="{StaticResource ArticleCard}" Tag="{Binding Id}">
                                        <Expander IsExpanded="False">
                                            <Expander.Header>
                                                <Grid Width="500">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <!-- Header -->
                                                    <Grid Grid.Row="0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Grid.Column="0" Text="{Binding SeverityIcon}"
                                                                   FontSize="18" Margin="0,0,10,0" VerticalAlignment="Top"/>
                                                        <TextBlock Grid.Column="1" Text="{Binding Title}"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontWeight="SemiBold"
                                                                   FontSize="13"
                                                                   TextWrapping="Wrap"/>
                                                        <TextBlock Grid.Column="2" Text="{Binding FormattedDate}"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontSize="11" Margin="8,0,0,0"/>
                                                    </Grid>

                                                    <!-- Meta -->
                                                    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="28,6,0,0">
                                                        <Border CornerRadius="4" Padding="8,3" Margin="0,0,8,0">
                                                            <Border.Style>
                                                                <Style TargetType="Border">
                                                                    <Setter Property="Background" Value="{StaticResource BgTertiary}"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding Severity}" Value="critical">
                                                                            <Setter Property="Background" Value="#7F1D1D"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding Severity}" Value="warning">
                                                                            <Setter Property="Background" Value="#78350F"/>
                                                                        </DataTrigger>
                                                                        <DataTrigger Binding="{Binding Severity}" Value="positive">
                                                                            <Setter Property="Background" Value="#14532D"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Border.Style>
                                                            <TextBlock Text="{Binding CategoryBadge}"
                                                                       Foreground="{StaticResource TextSecondary}"
                                                                       FontSize="10" FontWeight="SemiBold"/>
                                                        </Border>
                                                        <TextBlock Text="{Binding Source}"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontSize="11"
                                                                   VerticalAlignment="Center"/>
                                                    </StackPanel>

                                                    <!-- Body Preview -->
                                                    <TextBlock Grid.Row="2" Text="{Binding ShortBody}"
                                                               Foreground="{StaticResource TextSecondary}"
                                                               FontSize="12"
                                                               TextWrapping="Wrap"
                                                               Margin="28,6,0,0"
                                                               MaxHeight="45"
                                                               TextTrimming="CharacterEllipsis"/>
                                                </Grid>
                                            </Expander.Header>

                                            <!-- Expanded Content -->
                                            <StackPanel Margin="28,12,0,0">
                                                <!-- Full Body -->
                                                <TextBlock Text="{Binding Body}"
                                                           Foreground="{StaticResource TextSecondary}"
                                                           FontSize="12"
                                                           LineHeight="20"
                                                           TextWrapping="Wrap"
                                                           Margin="0,0,0,12"/>

                                                <!-- AI Analysis Box -->
                                                <Border Background="#1E293B" CornerRadius="6" Padding="12"
                                                        BorderBrush="#F59E0B" BorderThickness="1,0,0,0"
                                                        Visibility="{Binding HasAiAnalysis, Converter={StaticResource BoolToVisibility}}">
                                                    <StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                            <TextBlock Text="ðŸ¤–" FontSize="14" Margin="0,0,6,0"/>
                                                            <TextBlock Text="ANALIZA AI DLA PIÃ“RKOWSCY"
                                                                       Foreground="#F59E0B"
                                                                       FontWeight="Bold"
                                                                       FontSize="11"/>
                                                        </StackPanel>
                                                        <TextBlock Text="{Binding AiAnalysis}"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontSize="12"
                                                                   LineHeight="20"
                                                                   TextWrapping="Wrap"/>
                                                    </StackPanel>
                                                </Border>

                                                <!-- Tags -->
                                                <TextBlock Text="{Binding Tags, StringFormat='Tagi: {0}'}"
                                                           Foreground="{StaticResource TextMuted}"
                                                           FontSize="10"
                                                           Margin="0,10,0,0"
                                                           Visibility="{Binding HasTags, Converter={StaticResource BoolToVisibility}}"/>
                                            </StackPanel>
                                        </Expander>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- RIGHT: SIDE PANEL -->
            <Border Grid.Column="2" Background="{StaticResource BgSecondary}" CornerRadius="8">
                <TabControl Background="Transparent" BorderThickness="0">
                    <TabItem Header="ðŸ’° Ceny">
                        <ScrollViewer Padding="16">
                            <StackPanel x:Name="pnlPrices">
                                <!-- Wykres historii cen skupu -->
                                <TextBlock Text="Historia cen skupu (30 dni)"
                                           Foreground="{StaticResource TextPrimary}"
                                           FontWeight="Bold" FontSize="14"
                                           Margin="0,0,0,8"/>
                                <Border Background="{StaticResource BgTertiary}" CornerRadius="6" Padding="8" Height="180">
                                    <lvc:CartesianChart x:Name="chartPriceHistory"
                                                        DisableAnimations="True"
                                                        Hoverable="True"
                                                        DataTooltip="{x:Null}">
                                        <lvc:CartesianChart.AxisX>
                                            <lvc:Axis x:Name="axisXPriceHistory"
                                                      ShowLabels="True"
                                                      Foreground="{StaticResource TextMuted}"
                                                      FontSize="10"/>
                                        </lvc:CartesianChart.AxisX>
                                        <lvc:CartesianChart.AxisY>
                                            <lvc:Axis MinValue="4" MaxValue="5.5"
                                                      Foreground="{StaticResource TextMuted}"
                                                      FontSize="10">
                                                <lvc:Axis.Separator>
                                                    <lvc:Separator StrokeThickness="0.5" Stroke="#334155"/>
                                                </lvc:Axis.Separator>
                                            </lvc:Axis>
                                        </lvc:CartesianChart.AxisY>
                                    </lvc:CartesianChart>
                                </Border>

                                <!-- Wykres elementÃ³w -->
                                <TextBlock Text="Ceny elementÃ³w (zÅ‚/kg)"
                                           Foreground="{StaticResource TextPrimary}"
                                           FontWeight="Bold" FontSize="14"
                                           Margin="0,16,0,8"/>
                                <Border Background="{StaticResource BgTertiary}" CornerRadius="6" Padding="8" Height="200">
                                    <lvc:CartesianChart x:Name="chartElements"
                                                        DisableAnimations="True">
                                        <lvc:CartesianChart.AxisX>
                                            <lvc:Axis x:Name="axisXElements"
                                                      ShowLabels="True"
                                                      Foreground="{StaticResource TextMuted}"
                                                      FontSize="10"
                                                      LabelsRotation="-45"/>
                                        </lvc:CartesianChart.AxisX>
                                        <lvc:CartesianChart.AxisY>
                                            <lvc:Axis MinValue="0"
                                                      Foreground="{StaticResource TextMuted}"
                                                      FontSize="10">
                                                <lvc:Axis.Separator>
                                                    <lvc:Separator StrokeThickness="0.5" Stroke="#334155"/>
                                                </lvc:Axis.Separator>
                                            </lvc:Axis>
                                        </lvc:CartesianChart.AxisY>
                                    </lvc:CartesianChart>
                                </Border>

                                <!-- Ceny pasz -->
                                <TextBlock Text="Pasze MATIF (EUR/t)"
                                           Foreground="{StaticResource TextPrimary}"
                                           FontWeight="Bold" FontSize="14"
                                           Margin="0,16,0,8"/>
                                <StackPanel x:Name="pnlFeedPrices"/>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>
                    <TabItem Header="ðŸ¢ Konkurencja">
                        <ScrollViewer Padding="16">
                            <ItemsControl x:Name="icCompetitors">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{StaticResource BgTertiary}"
                                                CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                            <StackPanel>
                                                <TextBlock Text="{Binding NameDisplay}"
                                                           Foreground="{StaticResource TextPrimary}"
                                                           FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding OwnershipDisplay}"
                                                           Foreground="{StaticResource TextSecondary}"
                                                           FontSize="11" Margin="0,4,0,0"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <TextBlock Text="{Binding Revenue}"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontSize="10"/>
                                                    <TextBlock Text=" â€¢ " Foreground="{StaticResource TextMuted}"/>
                                                    <TextBlock Text="{Binding DailyCapacity}"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontSize="10"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </TabItem>
                    <TabItem Header="ðŸ¦  HPAI">
                        <ScrollViewer Padding="16">
                            <StackPanel>
                                <TextBlock x:Name="txtHpaiSummary"
                                           Text="Ogniska HPAI 2026"
                                           Foreground="{StaticResource TextPrimary}"
                                           FontWeight="Bold" FontSize="16"
                                           Margin="0,0,0,12"/>
                                <ItemsControl x:Name="icHpai">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="{StaticResource BgTertiary}"
                                                    CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <StackPanel Grid.Column="0">
                                                        <TextBlock Text="{Binding RegionDisplay}"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontWeight="SemiBold"/>
                                                        <TextBlock Text="{Binding BirdsAffectedDisplay}"
                                                                   Foreground="{StaticResource TextSecondary}"
                                                                   FontSize="11"/>
                                                    </StackPanel>
                                                    <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                                                        <TextBlock Text="{Binding OutbreakCount}"
                                                                   Foreground="{StaticResource StatusDanger}"
                                                                   FontSize="20" FontWeight="Bold"/>
                                                        <TextBlock Text="ognisk"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontSize="10"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>
                    <TabItem Header="ðŸ‡ªðŸ‡º EU Benchmark">
                        <ScrollViewer Padding="16">
                            <StackPanel>
                                <TextBlock Text="Ceny drobiu w UE (EUR/100kg)"
                                           Foreground="{StaticResource TextPrimary}"
                                           FontWeight="Bold" FontSize="16"
                                           Margin="0,0,0,12"/>

                                <!-- Wykres sÅ‚upkowy EU Benchmark -->
                                <Border Background="{StaticResource BgTertiary}" CornerRadius="6" Padding="8" Height="220" Margin="0,0,0,16">
                                    <lvc:CartesianChart x:Name="chartEuBenchmark"
                                                        DisableAnimations="True">
                                        <lvc:CartesianChart.AxisX>
                                            <lvc:Axis x:Name="axisXBenchmark"
                                                      ShowLabels="True"
                                                      Foreground="{StaticResource TextMuted}"
                                                      FontSize="10"/>
                                        </lvc:CartesianChart.AxisX>
                                        <lvc:CartesianChart.AxisY>
                                            <lvc:Axis MinValue="0" MaxValue="280"
                                                      Foreground="{StaticResource TextMuted}"
                                                      FontSize="10">
                                                <lvc:Axis.Separator>
                                                    <lvc:Separator StrokeThickness="0.5" Stroke="#334155"/>
                                                </lvc:Axis.Separator>
                                            </lvc:Axis>
                                        </lvc:CartesianChart.AxisY>
                                    </lvc:CartesianChart>
                                </Border>

                                <TextBlock Text="SzczegÃ³Å‚y"
                                           Foreground="{StaticResource TextSecondary}"
                                           FontWeight="SemiBold" FontSize="12"
                                           Margin="0,0,0,8"/>
                                <ItemsControl x:Name="icBenchmark">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="{StaticResource BgTertiary}"
                                                    CornerRadius="6" Padding="12" Margin="0,0,0,6">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding CountryFlag}"
                                                               FontSize="20" Margin="0,0,8,0"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Country}"
                                                               Foreground="{StaticResource TextPrimary}"
                                                               FontWeight="SemiBold"
                                                               VerticalAlignment="Center"/>
                                                    <TextBlock Grid.Column="2"
                                                               Text="{Binding PricePer100kg, StringFormat={}{0:N1}}"
                                                               Foreground="{StaticResource TextPrimary}"
                                                               FontWeight="Bold"
                                                               VerticalAlignment="Center"
                                                               Margin="0,0,12,0"/>
                                                    <TextBlock Grid.Column="3" Text="{Binding ChangeFormatted}"
                                                               VerticalAlignment="Center" FontSize="11">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Foreground" Value="{StaticResource TextMuted}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding ChangeMonthPercent, Converter={x:Static local:PositiveConverter.Instance}}" Value="True">
                                                                        <Setter Property="Foreground" Value="{StaticResource StatusSuccess}"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>
            </Border>
        </Grid>

        <!-- Loading Overlay -->
        <Border x:Name="pnlLoading" Grid.RowSpan="4"
                Background="#CC0F172A" Visibility="Visible">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="â³" FontSize="48" HorizontalAlignment="Center"/>
                <TextBlock Text="Åadowanie danych Market Intelligence..."
                           Foreground="{StaticResource TextPrimary}"
                           FontSize="16" Margin="0,16,0,0"/>
                <TextBlock x:Name="txtLoadingStatus"
                           Text="Inicjalizacja tabel..."
                           Foreground="{StaticResource TextMuted}"
                           FontSize="12" Margin="0,8,0,0"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
