<Window x:Class="Kalendarz1.AnkietyHodowcow.Top20ReportWindowEnhanced"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="🏆 TOP 20 Hodowców - Raport" 
        Height="900" Width="1600"
        WindowStartupLocation="CenterScreen">
    
    <Window.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#F5F7FA" Offset="0"/>
            <GradientStop Color="#E8EEF5" Offset="1"/>
        </LinearGradientBrush>
    </Window.Background>

    <Window.Resources>
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="#007ACC"/>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground">
                <Setter.Value>
                    <SolidColorBrush Color="White"/>
                </Setter.Value>
            </Setter>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding">
                <Setter.Value>
                    <Thickness>20,10,20,10</Thickness>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderThickness">
                <Setter.Value>
                    <Thickness>0</Thickness>
                </Setter.Value>
            </Setter>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="5"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <SolidColorBrush Color="#005A9E"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <SolidColorBrush Color="#004275"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="PrintButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="#27AE60"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <SolidColorBrush Color="#229954"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <SolidColorBrush Color="#1E8449"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="StatCard" TargetType="Border">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="White" Offset="0"/>
                        <GradientStop Color="#F8F9FA" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding">
                <Setter.Value>
                    <Thickness>20,15,20,15</Thickness>
                </Setter.Value>
            </Setter>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="10" ShadowDepth="3"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Background">
                <Setter.Value>
                    <SolidColorBrush Color="White"/>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderBrush">
                <Setter.Value>
                    <SolidColorBrush Color="#BDC3C7"/>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderThickness">
                <Setter.Value>
                    <Thickness>0</Thickness>
                </Setter.Value>
            </Setter>
            <Setter Property="RowBackground">
                <Setter.Value>
                    <SolidColorBrush Color="White"/>
                </Setter.Value>
            </Setter>
            <Setter Property="AlternatingRowBackground">
                <Setter.Value>
                    <SolidColorBrush Color="#F8F9FA"/>
                </Setter.Value>
            </Setter>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush">
                <Setter.Value>
                    <SolidColorBrush Color="#ECF0F1"/>
                </Setter.Value>
            </Setter>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
            <Setter Property="ColumnHeaderHeight" Value="45"/>
            <Setter Property="RowHeight" Value="42"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#34495E" Offset="0"/>
                        <GradientStop Color="#2C3E50" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground">
                <Setter.Value>
                    <SolidColorBrush Color="White"/>
                </Setter.Value>
            </Setter>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding">
                <Setter.Value>
                    <Thickness>10,10,10,10</Thickness>
                </Setter.Value>
            </Setter>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="Padding">
                <Setter.Value>
                    <Thickness>10,8,10,8</Thickness>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderThickness">
                <Setter.Value>
                    <Thickness>0</Thickness>
                </Setter.Value>
            </Setter>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <SolidColorBrush Color="#3498DB"/>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Foreground">
                        <Setter.Value>
                            <SolidColorBrush Color="White"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridRow">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <SolidColorBrush Color="#E8F4F8"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="CenterAlignedCell" TargetType="TextBlock">
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <Style x:Key="RightAlignedCell" TargetType="TextBlock">
            <Setter Property="TextAlignment" Value="Right"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin">
                <Setter.Value>
                    <Thickness>0,0,10,0</Thickness>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.Margin>
            <Thickness>30</Thickness>
        </Grid.Margin>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with Logo -->
        <Grid Grid.Row="0">
            <Grid.Margin>
                <Thickness>0,0,0,15</Thickness>
            </Grid.Margin>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Logo -->
            <Border Grid.Column="0" 
                    Width="100" 
                    Height="100" 
                    CornerRadius="10"
                    Background="White"
                    VerticalAlignment="Center"
                    Margin="0,0,20,0">
                <Border.Effect>
                    <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="10" ShadowDepth="3"/>
                </Border.Effect>
                <Image x:Name="LogoImage" 
                       Stretch="Uniform" 
                       Margin="10"/>
            </Border>

            <!-- Title -->
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <TextBlock Text="🏆 TOP 20 HODOWCÓW" 
                           FontSize="32"
                           FontWeight="Bold"
                           Foreground="#2C3E50"/>
                <TextBlock Text="Ranking według sumarycznej punktacji" 
                           FontSize="16"
                           Foreground="#7F8C8D"
                           Margin="0,5,0,0"/>
                <TextBlock x:Name="DateTextBlock" 
                           FontSize="13"
                           Foreground="#95A5A6"
                           Margin="0,3,0,0"/>
            </StackPanel>
        </Grid>

        <!-- Summary Stats -->
        <Grid Grid.Row="1">
            <Grid.Margin>
                <Thickness>0,10,0,20</Thickness>
            </Grid.Margin>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource StatCard}" Margin="0,0,10,0">
                <StackPanel>
                    <TextBlock Text="📊 Hodowców" 
                               FontSize="12" 
                               Foreground="#7F8C8D" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="TotalCountTextBlock" 
                               FontSize="28" 
                               FontWeight="Bold" 
                               Foreground="#3498DB"
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="1" Style="{StaticResource StatCard}" Margin="0,0,10,0">
                <StackPanel>
                    <TextBlock Text="📈 Średnia" 
                               FontSize="12" 
                               Foreground="#7F8C8D" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="AvgScoreTextBlock" 
                               FontSize="28" 
                               FontWeight="Bold" 
                               Foreground="#27AE60"
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="2" Style="{StaticResource StatCard}" Margin="0,0,10,0">
                <StackPanel>
                    <TextBlock Text="🥇 Najwyższa" 
                               FontSize="12" 
                               Foreground="#7F8C8D" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="MaxScoreTextBlock" 
                               FontSize="28" 
                               FontWeight="Bold" 
                               Foreground="#F39C12"
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="3" Style="{StaticResource StatCard}" Margin="0,0,10,0">
                <StackPanel>
                    <TextBlock Text="🥉 Najniższa" 
                               FontSize="12" 
                               Foreground="#7F8C8D" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="MinScoreTextBlock" 
                               FontSize="28" 
                               FontWeight="Bold" 
                               Foreground="#E74C3C"
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="4" Style="{StaticResource StatCard}">
                <StackPanel>
                    <TextBlock Text="✅ Ocen" 
                               FontSize="12" 
                               Foreground="#7F8C8D" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="TotalRatingsTextBlock" 
                               FontSize="28" 
                               FontWeight="Bold" 
                               Foreground="#9B59B6"
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center">
            <StackPanel.Margin>
                <Thickness>0,0,0,20</Thickness>
            </StackPanel.Margin>
            <Button x:Name="PrintButton" 
                    Content="🖨️ Drukuj Raport" 
                    Style="{StaticResource PrintButton}"
                    Click="PrintButton_Click"
                    Width="180">
                <Button.Margin>
                    <Thickness>0,0,10,0</Thickness>
                </Button.Margin>
            </Button>
            <Button x:Name="ExportButton" 
                    Content="💾 Eksportuj CSV" 
                    Style="{StaticResource ModernButton}"
                    Click="ExportButton_Click"
                    Width="180"/>
        </StackPanel>

        <!-- DataGrid -->
        <Border Grid.Row="3" 
                CornerRadius="10"
                Background="White">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.15" BlurRadius="15" ShadowDepth="5"/>
            </Border.Effect>
            <DataGrid x:Name="Top20DataGrid" Margin="0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="🥇" 
                                        Binding="{Binding Miejsce}" 
                                        Width="60"
                                        ElementStyle="{StaticResource CenterAlignedCell}"/>
                    <DataGridTextColumn Header="Hodowca / Dostawca" 
                                        Binding="{Binding Dostawca}" 
                                        Width="*"
                                        MinWidth="200"/>
                    <DataGridTextColumn Header="Dostaw" 
                                        Binding="{Binding LiczbaOcen}" 
                                        Width="80"
                                        ElementStyle="{StaticResource CenterAlignedCell}"/>
                    <DataGridTextColumn Header="Suma Pkt" 
                                        Binding="{Binding SumaPunktow, StringFormat='{}{0:N1}'}" 
                                        Width="110"
                                        ElementStyle="{StaticResource RightAlignedCell}"/>
                    <DataGridTextColumn Header="💰 Cena" 
                                        Binding="{Binding SredniaCena, StringFormat='{}{0:N2}'}" 
                                        Width="100"
                                        ElementStyle="{StaticResource RightAlignedCell}"/>
                    <DataGridTextColumn Header="🚚 Transport" 
                                        Binding="{Binding SredniaTransport, StringFormat='{}{0:N2}'}" 
                                        Width="110"
                                        ElementStyle="{StaticResource RightAlignedCell}"/>
                    <DataGridTextColumn Header="💬 Komunikacja" 
                                        Binding="{Binding SredniaKomunikacja, StringFormat='{}{0:N2}'}" 
                                        Width="130"
                                        ElementStyle="{StaticResource RightAlignedCell}"/>
                    <DataGridTextColumn Header="🔄 Elastyczność" 
                                        Binding="{Binding SredniaElastycznosc, StringFormat='{}{0:N2}'}" 
                                        Width="130"
                                        ElementStyle="{StaticResource RightAlignedCell}"/>
                    <DataGridTextColumn Header="🐔 Stan Ptaków" 
                                        Binding="{Binding SredniaStanPtakow, StringFormat='{}{0:N2}'}" 
                                        Width="130"
                                        ElementStyle="{StaticResource RightAlignedCell}"/>
                    <DataGridTextColumn Header="⭐ Średnia" 
                                        Binding="{Binding SredniaOgolna, StringFormat='{}{0:N2}'}" 
                                        Width="110"
                                        ElementStyle="{StaticResource RightAlignedCell}"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Footer -->
        <Border Grid.Row="4" 
                Background="#ECF0F1" 
                CornerRadius="5" 
                Padding="15"
                Margin="0,15,0,0">
            <TextBlock Text="* Ranking uwzględnia wszystkie kategorie ocen: Cena, Transport, Komunikacja, Elastyczność i Stan Ptaków. Wyświetlono TOP 20 hodowców z najwyższą sumaryczną punktacją." 
                       FontSize="11" 
                       Foreground="#7F8C8D" 
                       TextWrapping="Wrap"
                       HorizontalAlignment="Center"/>
        </Border>
    </Grid>
</Window>
