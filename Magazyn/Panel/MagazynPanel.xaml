<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="Kalendarz1.MagazynPanel"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Panel Magazynier"
        WindowState="Maximized"
        WindowStyle="None"
        Background="#1C1E26"
        FontFamily="Segoe UI">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <!-- Style for the top buttons - compact for touch -->
        <Style x:Key="TopButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="40"/>
            <Setter Property="Width" Value="80"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#787878"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Property=Background}"
                                BorderBrush="{TemplateBinding Property=BorderBrush}"
                                BorderThickness="{TemplateBinding Property=BorderThickness}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                                <Setter TargetName="border" Property="BorderBrush" Value="#969696"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- General Style for DataGrids -->
        <Style x:Key="CustomDataGridStyle" TargetType="DataGrid">
            <Setter Property="Background" Value="#2D2F3E"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="RowBackground" Value="#373946"/>
            <Setter Property="AlternatingRowBackground" Value="#32343F"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#464858"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Height" Value="36"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Padding" Value="5"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Grid Background="{TemplateBinding Property=Background}">
                            <ContentPresenter VerticalAlignment="Center"
                                              Margin="5,2"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGridRow">
            <Setter Property="Foreground" Value="White"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ROW 0: PRZYCISKI TOWAROW - kompaktowe -->
        <Border Grid.Row="0" Background="#1A3A5A" Padding="4">
            <WrapPanel x:Name="pnlProductButtons" Orientation="Horizontal" HorizontalAlignment="Center">
                <!-- Przyciski towarow dodane dynamicznie z obrazkami -->
            </WrapPanel>
        </Border>

        <!-- ROW 1: TOP BAR - kompaktowy z przyciskami zakladek -->
        <Border Grid.Row="1" Background="#24262F" Padding="6,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Data po lewej -->
                <TextBlock x:Name="lblData" Grid.Column="0" Text="2025-10-23 Sroda"
                           Foreground="White" FontSize="22" FontWeight="Bold"
                           VerticalAlignment="Center" Margin="0,0,15,0"/>

                <!-- Przelaczniki zakladek + legenda -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,15,0">
                    <Button x:Name="btnTabZamowienia" Content="ðŸ“¦ ZamÃ³wienia"
                            Background="#4A7A5A" Foreground="White" FontSize="13" FontWeight="Bold"
                            Height="36" Padding="14,0" Margin="0,0,4,0" Cursor="Hand"
                            Click="btnTabZamowienia_Click" BorderThickness="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="bd" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="bd" Property="Opacity" Value="0.85"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button x:Name="btnTabHistoria" Content="ðŸ“‹ Historia"
                            Background="#3A3C48" Foreground="#AAAAAA" FontSize="13" FontWeight="Bold"
                            Height="36" Padding="14,0" Cursor="Hand"
                            Click="btnTabHistoria_Click" BorderThickness="0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="bd" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="bd" Property="Opacity" Value="0.85"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>

                    <!-- Legenda ikon - duza, obok zakladek -->
                    <Border Background="#2A2A2A" CornerRadius="6" Padding="10,4" Margin="12,0,0,0" VerticalAlignment="Center">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="âš ï¸ Strefa" Foreground="#FF6B6B" FontSize="13" FontWeight="SemiBold" Margin="0,0,12,0" VerticalAlignment="Center"/>
                            <TextBlock Text="ðŸ”ª Halal" Foreground="#4DB6AC" FontSize="13" FontWeight="SemiBold" Margin="0,0,12,0" VerticalAlignment="Center"/>
                            <TextBlock Text="ðŸŽžï¸ Folia" Foreground="#64B5F6" FontSize="13" FontWeight="SemiBold" Margin="0,0,12,0" VerticalAlignment="Center"/>
                            <TextBlock Text="ðŸ“¦ 40/pal" Foreground="#999999" FontSize="13" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Przyciski nawigacji w srodku -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button x:Name="btnPrev" Content="â—€ Wczoraj" Style="{StaticResource TopButtonStyle}"
                            Background="#3A5A7A" Click="btnPrev_Click" Margin="0,0,6,0"/>
                    <Button x:Name="btnToday" Content="ðŸ“… DziÅ›" Style="{StaticResource TopButtonStyle}"
                            Background="#4A7A5A" Click="btnToday_Click" Margin="0,0,6,0"/>
                    <Button x:Name="btnNext" Content="Jutro â–¶" Style="{StaticResource TopButtonStyle}"
                            Background="#3A5A7A" Click="btnNext_Click" Margin="0,0,6,0"/>
                    <Button x:Name="btnRefresh" Content="ðŸ”„ OdÅ›wieÅ¼" Style="{StaticResource TopButtonStyle}"
                            Background="#5A6A7A" Click="btnRefresh_Click" Margin="12,0,0,0"/>
                </StackPanel>

                <!-- Checkbox i zamknij po prawej -->
                <StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center">
                    <CheckBox x:Name="chkShowShipmentsOnly"
                              Content="Wydania bez zamÃ³wieÅ„"
                              Foreground="White"
                              FontSize="12"
                              FontWeight="SemiBold"
                              VerticalAlignment="Center"
                              Margin="0,0,12,0"
                              Checked="chkShowShipmentsOnly_CheckedChanged"
                              Unchecked="chkShowShipmentsOnly_CheckedChanged"/>

                    <Button x:Name="btnClose" Content="âŒ Zamknij" Style="{StaticResource TopButtonStyle}"
                            Background="#8A3A3A" Click="btnClose_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ROW 2: CONTENT - przelaczane panele -->
        <Grid Grid.Row="2">

            <!-- ========== PANEL ZAMOWIENIA ========== -->
            <Grid x:Name="pnlZamowienia" Background="#1C1E26">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1.5*"/>
                    <ColumnDefinition Width="1.5*"/>
                    <ColumnDefinition Width="1*"/>
                </Grid.ColumnDefinitions>

                <!-- LEFT: Pierwsza kolumna zamowien -->
                <Border Grid.Column="0" Background="#262832" CornerRadius="5" Margin="5,5,0,5">
                    <DataGrid x:Name="dgvZamowienia1"
                              ItemsSource="{Binding ZamowieniaList1}"
                              Style="{StaticResource CustomDataGridStyle}"
                              SelectionChanged="dgvZamowienia_SelectionChanged"
                              IsReadOnly="True"
                              RowHeight="50"
                              Margin="5">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow" BasedOn="{StaticResource {x:Type DataGridRow}}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Status}" Value="Wydany">
                                        <Setter Property="BorderBrush" Value="LimeGreen"/>
                                        <Setter Property="BorderThickness" Value="3"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="Klient" Width="2*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="âš ï¸" Foreground="#FF6B6B" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasStrefa, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="ðŸ”ª" Foreground="#4DB6AC" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasHalal, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="ðŸŽžï¸" Foreground="#64B5F6" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasFolia, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="ðŸ“¦" Foreground="#999999" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasE2, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="{Binding Klient}" Foreground="{Binding KlientColor}" FontWeight="SemiBold" TextTrimming="CharacterEllipsis" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Kg" Binding="{Binding TotalIlosc, StringFormat=N0}" Width="0.6*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Margin" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Wyjazd" Binding="{Binding CzasWyjazdDisplay}" Width="1*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="Orange"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Pojazd" Binding="{Binding PojazdDisplay}" Width="0.9*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="LightSkyBlue"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="1.1*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="{Binding StatusColor}"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="FontSize" Value="12"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>

                <!-- MIDDLE: Druga kolumna zamowien -->
                <Border Grid.Column="1" Background="#22242E" CornerRadius="5" Margin="5,5,0,5">
                    <DataGrid x:Name="dgvZamowienia2"
                              ItemsSource="{Binding ZamowieniaList2}"
                              Style="{StaticResource CustomDataGridStyle}"
                              SelectionChanged="dgvZamowienia_SelectionChanged"
                              IsReadOnly="True"
                              RowHeight="50"
                              Margin="5">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow" BasedOn="{StaticResource {x:Type DataGridRow}}">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Status}" Value="Wydany">
                                        <Setter Property="BorderBrush" Value="LimeGreen"/>
                                        <Setter Property="BorderThickness" Value="3"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="Klient" Width="2*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <TextBlock Text="âš ï¸" Foreground="#FF6B6B" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasStrefa, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="ðŸ”ª" Foreground="#4DB6AC" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasHalal, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="ðŸŽžï¸" Foreground="#64B5F6" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasFolia, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="ðŸ“¦" Foreground="#999999" FontSize="13" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding HasE2, Converter={StaticResource BoolToVis}}"/>
                                            <TextBlock Text="{Binding Klient}" Foreground="{Binding KlientColor}" FontWeight="SemiBold" TextTrimming="CharacterEllipsis" VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="Kg" Binding="{Binding TotalIlosc, StringFormat=N0}" Width="0.6*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Margin" Value="0,0,5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Wyjazd" Binding="{Binding CzasWyjazdDisplay}" Width="1*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="Orange"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Pojazd" Binding="{Binding PojazdDisplay}" Width="0.9*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="LightSkyBlue"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="1.1*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="{Binding StatusColor}"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="FontSize" Value="12"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>

                <!-- RIGHT: Szczegoly zamowienia -->
                <Grid Grid.Column="2" Margin="5,5,5,5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="150"/>
                    </Grid.RowDefinitions>

                    <!-- Informacje o kliencie i transporcie -->
                    <Border Grid.Row="0" Background="#2A2C38" CornerRadius="5" Padding="12" Margin="0,0,0,4">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="ðŸ¢ Klient:" Foreground="LightGray" FontSize="14" Margin="0,3"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" x:Name="txtKlient" Text="--" Foreground="White" FontSize="14" FontWeight="Bold" Margin="8,3"/>

                            <TextBlock Grid.Row="0" Grid.Column="2" Text="ðŸ’¼ Handlowiec:" Foreground="LightGray" FontSize="14" Margin="14,3,0,3"/>
                            <TextBlock Grid.Row="0" Grid.Column="3" x:Name="txtHandlowiec" Text="--" Foreground="#90CAF9" FontSize="14" FontWeight="Bold" Margin="8,3"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="â° Wyjazd:" Foreground="LightGray" FontSize="14" Margin="0,3"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" x:Name="txtCzasWyjazdu" Text="--" Foreground="Orange" FontSize="14" FontWeight="Bold" Margin="8,3"/>

                            <TextBlock Grid.Row="1" Grid.Column="2" Text="ðŸš— Pojazd:" Foreground="LightGray" FontSize="14" Margin="14,3,0,3"/>
                            <TextBlock Grid.Row="1" Grid.Column="3" x:Name="txtPojazd" Text="--" Foreground="LightSkyBlue" FontSize="14" FontWeight="Bold" Margin="8,3"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="ðŸ‘¤ Kierowca:" Foreground="LightGray" FontSize="14" Margin="0,3"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3" x:Name="txtKierowca" Text="--" Foreground="White" FontSize="14" FontWeight="Bold" Margin="8,3"/>

                            <!-- Informacja o wydaniu -->
                            <TextBlock Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="4"
                                       x:Name="txtShipmentInfo"
                                       Text=""
                                       Foreground="LimeGreen"
                                       FontSize="14"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       Margin="0,3,0,3"/>

                            <!-- Przycisk oznacz jako wydane -->
                            <Button Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="4"
                                    x:Name="btnMarkAsShipped"
                                    Content="âœ… Oznacz jako WYDANE"
                                    Click="btnMarkAsShipped_Click"
                                    Background="#2A7A3A"
                                    Foreground="White"
                                    FontSize="16"
                                    FontWeight="Bold"
                                    Height="42"
                                    Margin="0,3,0,0"
                                    Cursor="Hand">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="8"
                                                            BorderBrush="LimeGreen"
                                                            BorderThickness="2">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#3A9A4A"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <Button Grid.Row="4" Grid.Column="0" Grid.ColumnSpan="4"
                                    x:Name="btnUndoShipment"
                                    Content="â†©ï¸ COFNIJ - Status 'Nowe'"
                                    Click="btnUndoShipment_Click"
                                    Background="#8A3A3A"
                                    Foreground="White"
                                    FontSize="16"
                                    FontWeight="Bold"
                                    Height="42"
                                    Margin="0,3,0,0"
                                    Cursor="Hand"
                                    Visibility="Collapsed">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="8"
                                                            BorderBrush="OrangeRed"
                                                            BorderThickness="2">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#AA4A4A"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <!-- Przycisk przyjecia zmiany -->
                            <Button Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="4"
                                    x:Name="btnAcceptChange"
                                    Content="âœ… PrzyjmujÄ™ zmianÄ™"
                                    Click="btnAcceptChange_Click"
                                    Background="#B45309"
                                    Foreground="White"
                                    FontSize="13"
                                    FontWeight="Bold"
                                    Height="36"
                                    Margin="0,3,0,0"
                                    Cursor="Hand"
                                    Visibility="Collapsed">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="8"
                                                            BorderBrush="Orange"
                                                            BorderThickness="2">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#D97706"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Lista towarow do wydania -->
                    <Border Grid.Row="1" Background="#262832" CornerRadius="5" Margin="0,4">
                        <DataGrid x:Name="dgvPozycje"
                                  Style="{StaticResource CustomDataGridStyle}"
                                  IsReadOnly="True"
                                  RowHeight="32"
                                  Margin="5">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="Produkt" Width="2*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                                <TextBlock Text="âš ï¸" Foreground="#FF6B6B" FontSize="12" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding Strefa, Converter={StaticResource BoolToVis}}"/>
                                                <TextBlock Text="ðŸ”ª" Foreground="#4DB6AC" FontSize="12" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding Halal, Converter={StaticResource BoolToVis}}"/>
                                                <TextBlock Text="ðŸŽžï¸" Foreground="#64B5F6" FontSize="12" Margin="0,0,2,0" VerticalAlignment="Center" Visibility="{Binding Folia, Converter={StaticResource BoolToVis}}"/>
                                                <TextBlock Text="ðŸ“¦" Foreground="#999999" FontSize="12" Margin="0,0,4,0" VerticalAlignment="Center" Visibility="{Binding E2, Converter={StaticResource BoolToVis}}"/>
                                                <TextBlock Text="{Binding Produkt}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                                                <Image Source="{Binding ProduktImg}" Width="24" Height="24" Margin="4,0,2,0" RenderOptions.BitmapScalingMode="HighQuality"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="ZamÃ³wiono (kg)" Binding="{Binding [ZamÃ³wiono (kg)], StringFormat=N0}" Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="Margin" Value="0,0,5,0"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Wydano (kg)" Binding="{Binding [Wydano (kg)], StringFormat=N0}" Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="Margin" Value="0,0,5,0"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="RÃ³Å¼nica (kg)" Binding="{Binding [RÃ³Å¼nica (kg)], StringFormat=N0}" Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="Margin" Value="0,0,5,0"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Zmiana" Binding="{Binding Zmiana}" Width="*">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Center"/>
                                            <Setter Property="Foreground" Value="Orange"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <!-- Legenda ikon -->
                    <Border Grid.Row="2" Background="#2A2A2A" CornerRadius="4" Padding="6,2" Margin="0,1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="âš ï¸ Strefa" Foreground="#FF6B6B" FontSize="10" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="ðŸ”ª Halal" Foreground="#4DB6AC" FontSize="10" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="ðŸŽžï¸ Folia" Foreground="#64B5F6" FontSize="10" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="ðŸ“¦ 40/paleta" Foreground="#999999" FontSize="10" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <!-- Notatka zamowienia -->
                    <TextBlock Grid.Row="3" Text="Notatka zamÃ³wienia" Background="#323440" Foreground="Yellow" FontWeight="Bold" FontSize="12" Padding="5,3"/>

                    <Border Grid.Row="4" Background="#343642" CornerRadius="5" Margin="0,3,0,0">
                        <TextBox x:Name="txtUwagi" Background="Transparent"
                                 Foreground="White" BorderThickness="0"
                                 TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                                 FontSize="20" Margin="5" IsReadOnly="True"/>
                    </Border>
                </Grid>
            </Grid>

            <!-- ========== PANEL HISTORIA WYDAN ========== -->
            <Grid x:Name="pnlHistoria" Background="#1C1E26" Visibility="Collapsed">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Naglowek z filtrem dat -->
                <Border Grid.Row="0" Background="#262832" Padding="8" Margin="5">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="Zakres dat:" Foreground="White" FontSize="13" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <DatePicker x:Name="dpHistoriaOd" Width="130" Background="#3A3C48" Foreground="White"/>
                        <TextBlock Text=" â€” " Foreground="White" FontSize="13" VerticalAlignment="Center"/>
                        <DatePicker x:Name="dpHistoriaDo" Width="130" Background="#3A3C48" Foreground="White"/>
                        <Button x:Name="btnLoadHistoria" Content="ðŸ” PokaÅ¼"
                                Style="{StaticResource TopButtonStyle}"
                                Background="#4A7A5A"
                                Margin="12,0,0,0"
                                Click="btnLoadHistoria_Click"/>
                        <Button x:Name="btnHistoriaToday" Content="ðŸ“… DziÅ›"
                                Style="{StaticResource TopButtonStyle}"
                                Background="#3A5A7A"
                                Margin="8,0,0,0"
                                Click="btnHistoriaToday_Click"/>
                        <Button x:Name="btnHistoriaWeek" Content="ðŸ“† TydzieÅ„"
                                Style="{StaticResource TopButtonStyle}"
                                Background="#3A5A7A"
                                Margin="8,0,0,0"
                                Click="btnHistoriaWeek_Click"/>
                        <Button x:Name="btnHistoriaMonth" Content="ðŸ“† MiesiÄ…c"
                                Style="{StaticResource TopButtonStyle}"
                                Background="#3A5A7A"
                                Margin="8,0,0,0"
                                Click="btnHistoriaMonth_Click"/>
                    </StackPanel>
                </Border>

                <!-- Filtry dodatkowe -->
                <Border Grid.Row="1" Background="#2A2C38" Padding="8" Margin="5,0,5,5">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="Kto wydaÅ‚:" Foreground="White" FontSize="13" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox x:Name="cmbHistoriaUzytkownik" Width="170" Height="32" FontSize="13"
                                  SelectionChanged="cmbHistoriaFilter_SelectionChanged"/>

                        <TextBlock Text="Klient:" Foreground="White" FontSize="13" VerticalAlignment="Center" Margin="20,0,6,0"/>
                        <ComboBox x:Name="cmbHistoriaKlient" Width="190" Height="32" FontSize="13"
                                  SelectionChanged="cmbHistoriaFilter_SelectionChanged"/>

                        <TextBlock Text="Status:" Foreground="White" FontSize="13" VerticalAlignment="Center" Margin="20,0,6,0"/>
                        <ComboBox x:Name="cmbHistoriaStatus" Width="130" Height="32" FontSize="13"
                                  SelectionChanged="cmbHistoriaFilter_SelectionChanged">
                            <ComboBoxItem Content="Wszystkie" IsSelected="True"/>
                            <ComboBoxItem Content="âœ… PeÅ‚ne"/>
                            <ComboBoxItem Content="âš ï¸ Z rÃ³Å¼nicami"/>
                        </ComboBox>

                        <Button x:Name="btnHistoriaClearFilters" Content="âœ– WyczyÅ›Ä‡ filtry"
                                Style="{StaticResource TopButtonStyle}"
                                Background="#5A4A4A"
                                Margin="20,0,0,0"
                                Click="btnHistoriaClearFilters_Click"/>
                    </StackPanel>
                </Border>

                <!-- Tabela historii wydan -->
                <Border Grid.Row="2" Background="#262832" CornerRadius="5" Margin="5">
                    <DataGrid x:Name="dgvHistoriaWydan"
                              Style="{StaticResource CustomDataGridStyle}"
                              IsReadOnly="True"
                              RowHeight="45"
                              Margin="5"
                              AutoGenerateColumns="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Data wydania" Binding="{Binding DataWydania, StringFormat=yyyy-MM-dd HH:mm}" Width="140">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#90CAF9"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Klient" Binding="{Binding Klient}" Width="*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="IloÅ›Ä‡ (kg)" Binding="{Binding IloscKg, StringFormat=N0}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Margin" Value="0,0,10,0"/>
                                        <Setter Property="Foreground" Value="#FFD700"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Kto wydaÅ‚" Binding="{Binding KtoWydal}" Width="150">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#81C784"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Status" Binding="{Binding StatusWydania}" Width="120">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Uwagi" Binding="{Binding Uwagi}" Width="*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#B0BEC5"/>
                                        <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>

                <!-- Podsumowanie -->
                <Border Grid.Row="3" Background="#1E3A2A" Padding="12" Margin="5">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="ÅÄ…cznie wydaÅ„: " Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                        <TextBlock x:Name="lblHistoriaCount" Text="0" Foreground="#FFD700" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                        <TextBlock Text="  |  Suma kg: " Foreground="White" FontSize="14" VerticalAlignment="Center" Margin="16,0,0,0"/>
                        <TextBlock x:Name="lblHistoriaSumaKg" Text="0" Foreground="#4CAF50" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                        <TextBlock Text="  |  PeÅ‚ne wydania: " Foreground="White" FontSize="14" VerticalAlignment="Center" Margin="16,0,0,0"/>
                        <TextBlock x:Name="lblHistoriaPelne" Text="0" Foreground="#81C784" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                        <TextBlock Text="  |  Z rÃ³Å¼nicami: " Foreground="White" FontSize="14" VerticalAlignment="Center" Margin="16,0,0,0"/>
                        <TextBlock x:Name="lblHistoriaRoznice" Text="0" Foreground="#FFCC80" FontSize="18" FontWeight="Bold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>

        </Grid>
    </Grid>
</Window>
