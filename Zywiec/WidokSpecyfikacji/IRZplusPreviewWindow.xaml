<Window x:Class="Kalendarz1.IRZplusPreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="IRZplus - Podglad i wyslanie zgloszenia"
        WindowState="Maximized"
        MinHeight="700" MinWidth="1200"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <Style x:Key="PrimaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#1976D2"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#1565C0"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#0D47A1"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#BDBDBD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SendButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#388E3C"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="25,12"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2E7D32"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1B5E20"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#BDBDBD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#757575"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#616161"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="WarningButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#F57C00"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#EF6C00"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Naglowek -->
        <Border Grid.Row="0" Background="#1976D2" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="IRZplus - Zgloszenie uboju drobiu"
                               FontSize="22" FontWeight="Bold" Foreground="White"/>
                    <TextBlock x:Name="txtSubtitle" Text="Podglad danych przed wyslaniem do ARiMR"
                               FontSize="13" Foreground="#BBDEFB" Margin="0,3,0,0"/>
                </StackPanel>
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border x:Name="borderEnv" Background="#FF9800" CornerRadius="3" Padding="10,5" Margin="0,0,10,0">
                        <TextBlock x:Name="txtEnvironment" Text="SRODOWISKO TESTOWE" FontSize="11" FontWeight="Bold" Foreground="White"/>
                    </Border>
                    <Button Content="Ustawienia" Click="BtnSettings_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Panel podsumowania -->
        <Border Grid.Row="1" Background="White" Padding="10,8" BorderBrush="Black" BorderThickness="0,0,0,2" Margin="10,5,10,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <StackPanel Margin="0,0,20,0">
                        <TextBlock Text="Data uboju:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtDataUboju" Text="-" FontSize="14" FontWeight="Bold" Foreground="#1976D2"/>
                    </StackPanel>
                    <StackPanel Margin="0,0,20,0">
                        <TextBlock Text="Dostawcy:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtLiczbaDostawcow" Text="0" FontSize="14" FontWeight="Bold" Foreground="#424242"/>
                    </StackPanel>
                    <StackPanel Margin="0,0,20,0">
                        <TextBlock Text="Suma szt:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtSumaSztuk" Text="0" FontSize="14" FontWeight="Bold" Foreground="#424242"/>
                    </StackPanel>
                    <StackPanel Margin="0,0,20,0">
                        <TextBlock Text="Waga netto:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtSumaWagi" Text="0 kg" FontSize="14" FontWeight="Bold" Foreground="#424242"/>
                    </StackPanel>
                    <StackPanel Margin="0,0,20,0">
                        <TextBlock Text="Padle:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtSumaPadlych" Text="0" FontSize="14" FontWeight="Bold" Foreground="#D32F2F"/>
                    </StackPanel>
                    <StackPanel Margin="0,0,20,0">
                        <TextBlock Text="KG zapl:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtSumaKgDoZapl" Text="0" FontSize="14" FontWeight="Bold" Foreground="#1976D2"/>
                    </StackPanel>
                    <StackPanel Margin="0,0,20,0">
                        <TextBlock Text="Konfi szt:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtSumaKgKonfiskat" Text="0" FontSize="14" FontWeight="Bold" Foreground="#FF9800"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="Padle szt:" FontSize="10" Foreground="#757575"/>
                        <TextBlock x:Name="txtSumaKgPadlych" Text="0" FontSize="14" FontWeight="Bold" Foreground="#D32F2F"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="Zaznacz wszystkie" Click="BtnSelectAll_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                    <Button Content="Odznacz wszystkie" Click="BtnDeselectAll_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                    <Button Content="Odswiez" Click="BtnRefresh_Click" Style="{StaticResource PrimaryButtonStyle}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- DataGrid ze specyfikacjami -->
        <Border Grid.Row="2" BorderBrush="Black" BorderThickness="2" Margin="10">
        <DataGrid x:Name="dgSpecyfikacje"
                  AutoGenerateColumns="False"
                  IsReadOnly="False"
                  SelectionMode="Extended"
                  SelectionUnit="FullRow"
                  CanUserSortColumns="True"
                  GridLinesVisibility="All"
                  HorizontalGridLinesBrush="Black"
                  VerticalGridLinesBrush="Black"
                  AlternatingRowBackground="#F5F5F5"
                  RowBackground="White"
                  BorderThickness="0"
                  FontSize="12"
                  RowHeight="28"
                  ColumnHeaderHeight="32">

            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="#37474F"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                    <Setter Property="FontSize" Value="11"/>
                    <Setter Property="Padding" Value="6,4"/>
                    <Setter Property="BorderBrush" Value="Black"/>
                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>

            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="Padding" Value="4,2"/>
                    <Setter Property="BorderBrush" Value="Black"/>
                    <Setter Property="BorderThickness" Value="0,0,1,0"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="DataGridCell">
                                <Border Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        Padding="{TemplateBinding Padding}">
                                    <ContentPresenter VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#BBDEFB"/>
                            <Setter Property="Foreground" Value="Black"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.CellStyle>

            <DataGrid.Columns>
                <!-- Kolumna wyboru -->
                <DataGridCheckBoxColumn Header="" Binding="{Binding Wybrana, UpdateSourceTrigger=PropertyChanged}" Width="30"/>
                <!-- A: Kolejnosc auta -->
                <DataGridTextColumn Header="Nr" Binding="{Binding KolejnoscAuta}" Width="30" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                            <Setter Property="Foreground" Value="#1976D2"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <!-- B: Hodowca -->
                <DataGridTextColumn Header="Hodowca" Binding="{Binding Hodowca}" Width="130" IsReadOnly="True"/>
                <!-- C: Id na produkcji -->
                <DataGridTextColumn Header="Id" Binding="{Binding IdHodowcy}" Width="45" IsReadOnly="True"/>
                <!-- D: IRZ PLUS - edytowalne z mozliwoscia zapisu do bazy -->
                <DataGridTemplateColumn Header="IRZ PLUS" Width="130">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="30"/>
                                </Grid.ColumnDefinitions>
                                <TextBox Grid.Column="0"
                                         Text="{Binding IRZPlus, UpdateSourceTrigger=PropertyChanged}"
                                         FontWeight="Bold"
                                         Foreground="#1565C0"
                                         BorderThickness="1"
                                         BorderBrush="#BBDEFB"
                                         Padding="4,2"
                                         VerticalContentAlignment="Center"/>
                                <Button Grid.Column="1"
                                        Content="&#x2714;"
                                        ToolTip="Zapisz IRZPlus do bazy dla tego hodowcy"
                                        Click="BtnSaveIRZPlus_Click"
                                        Tag="{Binding}"
                                        Background="#4CAF50"
                                        Foreground="White"
                                        FontWeight="Bold"
                                        BorderThickness="0"
                                        Cursor="Hand"
                                        Width="28"
                                        Margin="2,0,0,0"/>
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <!-- E: Numer Partii z przyciskiem Kopiuj -->
                <DataGridTemplateColumn Header="Numer Partii" Width="140" IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" Text="{Binding NumerPartii}" VerticalAlignment="Center" Margin="2,0"/>
                                <Button x:Name="btnKopiuj" Grid.Column="1" Content="Kopiuj"
                                        Click="BtnKopiujPartie_Click"
                                        Tag="{Binding NumerPartii}"
                                        Background="#E3F2FD"
                                        Foreground="#1976D2"
                                        FontSize="10"
                                        Padding="6,2"
                                        Margin="4,0"
                                        Cursor="Hand"
                                        ToolTip="Kopiuj numer partii do schowka">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="BorderThickness" Value="1"/>
                                            <Setter Property="BorderBrush" Value="#1976D2"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#1976D2"/>
                                                    <Setter Property="Foreground" Value="White"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <!-- F: Liczba Sztuk Drobiu (zdatne) -->
                <DataGridTextColumn Header="Szt" Binding="{Binding LiczbaSztukDrobiu, StringFormat=N0}" Width="60" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <!-- KG Do zapl. (PayWgt) -->
                <DataGridTextColumn Header="KG" Binding="{Binding KgDoZaplaty, StringFormat=N0}" Width="70" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Foreground" Value="#1976D2"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <!-- Szt Konfiskat -->
                <DataGridTextColumn Header="Konf" Binding="{Binding KgKonfiskat, StringFormat=N0}" Width="45" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Foreground" Value="#FF9800"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <!-- Szt Padlych -->
                <DataGridTextColumn Header="Padl" Binding="{Binding KgPadlych, StringFormat=N0}" Width="45" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Foreground" Value="#D32F2F"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <!-- G: Typ Zdarzenia -->
                <DataGridTextColumn Header="Typ Zdarzenia" Binding="{Binding TypZdarzenia}" Width="140" IsReadOnly="True"/>
                <!-- H: Data zdarzenia -->
                <DataGridTextColumn Header="Data" Binding="{Binding DataZdarzenia, StringFormat='{}{0:dd-MM-yyyy}'}" Width="80" IsReadOnly="True"/>
                <!-- I: Kraj Wywozu -->
                <DataGridTextColumn Header="Kraj" Binding="{Binding KrajWywozu}" Width="40" IsReadOnly="True"/>
                <!-- J: Przyjete z dzialalnosci (obliczane) -->
                <DataGridTextColumn Header="Przyjete z dzial." Binding="{Binding PrzyjetaZDzialalnosci}" Width="120" IsReadOnly="True">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#388E3C"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <!-- K: nr.dok.Arimr (edytowalne) -->
                <DataGridTextColumn Header="nr.dok.Arimr" Binding="{Binding NrDokArimr, UpdateSourceTrigger=PropertyChanged}" Width="100"/>
                <!-- L: przybycie (edytowalne) -->
                <DataGridTextColumn Header="przybycie" Binding="{Binding Przybycie, UpdateSourceTrigger=PropertyChanged}" Width="80"/>
                <!-- M: padniecia (edytowalne) -->
                <DataGridTextColumn Header="padniecia" Binding="{Binding Padniecia, UpdateSourceTrigger=PropertyChanged}" Width="80"/>
            </DataGrid.Columns>
        </DataGrid>
        </Border>

        <!-- Panel walidacji/ostrzezen -->
        <Border x:Name="borderWarnings" Grid.Row="3" Background="#FFF3E0" Padding="15" Margin="10,0,10,10"
                BorderBrush="#FFB74D" BorderThickness="1" CornerRadius="4" Visibility="Collapsed">
            <StackPanel>
                <TextBlock Text="Ostrzezenia:" FontWeight="Bold" Foreground="#E65100" Margin="0,0,0,5"/>
                <TextBlock x:Name="txtWarnings" TextWrapping="Wrap" Foreground="#E65100"/>
            </StackPanel>
        </Border>

        <!-- Panel akcji -->
        <Border Grid.Row="4" Background="#ECEFF1" Padding="10,8" BorderBrush="Black" BorderThickness="0,2,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="txtStatus" Text="Gotowe do wyslania" VerticalAlignment="Center" FontSize="14" Foreground="#616161"/>
                    <ProgressBar x:Name="progressBar" Width="200" Height="20" Margin="20,0,0,0" Visibility="Collapsed"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Zapisz dane IRZ" Click="BtnSaveIRZFields_Click" Style="{StaticResource PrimaryButtonStyle}" ToolTip="Zapisz nr.dok.Arimr, przybycie i padniecia do bazy"/>
                    <Button Content="Zapisz lokalna kopie" Click="BtnSaveLocal_Click" Style="{StaticResource WarningButtonStyle}"/>
                    <Button x:Name="btnExportDialog" Content="Eksport do pliku (XML/CSV)" Click="BtnExportDialog_Click" Style="{StaticResource WarningButtonStyle}" ToolTip="Eksportuj dane do pliku XML lub CSV - do recznego importu w portalu IRZplus gdy API nie dziala"/>
                    <Button x:Name="btnSend" Content="Wyslij do IRZplus" Click="BtnSend_Click" Style="{StaticResource SendButtonStyle}"/>
                    <Button Content="Anuluj" Click="BtnCancel_Click" Style="{StaticResource SecondaryButtonStyle}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Konfetti Canvas (overlay na calym oknie) -->
        <Canvas x:Name="confettiCanvas" Grid.Row="0" Grid.RowSpan="5" IsHitTestVisible="False"/>
    </Grid>
</Window>
