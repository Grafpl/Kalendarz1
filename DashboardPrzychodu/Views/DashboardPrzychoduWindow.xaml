<Window x:Class="Kalendarz1.DashboardPrzychodu.Views.DashboardPrzychoduWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:Kalendarz1.DashboardPrzychodu.Converters"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Dashboard Przychodu Zywca - LIVE"
        Height="900" Width="1400"
        MinHeight="700" MinWidth="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#1c1917">

    <Window.Resources>
        <!-- ============================================ -->
        <!-- PALETA KOLORÃ“W - WARM INDUSTRIAL -->
        <!-- ============================================ -->

        <!-- TÅA -->
        <Color x:Key="BgMain">#1c1917</Color>
        <Color x:Key="BgPanel">#292524</Color>
        <Color x:Key="BgDark">#44403c</Color>
        <Color x:Key="BgDarker">#57534e</Color>

        <!-- TEKST -->
        <Color x:Key="TextPrimary">#e7e5e4</Color>
        <Color x:Key="TextSecondary">#a8a29e</Color>
        <Color x:Key="TextMuted">#78716c</Color>

        <!-- AKCENTY -->
        <Color x:Key="Amber">#f59e0b</Color>
        <Color x:Key="AmberLight">#fbbf24</Color>
        <Color x:Key="Green">#22c55e</Color>
        <Color x:Key="Red">#ef4444</Color>
        <Color x:Key="RedDark">#7f1d1d</Color>
        <Color x:Key="Blue">#60a5fa</Color>
        <Color x:Key="Purple">#c084fc</Color>

        <!-- BRUSHE -->
        <SolidColorBrush x:Key="BgMainBrush" Color="{StaticResource BgMain}"/>
        <SolidColorBrush x:Key="BgPanelBrush" Color="{StaticResource BgPanel}"/>
        <SolidColorBrush x:Key="BgDarkBrush" Color="{StaticResource BgDark}"/>
        <SolidColorBrush x:Key="BgDarkerBrush" Color="{StaticResource BgDarker}"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="{StaticResource TextPrimary}"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="{StaticResource TextSecondary}"/>
        <SolidColorBrush x:Key="TextMutedBrush" Color="{StaticResource TextMuted}"/>
        <SolidColorBrush x:Key="AmberBrush" Color="{StaticResource Amber}"/>
        <SolidColorBrush x:Key="AmberLightBrush" Color="{StaticResource AmberLight}"/>
        <SolidColorBrush x:Key="GreenBrush" Color="{StaticResource Green}"/>
        <SolidColorBrush x:Key="RedBrush" Color="{StaticResource Red}"/>
        <SolidColorBrush x:Key="RedDarkBrush" Color="{StaticResource RedDark}"/>
        <SolidColorBrush x:Key="BlueBrush" Color="{StaticResource Blue}"/>
        <SolidColorBrush x:Key="PurpleBrush" Color="{StaticResource Purple}"/>

        <!-- KompatybilnoÅ›Ä‡ wsteczna -->
        <SolidColorBrush x:Key="StatusOKBrush" Color="{StaticResource Green}"/>
        <SolidColorBrush x:Key="StatusWarningBrush" Color="{StaticResource AmberLight}"/>
        <SolidColorBrush x:Key="StatusErrorBrush" Color="{StaticResource Red}"/>

        <!-- KONWERTERY -->
        <conv:StatusToBackgroundConverter x:Key="StatusToBackgroundConverter"/>
        <conv:StatusToColorConverter x:Key="StatusToColorConverter"/>
        <conv:OdchylenieToColorConverter x:Key="OdchylenieToColorConverter"/>
        <conv:OdchylenieToIconConverter x:Key="OdchylenieToIconConverter"/>
        <conv:OdchylenieToBarColorConverter x:Key="OdchylenieToBarColorConverter"/>
        <conv:ProblemToRowBackgroundConverter x:Key="ProblemToRowBackgroundConverter"/>
        <conv:StatusToIconConverter x:Key="StatusToIconConverter"/>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <conv:NullToDashConverter x:Key="NullToDashConverter"/>
        <conv:TrendToColorConverter x:Key="TrendToColorConverter"/>
        <conv:InverseBoolToVisibilityConverter x:Key="InverseBoolToVisibilityConverter"/>
        <conv:AlertToColorConverter x:Key="AlertToColorConverter"/>

        <!-- ============================================ -->
        <!-- STYLE PRZYCISKÃ“W -->
        <!-- ============================================ -->

        <!-- Przycisk Amber (gÅ‚Ã³wny akcent) -->
        <Style x:Key="BtnAmber" TargetType="Button">
            <Setter Property="Background" Value="#f59e0b"/>
            <Setter Property="Foreground" Value="#1c1917"/>
            <Setter Property="FontSize" Value="9"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="8,3"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="3"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#fbbf24"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Przycisk Sidebar -->
        <Style x:Key="SidebarBtn" TargetType="Button">
            <Setter Property="Background" Value="#1c1917"/>
            <Setter Property="Foreground" Value="#a8a29e"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#44403c"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="3" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#292524"/>
                    <Setter Property="Foreground" Value="#e7e5e4"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Przycisk Bottom Bar -->
        <Style x:Key="BottomBtn" TargetType="Button">
            <Setter Property="Background" Value="#44403c"/>
            <Setter Property="Foreground" Value="#a8a29e"/>
            <Setter Property="FontSize" Value="9"/>
            <Setter Property="Padding" Value="10,4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="3"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#57534e"/>
                    <Setter Property="Foreground" Value="#e7e5e4"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="BottomBtnDanger" TargetType="Button" BasedOn="{StaticResource BottomBtn}">
            <Setter Property="Background" Value="#7f1d1d"/>
            <Setter Property="Foreground" Value="#fca5a5"/>
        </Style>

        <!-- ============================================ -->
        <!-- STYLE DATAGRID -->
        <!-- ============================================ -->

        <Style x:Key="DgHeader" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#44403c"/>
            <Setter Property="Foreground" Value="#a8a29e"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#57534e"/>
        </Style>

        <Style x:Key="DgRow" TargetType="DataGridRow">
            <Setter Property="Background" Value="#1c1917"/>
            <Setter Property="Foreground" Value="#e7e5e4"/>
            <Setter Property="BorderThickness" Value="3,0,0,0"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="FontSize" Value="12"/>
            <Style.Triggers>
                <Trigger Property="AlternationIndex" Value="1">
                    <Setter Property="Background" Value="#292524"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#44403c"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#44403c"/>
                </Trigger>
                <DataTrigger Binding="{Binding JestProblem}" Value="True">
                    <Setter Property="Background" Value="#2D1F1F"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DgCell" TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="6,2"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Padding="{TemplateBinding Padding}" Background="Transparent">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#44403c"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ModernDataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#e7e5e4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RowBackground" Value="#1c1917"/>
            <Setter Property="AlternatingRowBackground" Value="#292524"/>
            <Setter Property="AlternationCount" Value="2"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="RowHeight" Value="34"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="EnableRowVirtualization" Value="True"/>
            <Setter Property="EnableColumnVirtualization" Value="True"/>
        </Style>

        <!-- ============================================ -->
        <!-- CONTEXT MENUS -->
        <!-- ============================================ -->

        <!-- Menu Logo -->
        <ContextMenu x:Key="LogoContextMenu" Background="#292524" BorderBrush="#44403c" Foreground="#e7e5e4">
            <MenuItem Header="Wybierz logo firmy" IsEnabled="False" Foreground="#78716c"/>
            <Separator Background="#44403c"/>
            <MenuItem Header="ðŸ­  Fabryka (domyÅ›lne)" Click="Logo_SetEmoji" Tag="ðŸ­"/>
            <MenuItem Header="ðŸ”  Kurczak" Click="Logo_SetEmoji" Tag="ðŸ”"/>
            <MenuItem Header="ðŸ—  Udko kurczaka" Click="Logo_SetEmoji" Tag="ðŸ—"/>
            <MenuItem Header="ðŸ“  Kogut" Click="Logo_SetEmoji" Tag="ðŸ“"/>
            <MenuItem Header="ðŸ¥©  MiÄ™so" Click="Logo_SetEmoji" Tag="ðŸ¥©"/>
            <Separator Background="#44403c"/>
            <MenuItem Header="ðŸ“  Wybierz z pliku..." Click="Logo_SelectFile"/>
        </ContextMenu>

        <!-- Menu Ikon KPI -->
        <ContextMenu x:Key="IconContextMenu" Background="#292524" BorderBrush="#44403c" Foreground="#e7e5e4">
            <MenuItem x:Name="IconMenuTitle" Header="Wybierz ikonÄ™" IsEnabled="False" Foreground="#78716c"/>
            <Separator Background="#44403c"/>
            <MenuItem Header="ðŸ”  Kurczak" Click="Icon_SetEmoji" Tag="ðŸ”"/>
            <MenuItem Header="ðŸ—  Udko" Click="Icon_SetEmoji" Tag="ðŸ—"/>
            <MenuItem Header="ðŸ“¦  Paczka" Click="Icon_SetEmoji" Tag="ðŸ“¦"/>
            <MenuItem Header="ðŸ“Š  Wykres" Click="Icon_SetEmoji" Tag="ðŸ“Š"/>
            <MenuItem Header="ðŸ“ˆ  Trend â†‘" Click="Icon_SetEmoji" Tag="ðŸ“ˆ"/>
            <MenuItem Header="ðŸ“‰  Trend â†“" Click="Icon_SetEmoji" Tag="ðŸ“‰"/>
            <MenuItem Header="âœ“   Check" Click="Icon_SetEmoji" Tag="âœ“"/>
            <MenuItem Header="âœ…  Green check" Click="Icon_SetEmoji" Tag="âœ…"/>
            <MenuItem Header="â³  Klepsydra" Click="Icon_SetEmoji" Tag="â³"/>
            <MenuItem Header="âš–ï¸  Waga" Click="Icon_SetEmoji" Tag="âš–ï¸"/>
            <MenuItem Header="ðŸŽ¯  Cel" Click="Icon_SetEmoji" Tag="ðŸŽ¯"/>
            <MenuItem Header="ðŸ’°  PieniÄ…dze" Click="Icon_SetEmoji" Tag="ðŸ’°"/>
        </ContextMenu>

        <!-- DatePicker style -->
        <Style x:Key="DarkDatePicker" TargetType="DatePicker">
            <Setter Property="Background" Value="#292524"/>
            <Setter Property="Foreground" Value="#e7e5e4"/>
            <Setter Property="BorderBrush" Value="#44403c"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="FontSize" Value="10"/>
            <Style.Resources>
                <Style TargetType="DatePickerTextBox">
                    <Setter Property="Background" Value="#292524"/>
                    <Setter Property="Foreground" Value="#e7e5e4"/>
                    <Setter Property="CaretBrush" Value="#e7e5e4"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="DatePickerTextBox">
                                <Border Background="#292524" CornerRadius="3" Padding="4,2">
                                    <ScrollViewer x:Name="PART_ContentHost" Background="Transparent"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Style.Resources>
        </Style>

    </Window.Resources>

    <!-- ============================================ -->
    <!-- GÅÃ“WNY LAYOUT - 4 WIERSZE -->
    <!-- ============================================ -->
    <Grid Margin="6">
        <Grid.RowDefinitions>
            <RowDefinition Height="28"/>   <!-- TOP BAR -->
            <RowDefinition Height="36"/>   <!-- KPI STRIP -->
            <RowDefinition Height="*"/>    <!-- MAIN (Sidebar + Table) -->
            <RowDefinition Height="26"/>   <!-- BOTTOM BAR -->
        </Grid.RowDefinitions>

        <!-- ============================================ -->
        <!-- ROW 0: TOP BAR (28px) -->
        <!-- ============================================ -->
        <Border Grid.Row="0" Background="#292524" CornerRadius="5" Padding="8,0">
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- LOGO - PPM do zmiany -->
                    <Border x:Name="LogoBox" Width="22" Height="22" Background="#44403c"
                            CornerRadius="3" Cursor="Hand" MouseRightButtonUp="LogoBox_RightClick">
                        <TextBlock x:Name="LogoIcon" Text="ðŸ­" FontSize="13"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>

                    <TextBlock Text="PRZYCHÃ“D Å»YWCA" FontSize="12" FontWeight="Bold"
                               Foreground="#fbbf24" Margin="8,0,0,0" VerticalAlignment="Center"/>

                    <Border Background="#f59e0b" CornerRadius="6" Padding="5,1" Margin="8,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="â— LIVE" FontSize="7" FontWeight="Bold" Foreground="#1c1917"/>
                    </Border>

                    <Rectangle Width="1" Height="16" Fill="#44403c" Margin="12,0"/>

                    <TextBlock Text="ðŸ“…" FontSize="10" VerticalAlignment="Center"/>
                    <DatePicker x:Name="dpData" SelectedDate="{x:Static sys:DateTime.Today}"
                                Width="100" Style="{StaticResource DarkDatePicker}" Margin="4,0,0,0"/>
                    <TextBlock x:Name="txtDataDisplay" Text="" FontSize="9"
                               Foreground="#78716c" Margin="6,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <TextBox x:Name="txtSearch" Width="140" FontSize="9" Padding="6,3"
                             Background="#1c1917" Foreground="#e7e5e4" BorderBrush="#44403c"
                             BorderThickness="1" VerticalContentAlignment="Center"/>
                    <Button Content="ðŸ”„ OdÅ›wieÅ¼" Style="{StaticResource BtnAmber}" Click="BtnRefresh_Click" Margin="8,0,0,0"/>
                    <TextBlock FontSize="9" Foreground="#78716c" Margin="10,0,0,0" VerticalAlignment="Center">
                        <Run Text="Auto: "/><Run x:Name="txtAutoRefresh" Text="30s" Foreground="#fbbf24"/>
                    </TextBlock>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================ -->
        <!-- ROW 1: KPI STRIP (36px) - 6 kafelkÃ³w -->
        <!-- ============================================ -->
        <UniformGrid Grid.Row="1" Columns="6" Margin="0,4,0,0">

            <!-- PLAN -->
            <Border Background="#292524" CornerRadius="4" Margin="0,0,2,0" Padding="6,3"
                    BorderThickness="0,0,0,2" BorderBrush="#f59e0b"
                    MouseRightButtonUp="KpiIcon_RightClick" Tag="plan" Cursor="Hand"
                    ToolTip="Planowana dostawa Å¼ywca wg deklaracji hodowcÃ³w">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="IcoPlan" Text="ðŸ”" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <StackPanel>
                        <TextBlock Text="PLAN" FontSize="7" Foreground="#78716c" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="txtKgPlan" Text="0" FontSize="13" FontWeight="Bold" Foreground="#fbbf24"/>
                            <TextBlock Text=" kg" FontSize="8" Foreground="#78716c" VerticalAlignment="Bottom" Margin="0,0,0,1"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- ZWAÅ»ONE -->
            <Border Background="#292524" CornerRadius="4" Margin="2,0" Padding="6,3"
                    BorderThickness="0,0,0,2" BorderBrush="#22c55e"
                    MouseRightButtonUp="KpiIcon_RightClick" Tag="zwazone" Cursor="Hand"
                    ToolTip="Å»ywiec juÅ¼ zwaÅ¼ony na wadze przyjÄ™cia">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="IcoZwazone" Text="âœ“" FontSize="14" Foreground="#22c55e"
                               VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <StackPanel>
                        <TextBlock Text="ZWAÅ»ONE" FontSize="7" Foreground="#78716c" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="txtKgZwazone" Text="0" FontSize="13" FontWeight="Bold" Foreground="#22c55e"/>
                            <TextBlock Text=" kg" FontSize="8" Foreground="#78716c" VerticalAlignment="Bottom" Margin="0,0,0,1"/>
                            <TextBlock x:Name="txtTrendZwazone" Text="" FontSize="12" VerticalAlignment="Center" Margin="4,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- POZOSTAÅO -->
            <Border Background="#292524" CornerRadius="4" Margin="2,0" Padding="6,3"
                    BorderThickness="0,0,0,2" BorderBrush="#60a5fa"
                    MouseRightButtonUp="KpiIcon_RightClick" Tag="pozostalo" Cursor="Hand"
                    ToolTip="Å»ywiec oczekujÄ…cy na waÅ¼enie">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="IcoPozostalo" Text="â³" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <StackPanel>
                        <TextBlock Text="POZOSTAÅO" FontSize="7" Foreground="#78716c" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="txtKgPozostalo" Text="0" FontSize="13" FontWeight="Bold" Foreground="#60a5fa"/>
                            <TextBlock Text=" kg" FontSize="8" Foreground="#78716c" VerticalAlignment="Bottom" Margin="0,0,0,1"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- ODCHYLENIE -->
            <Border x:Name="borderOdchylenie" Background="#292524" CornerRadius="4" Margin="2,0" Padding="6,3"
                    BorderThickness="0,0,0,2" BorderBrush="#78716c"
                    MouseRightButtonUp="KpiIcon_RightClick" Tag="odchylenie" Cursor="Hand"
                    ToolTip="RÃ³Å¼nica plan vs rzeczywistoÅ›Ä‡&#10;Â±2% OK | Â±5% UWAGA | >5% PROBLEM">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="IcoOdchylenie" Text="ðŸ“‰" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <StackPanel>
                        <TextBlock Text="ODCHYLENIE" FontSize="7" Foreground="#78716c" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="txtOdchylenie" Text="-" FontSize="13" FontWeight="Bold" Foreground="#a8a29e"/>
                            <TextBlock x:Name="txtOdchylenieProc" Text="" FontSize="9" Foreground="#78716c"
                                       VerticalAlignment="Bottom" Margin="4,0,0,1"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- TUSZKI -->
            <Border Background="#292524" CornerRadius="4" Margin="2,0" Padding="6,3"
                    BorderThickness="0,0,0,2" BorderBrush="#c084fc"
                    MouseRightButtonUp="KpiIcon_RightClick" Tag="tuszki" Cursor="Hand"
                    ToolTip="Prognoza tuszek = Å¼ywiec Ã— 78%">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="IcoTuszki" Text="ðŸ—" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <StackPanel>
                        <TextBlock Text="TUSZKI" FontSize="7" Foreground="#78716c" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="txtPrognozaTuszek" Text="0" FontSize="13" FontWeight="Bold" Foreground="#c084fc"/>
                            <TextBlock Text=" kg" FontSize="8" Foreground="#78716c" VerticalAlignment="Bottom" Margin="0,0,0,1"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- REALIZACJA -->
            <Border Background="#292524" CornerRadius="4" Margin="2,0,0,0" Padding="6,3"
                    BorderThickness="0,0,0,2" BorderBrush="#22c55e"
                    MouseRightButtonUp="KpiIcon_RightClick" Tag="realizacja" Cursor="Hand"
                    ToolTip="Procent zrealizowanych dostaw">
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="IcoRealizacja" Text="ðŸ“Š" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <StackPanel>
                        <TextBlock Text="REALIZACJA" FontSize="7" Foreground="#78716c" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock x:Name="txtRealizacja" Text="0%" FontSize="14" FontWeight="Bold" Foreground="#22c55e"/>
                            <TextBlock x:Name="txtDostawyStatus" Text="(0/0)" FontSize="8" Foreground="#78716c"
                                       Margin="4,0,0,0" VerticalAlignment="Bottom"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </Border>

        </UniformGrid>

        <!-- ============================================ -->
        <!-- ROW 2: MAIN CONTENT (Sidebar + Table) -->
        <!-- ============================================ -->
        <Grid Grid.Row="2" Margin="0,4,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>  <!-- Sidebar - szerszy -->
                <ColumnDefinition Width="*"/>    <!-- Table -->
            </Grid.ColumnDefinitions>

            <!-- SIDEBAR -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,4,0">
                <StackPanel>

                    <!-- HARMONOGRAMY -->
                    <Border Background="#292524" CornerRadius="5" Padding="8,8" Margin="0,0,0,6">
                        <StackPanel>
                            <TextBlock Text="ðŸ“¦ HARMONOGRAMY" FontSize="10" FontWeight="Bold"
                                       Foreground="#f59e0b" Margin="0,0,0,6"/>
                            <ItemsControl x:Name="icHarmonogramy">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#1c1917" CornerRadius="4" Padding="8,6" Margin="0,0,0,4"
                                                BorderThickness="3,0,0,0" BorderBrush="{Binding StatusKolor, Mode=OneWay}">
                                            <StackPanel>
                                                <Grid>
                                                    <TextBlock Text="{Binding Hodowca, Mode=OneWay}" FontSize="11"
                                                               Foreground="#e7e5e4" TextTrimming="CharacterEllipsis"/>
                                                    <TextBlock Text="{Binding TrendDisplay, Mode=OneWay}" FontSize="11" FontWeight="Bold"
                                                               Foreground="{Binding StatusKolor, Mode=OneWay}" HorizontalAlignment="Right"/>
                                                </Grid>
                                                <ProgressBar Value="{Binding PostepProc, Mode=OneWay}" Maximum="100"
                                                             Height="4" Margin="0,4,0,2"
                                                             Background="#44403c" Foreground="{Binding ProgressKolor, Mode=OneWay}"/>
                                                <Grid>
                                                    <TextBlock FontSize="9" Foreground="#78716c">
                                                        <Run Text="âœ“ "/><Run Text="{Binding PostepDisplay, Mode=OneWay}"/>
                                                    </TextBlock>
                                                    <TextBlock Text="{Binding OdchylenieDisplay, Mode=OneWay}"
                                                               FontSize="9" Foreground="#78716c" HorizontalAlignment="Right"/>
                                                </Grid>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>

                    <!-- TUSZKI - PROGNOZA -->
                    <Border Background="#292524" CornerRadius="5" Padding="8,8" Margin="0,0,0,6">
                        <StackPanel>
                            <TextBlock Text="ðŸ— TUSZKI - PROGNOZA" FontSize="10" FontWeight="Bold"
                                       Foreground="#c084fc" Margin="0,0,0,6"/>

                            <!-- GÅ‚Ã³wne wartoÅ›ci -->
                            <UniformGrid Columns="3" Margin="0,0,0,8">
                                <Border Background="#1c1917" CornerRadius="4" Padding="6,8" Margin="0,0,2,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="PLAN" FontSize="8" Foreground="#78716c" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtTuszkiPlanSidebar" Text="-"
                                                   FontSize="18" FontWeight="Bold" Foreground="#a8a29e" HorizontalAlignment="Center"/>
                                        <TextBlock Text="kg" FontSize="8" Foreground="#57534e" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#1c1917" CornerRadius="4" Padding="6,8" Margin="2,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="RZECZ" FontSize="8" Foreground="#78716c" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtTuszkiRzeczSidebar" Text="-"
                                                   FontSize="18" FontWeight="Bold" Foreground="#c084fc" HorizontalAlignment="Center"/>
                                        <TextBlock Text="kg" FontSize="8" Foreground="#57534e" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border x:Name="borderTuszkiOdchylenie" Background="#1c1917" CornerRadius="4" Padding="6,8" Margin="2,0,0,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ODCHYL" FontSize="8" Foreground="#78716c" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtTuszkiOdchylenieSidebar" Text="-"
                                                   FontSize="18" FontWeight="Bold" Foreground="#78716c" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtTuszkiOdchylenieProcSidebar" Text="" FontSize="9" Foreground="#57534e" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>

                            <!-- Alert redukcji zamÃ³wieÅ„ -->
                            <Border x:Name="borderRedukcjaSidebar" Background="#7f1d1d" CornerRadius="4" Padding="8,6" Margin="0,0,0,6"
                                    Visibility="Collapsed">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="âš ï¸" FontSize="12" Margin="0,0,4,0"/>
                                        <TextBlock x:Name="txtRedukcjaAlertSidebar" Text="REDUKCJA ZAMÃ“WIEÅƒ"
                                                   FontSize="10" FontWeight="Bold" Foreground="#fca5a5"/>
                                    </StackPanel>
                                    <TextBlock x:Name="txtRedukcjaKgSidebar" Text="" FontSize="11" FontWeight="Bold"
                                               Foreground="#fbbf24" Margin="0,4,0,0"/>
                                </StackPanel>
                            </Border>

                            <!-- Klasy A/B - Plan i Rzecz -->
                            <Grid Margin="0,0,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- NagÅ‚Ã³wki -->
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="KLASA A" FontSize="9" FontWeight="SemiBold"
                                           Foreground="#22c55e" HorizontalAlignment="Center" Margin="0,0,0,4"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="KLASA B" FontSize="9" FontWeight="SemiBold"
                                           Foreground="#fbbf24" HorizontalAlignment="Center" Margin="0,0,0,4"/>

                                <!-- Klasa A - Plan/Rzecz -->
                                <Border Grid.Row="1" Grid.Column="0" Background="#1c1917" CornerRadius="4" Padding="6,6" Margin="0,0,3,0">
                                    <StackPanel>
                                        <Grid>
                                            <TextBlock Text="Plan:" FontSize="9" Foreground="#78716c"/>
                                            <TextBlock x:Name="txtKlasaAPlanSidebar" Text="-" FontSize="10" FontWeight="SemiBold"
                                                       Foreground="#a8a29e" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Grid Margin="0,2,0,0">
                                            <TextBlock Text="Rzecz:" FontSize="9" Foreground="#78716c"/>
                                            <TextBlock x:Name="txtKlasaASidebar" Text="-" FontSize="10" FontWeight="Bold"
                                                       Foreground="#22c55e" HorizontalAlignment="Right"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <!-- Klasa B - Plan/Rzecz -->
                                <Border Grid.Row="1" Grid.Column="1" Background="#1c1917" CornerRadius="4" Padding="6,6" Margin="3,0,0,0">
                                    <StackPanel>
                                        <Grid>
                                            <TextBlock Text="Plan:" FontSize="9" Foreground="#78716c"/>
                                            <TextBlock x:Name="txtKlasaBPlanSidebar" Text="-" FontSize="10" FontWeight="SemiBold"
                                                       Foreground="#a8a29e" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Grid Margin="0,2,0,0">
                                            <TextBlock Text="Rzecz:" FontSize="9" Foreground="#78716c"/>
                                            <TextBlock x:Name="txtKlasaBSidebar" Text="-" FontSize="10" FontWeight="Bold"
                                                       Foreground="#fbbf24" HorizontalAlignment="Right"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </Grid>

                            <!-- Trend i auta -->
                            <Grid Margin="0,6,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Orientation="Horizontal">
                                    <TextBlock Text="Auta: " FontSize="10" Foreground="#78716c"/>
                                    <TextBlock x:Name="txtAutaSidebar" Text="0/0" FontSize="10" FontWeight="SemiBold" Foreground="#a8a29e"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <TextBlock Text="Trend: " FontSize="10" Foreground="#78716c"/>
                                    <TextBlock x:Name="txtTrendSidebar" Text="0%" FontSize="10" FontWeight="SemiBold" Foreground="#fbbf24"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- ÅšREDNIE WAGI -->
                    <Border Background="#292524" CornerRadius="5" Padding="8,8" Margin="0,0,0,6">
                        <StackPanel>
                            <TextBlock Text="âš–ï¸ ÅšREDNIE WAGI" FontSize="10" FontWeight="Bold"
                                       Foreground="#f59e0b" Margin="0,0,0,6"/>
                            <UniformGrid Columns="2">
                                <Border Background="#1c1917" CornerRadius="4" Padding="8,6" Margin="0,0,3,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="DEKL" FontSize="9" Foreground="#78716c" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtSrWagaPlanSidebar" Text="-"
                                                   FontSize="18" FontWeight="Bold" Foreground="#a8a29e" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#1c1917" CornerRadius="4" Padding="8,6" Margin="3,0,0,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="RZECZ" FontSize="9" Foreground="#78716c" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtSrWagaRzeczSidebar" Text="-"
                                                   FontSize="18" FontWeight="Bold" Foreground="#22c55e" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>
                        </StackPanel>
                    </Border>

                    <!-- SZYBKIE AKCJE - rozwijany -->
                    <Border Background="#292524" CornerRadius="5" Padding="4,4">
                        <Expander IsExpanded="False" Foreground="#e7e5e4">
                            <Expander.Header>
                                <TextBlock Text="âš¡ AKCJE" FontSize="10" FontWeight="Bold" Foreground="#f59e0b"/>
                            </Expander.Header>
                            <Expander.Style>
                                <Style TargetType="Expander">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                </Style>
                            </Expander.Style>
                            <StackPanel Margin="0,6,0,0">
                                <Button Content="ðŸ“‹ Eksport Excel" Style="{StaticResource SidebarBtn}" Click="BtnExportExcel_Click"/>
                                <Button Content="ðŸ–¨ï¸ Drukuj raport" Style="{StaticResource SidebarBtn}" Click="BtnPrint_Click"/>
                                <Button Content="â“ Jak czytaÄ‡?" Style="{StaticResource SidebarBtn}" Click="BtnHelp_Click"/>
                                <Button Content="ðŸ”§ Diagnostyka" Style="{StaticResource SidebarBtn}" Click="BtnDiagnose_Click"
                                        Background="#7f1d1d" Foreground="#fca5a5"/>
                            </StackPanel>
                        </Expander>
                    </Border>

                </StackPanel>
            </ScrollViewer>

            <!-- TABLE SECTION -->
            <Border Grid.Column="1" Background="#292524" CornerRadius="5">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="32"/>   <!-- Header -->
                        <RowDefinition Height="*"/>    <!-- DataGrid -->
                        <RowDefinition Height="Auto"/> <!-- SUMA -->
                    </Grid.RowDefinitions>

                    <!-- TABLE HEADER -->
                    <Border Grid.Row="0" Background="#44403c" CornerRadius="5,5,0,0" Padding="12,0">
                        <Grid VerticalAlignment="Center">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="SZCZEGÃ“ÅY DOSTAW" FontSize="12" FontWeight="Bold" Foreground="#fbbf24"/>
                                <TextBlock x:Name="txtLiczbaWynikow" Text=" (0 wynikÃ³w)" FontSize="11" Foreground="#78716c"
                                           VerticalAlignment="Center" Margin="6,0,0,0"/>
                            </StackPanel>
                            <TextBlock x:Name="txtLastUpdate" Text="-" FontSize="10" Foreground="#78716c"
                                       HorizontalAlignment="Right" VerticalAlignment="Center"/>
                        </Grid>
                    </Border>

                    <!-- DATAGRID -->
                    <DataGrid Grid.Row="1" x:Name="dgDostawy"
                              Style="{StaticResource ModernDataGrid}"
                              ColumnHeaderStyle="{StaticResource DgHeader}"
                              CellStyle="{StaticResource DgCell}"
                              RowStyle="{StaticResource DgRow}"
                              VirtualizingPanel.IsVirtualizing="True"
                              MouseDoubleClick="DataGrid_MouseDoubleClick">
                        <DataGrid.Columns>
                            <!-- Kolorowy pasek -->
                            <DataGridTemplateColumn Width="5" CanUserResize="False">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Width="5" Margin="-6,0,0,0"
                                                Background="{Binding Poziom, Converter={StaticResource OdchylenieToBarColorConverter}}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Header="LP" Binding="{Binding NrKursu}" Width="55">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                        <Setter Property="FontSize" Value="12"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <DataGridTextColumn Header="HODOWCA" Binding="{Binding Hodowca}" Width="*" MinWidth="180">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                        <Setter Property="FontSize" Value="12"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>

                            <!-- PLAN NA AUTO -->
                            <DataGridTemplateColumn Header="PLAN" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding KgPlanNaAuto, StringFormat=N0}" Foreground="#a8a29e" FontSize="12"/>
                                            <TextBlock Text=" (R)" Foreground="#f59e0b" FontSize="10" FontWeight="Bold"
                                                       Visibility="{Binding CzyOstatnieAuto, Converter={StaticResource BoolToVisibilityConverter}}"
                                                       ToolTip="Reszta z harmonogramu"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="RZECZ" Width="95">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding KgRzeczywiste, StringFormat=N0}" HorizontalAlignment="Right"
                                                   Foreground="{Binding Status, Converter={StaticResource StatusToColorConverter}}"
                                                   VerticalAlignment="Center" FontWeight="SemiBold" FontSize="12"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="ODCHYL." Width="115">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding OdchylenieDisplay}"
                                                   Foreground="{Binding Poziom, Converter={StaticResource OdchylenieToColorConverter}}"
                                                   VerticalAlignment="Center" FontSize="11"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- POZOSTALO Z HARMONOGRAMU -->
                            <DataGridTemplateColumn Header="POZOST." Width="105">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel VerticalAlignment="Center">
                                            <TextBlock Foreground="{Binding PozostaloKolor}" FontSize="11">
                                                <Run Text="{Binding KgPozostalo, StringFormat=N0}"/><Run Text=" kg"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- POSTEP HARMONOGRAMU -->
                            <DataGridTemplateColumn Header="POST." Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel VerticalAlignment="Center">
                                            <TextBlock Text="{Binding PostepDisplay}" FontSize="10" Foreground="#78716c" HorizontalAlignment="Center"/>
                                            <ProgressBar Value="{Binding PostepProc, Mode=OneWay}" Maximum="100"
                                                         Height="3" Background="#44403c" Foreground="#22c55e"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="W.DEK" Width="75">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding SredniaWagaPlanCalc, StringFormat=N2}"
                                                   Foreground="#78716c" FontSize="11"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTemplateColumn Header="W.RZ" Width="75">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding SredniaWagaRzeczywistaCalc, Converter={StaticResource NullToDashConverter}}"
                                                   Foreground="{Binding Status, Converter={StaticResource StatusToColorConverter}}"
                                                   FontSize="11" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- TUSZKI -->
                            <DataGridTemplateColumn Header="TUSZKI" Width="85">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding TuszkiRzeczywisteKg, Converter={StaticResource NullToDashConverter}}"
                                                   Foreground="#c084fc" FontSize="11" FontWeight="SemiBold"
                                                   HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <!-- Status jako ikona -->
                            <DataGridTemplateColumn Header="" Width="42">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding StatusIcon}" FontSize="16"
                                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                                   ToolTip="{Binding StatusText}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>

                            <DataGridTextColumn Header="GODZ" Binding="{Binding PrzyjazdDisplay}" Width="75">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Setter Property="Foreground" Value="#78716c"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="FontSize" Value="11"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- WIERSZ SUMA -->
                    <Border Grid.Row="2" Background="#92400e" Padding="8,10"
                            CornerRadius="0,0,5,5" BorderThickness="0,2,0,0" BorderBrush="#f59e0b">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="55"/>   <!-- LP -->
                                <ColumnDefinition Width="*"/>    <!-- HODOWCA -->
                                <ColumnDefinition Width="100"/>  <!-- PLAN -->
                                <ColumnDefinition Width="95"/>   <!-- RZECZ -->
                                <ColumnDefinition Width="115"/>  <!-- ODCHYLENIE -->
                                <ColumnDefinition Width="105"/>  <!-- POZOSTAÅO -->
                                <ColumnDefinition Width="80"/>   <!-- POSTÄ˜P -->
                                <ColumnDefinition Width="75"/>   <!-- W.DEK -->
                                <ColumnDefinition Width="75"/>   <!-- W.RZ -->
                                <ColumnDefinition Width="85"/>   <!-- TUSZKI -->
                                <ColumnDefinition Width="42"/>   <!-- STATUS -->
                                <ColumnDefinition Width="75"/>   <!-- GODZ -->
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="SUMA" FontSize="11" FontWeight="Bold" Foreground="#fbbf24" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1" x:Name="txtSumaDostawy" Text="0 dostaw" FontSize="11" Foreground="#a8a29e" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="2" x:Name="txtSumaPlan" Text="0" FontSize="12" FontWeight="SemiBold" Foreground="#e7e5e4" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="3" x:Name="txtSumaRzecz" Text="0" FontSize="12" FontWeight="Bold" Foreground="#22c55e" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="4" x:Name="txtSumaOdchylenie" Text="-" FontSize="11" FontWeight="SemiBold" Foreground="#fbbf24" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <StackPanel Grid.Column="5" VerticalAlignment="Center">
                                <TextBlock x:Name="txtSumaPozostaloKg" Text="-" Foreground="#60a5fa" FontSize="11" FontWeight="SemiBold"/>
                                <TextBlock x:Name="txtSumaPozostaloTuszki" Text="-" Foreground="#c084fc" FontSize="10"/>
                            </StackPanel>
                            <TextBlock Grid.Column="6" Text="-" FontSize="11" Foreground="#78716c" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="7" x:Name="txtSumaWagaPlan" Text="-" FontSize="11" Foreground="#78716c" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="8" x:Name="txtSumaSrWaga" Text="-" FontSize="11" Foreground="#e7e5e4" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="9" x:Name="txtSumaTuszkiRzecz" Text="-" FontSize="12" FontWeight="Bold" Foreground="#c084fc" HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="10" Text="-" FontSize="11" Foreground="#78716c" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="11" Text="-" FontSize="11" Foreground="#78716c" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Grid>
                    </Border>
                </Grid>
            </Border>
        </Grid>

        <!-- ============================================ -->
        <!-- ROW 3: BOTTOM BAR (26px) -->
        <!-- ============================================ -->
        <Border Grid.Row="3" Background="#292524" CornerRadius="5" Padding="10,0" Margin="0,4,0,0">
            <Grid VerticalAlignment="Center">
                <!-- LEGENDA -->
                <StackPanel Orientation="Horizontal">
                    <Rectangle Width="8" Height="8" Fill="#22c55e" RadiusX="2" RadiusY="2"/>
                    <TextBlock Text=" OK (Â±2%)" FontSize="8" Foreground="#78716c" Margin="0,0,10,0"/>
                    <Rectangle Width="8" Height="8" Fill="#fbbf24" RadiusX="2" RadiusY="2"/>
                    <TextBlock Text=" Uwaga (Â±5%)" FontSize="8" Foreground="#78716c" Margin="0,0,10,0"/>
                    <Rectangle Width="8" Height="8" Fill="#ef4444" RadiusX="2" RadiusY="2"/>
                    <TextBlock Text=" Problem (>5%)" FontSize="8" Foreground="#78716c" Margin="0,0,10,0"/>
                    <TextBlock Text="|" Foreground="#44403c" Margin="5,0"/>
                    <TextBlock Text="Dwuklik = szczegÃ³Å‚y  |  PPM na ikonach = zmieÅ„" FontSize="8" Foreground="#78716c"/>
                </StackPanel>

                <!-- PRAWY PANEL -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <TextBlock FontSize="9" Foreground="#78716c" VerticalAlignment="Center">
                        <Run Text="Akt: "/><Run x:Name="txtAutoRefreshFooter" Text="-" Foreground="#fbbf24"/>
                    </TextBlock>
                    <Button Content="ðŸ“‹ Excel" Style="{StaticResource BottomBtn}" Click="BtnExportExcel_Click" Margin="12,0,0,0"/>
                    <Button Content="ðŸ–¨ï¸ Drukuj" Style="{StaticResource BottomBtn}" Click="BtnPrint_Click" Margin="4,0,0,0"/>
                    <Button Content="ðŸ”§ DIAG" Style="{StaticResource BottomBtnDanger}" Click="BtnDiagnose_Click" Margin="4,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================ -->
        <!-- OVERLAY ÅADOWANIA -->
        <!-- ============================================ -->
        <Border x:Name="loadingOverlay" Grid.RowSpan="4" Background="#CC1c1917" Visibility="Collapsed">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <Ellipse x:Name="spinnerEllipse" Width="40" Height="40" StrokeThickness="3"
                         Stroke="#f59e0b" StrokeDashArray="3,2">
                    <Ellipse.RenderTransform>
                        <RotateTransform x:Name="spinnerRotate" CenterX="20" CenterY="20"/>
                    </Ellipse.RenderTransform>
                    <Ellipse.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard RepeatBehavior="Forever">
                                    <DoubleAnimation Storyboard.TargetName="spinnerRotate"
                                                     Storyboard.TargetProperty="Angle"
                                                     From="0" To="360" Duration="0:0:1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Ellipse.Triggers>
                </Ellipse>
                <TextBlock x:Name="txtLoadingMessage" Text="Aktualizacja..." Foreground="#e7e5e4" FontSize="12"
                           HorizontalAlignment="Center" Margin="0,12,0,0"/>
            </StackPanel>
        </Border>

        <!-- ============================================ -->
        <!-- OVERLAY BÅÄ˜DU -->
        <!-- ============================================ -->
        <Border x:Name="errorOverlay" Grid.RowSpan="4" Background="#CC1c1917" Visibility="Collapsed">
            <Border Background="#292524" CornerRadius="8" Padding="25,20" HorizontalAlignment="Center" VerticalAlignment="Center" MaxWidth="400">
                <StackPanel>
                    <TextBlock Text="BÅ‚Ä…d poÅ‚Ä…czenia" FontSize="16" FontWeight="Bold" Foreground="#ef4444" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                    <TextBlock x:Name="txtErrorMessage" Text="" Foreground="#a8a29e" TextWrapping="Wrap" TextAlignment="Center" Margin="0,0,0,15"/>
                    <Button Content="SprÃ³buj ponownie" Style="{StaticResource BtnAmber}" HorizontalAlignment="Center" Click="BtnRetry_Click" Padding="15,6"/>
                </StackPanel>
            </Border>
        </Border>

    </Grid>
</Window>
