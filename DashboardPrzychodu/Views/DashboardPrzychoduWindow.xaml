<Window x:Class="Kalendarz1.DashboardPrzychodu.Views.DashboardPrzychoduWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:Kalendarz1.DashboardPrzychodu.Converters"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Dashboard Przychodu Zywca - LIVE"
        Height="900" Width="1400"
        MinHeight="700" MinWidth="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#1A1A2E">

    <Window.Resources>
        <!-- KOLORY - Ciemny motyw ZPSP -->
        <Color x:Key="BackgroundDark">#1A1A2E</Color>
        <Color x:Key="BackgroundMedium">#16213E</Color>
        <Color x:Key="BackgroundLight">#0F3460</Color>
        <Color x:Key="CardBackground">#1E2A47</Color>
        <Color x:Key="AccentBlue">#00D9FF</Color>
        <Color x:Key="AccentGreen">#4ECCA3</Color>
        <Color x:Key="StatusOK">#4ECCA3</Color>
        <Color x:Key="StatusWarning">#FFB347</Color>
        <Color x:Key="StatusError">#E94560</Color>
        <Color x:Key="TextPrimary">#FFFFFF</Color>
        <Color x:Key="TextSecondary">#94A3B8</Color>
        <Color x:Key="BorderColor">#2D3A5C</Color>

        <!-- BRUSHE -->
        <SolidColorBrush x:Key="BackgroundDarkBrush" Color="{StaticResource BackgroundDark}"/>
        <SolidColorBrush x:Key="BackgroundMediumBrush" Color="{StaticResource BackgroundMedium}"/>
        <SolidColorBrush x:Key="BackgroundLightBrush" Color="{StaticResource BackgroundLight}"/>
        <SolidColorBrush x:Key="CardBackgroundBrush" Color="{StaticResource CardBackground}"/>
        <SolidColorBrush x:Key="AccentBlueBrush" Color="{StaticResource AccentBlue}"/>
        <SolidColorBrush x:Key="AccentGreenBrush" Color="{StaticResource AccentGreen}"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="{StaticResource TextPrimary}"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="{StaticResource TextSecondary}"/>
        <SolidColorBrush x:Key="BorderBrush" Color="{StaticResource BorderColor}"/>
        <SolidColorBrush x:Key="StatusOKBrush" Color="{StaticResource StatusOK}"/>
        <SolidColorBrush x:Key="StatusWarningBrush" Color="{StaticResource StatusWarning}"/>
        <SolidColorBrush x:Key="StatusErrorBrush" Color="{StaticResource StatusError}"/>

        <!-- KONWERTERY -->
        <conv:StatusToBackgroundConverter x:Key="StatusToBackgroundConverter"/>
        <conv:StatusToColorConverter x:Key="StatusToColorConverter"/>
        <conv:OdchylenieToColorConverter x:Key="OdchylenieToColorConverter"/>
        <conv:OdchylenieToIconConverter x:Key="OdchylenieToIconConverter"/>
        <conv:StatusToIconConverter x:Key="StatusToIconConverter"/>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <conv:NullToDashConverter x:Key="NullToDashConverter"/>

        <!-- STYL KARTY -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15,12"/>
        </Style>

        <!-- STYL KAFELKA -->
        <Style x:Key="NumberTileStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BackgroundLightBrush}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15,10"/>
        </Style>

        <!-- DUŻA LICZBA -->
        <Style x:Key="BigNumberStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>

        <!-- ETYKIETA -->
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>

        <!-- NAGŁÓWEK SEKCJI -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource AccentBlueBrush}"/>
        </Style>

        <!-- PRZYCISK -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource BackgroundLightBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1A4A8C"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="AccentButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="{StaticResource AccentBlueBrush}"/>
            <Setter Property="Foreground" Value="#1A1A2E"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>

        <!-- TEXTBOX CIEMNY -->
        <Style x:Key="DarkTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource BackgroundMediumBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DATEPICKER CIEMNY -->
        <Style x:Key="DarkDatePicker" TargetType="DatePicker">
            <Setter Property="Background" Value="{StaticResource BackgroundMediumBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <!-- DATAGRID -->
        <Style x:Key="ModernDataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RowBackground" Value="Transparent"/>
            <Setter Property="AlternatingRowBackground" Value="#0A0F1A"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="RowHeight" Value="36"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="IsReadOnly" Value="True"/>
        </Style>

        <Style x:Key="DataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="{StaticResource BackgroundLightBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,1,1"/>
        </Style>

        <Style x:Key="DataGridCellStyle" TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#2A4A7A"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="DataGridRowStyle" TargetType="DataGridRow">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1A2A4A"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#2A4A7A"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- NAGŁÓWEK -->
        <Border Grid.Row="0" Padding="20,12" Background="{StaticResource BackgroundLightBrush}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Tytuł -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="PRZYCHOD ZYWCA" FontSize="24" FontWeight="Bold" Foreground="White"/>
                    <Border Background="{StaticResource AccentGreenBrush}" CornerRadius="4" Padding="8,3" Margin="12,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="LIVE" FontSize="10" FontWeight="Bold" Foreground="#1A1A2E"/>
                    </Border>
                </StackPanel>

                <!-- Kontrolki -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Data:" Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="0,0,8,0" FontSize="13"/>
                    <DatePicker x:Name="dpData" SelectedDate="{x:Static sys:DateTime.Today}" Width="120"
                                Background="#16213E" Foreground="White" BorderBrush="#2D3A5C" FontSize="13"/>

                    <TextBox x:Name="txtSearch" Style="{StaticResource DarkTextBox}" Width="180" Margin="15,0,0,0"/>

                    <Button x:Name="btnRefresh" Style="{StaticResource AccentButton}" Margin="15,0,0,0" Click="BtnRefresh_Click" Content="Odswiez"/>

                    <Border Background="{StaticResource BackgroundMediumBrush}" CornerRadius="6" Padding="10,6" Margin="15,0,0,0">
                        <TextBlock x:Name="txtAutoRefresh" Text="30s" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <!-- PODSUMOWANIE - KOMPAKTOWE W JEDNEJ LINII -->
        <Border Grid.Row="1" Background="{StaticResource CardBackgroundBrush}" Padding="15,10" Margin="10,5,10,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- PLANOWANE -->
                <Border Grid.Column="0" Style="{StaticResource NumberTileStyle}" Margin="0,0,5,0">
                    <StackPanel>
                        <TextBlock Text="PLANOWANE" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,0">
                            <TextBlock x:Name="txtKgPlan" Text="0" Style="{StaticResource BigNumberStyle}"/>
                            <TextBlock Text=" kg" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
                        </StackPanel>
                        <TextBlock x:Name="txtSztPlan" Text="0 szt" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- ZWAŻONE -->
                <Border Grid.Column="1" Style="{StaticResource NumberTileStyle}" Margin="5,0" Background="#0A4A3A">
                    <StackPanel>
                        <TextBlock Text="ZWAZONE" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,0">
                            <TextBlock x:Name="txtKgZwazone" Text="0" Style="{StaticResource BigNumberStyle}" Foreground="{StaticResource AccentGreenBrush}"/>
                            <TextBlock Text=" kg" Foreground="{StaticResource AccentGreenBrush}" FontSize="12" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
                        </StackPanel>
                        <TextBlock x:Name="txtSztZwazone" Text="0 szt" Foreground="{StaticResource AccentGreenBrush}" FontSize="11" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- POZOSTAŁO -->
                <Border Grid.Column="2" Style="{StaticResource NumberTileStyle}" Margin="5,0">
                    <StackPanel>
                        <TextBlock Text="POZOSTALO" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,0">
                            <TextBlock x:Name="txtKgPozostalo" Text="0" Style="{StaticResource BigNumberStyle}" Foreground="{StaticResource StatusWarningBrush}"/>
                            <TextBlock Text=" kg" Foreground="{StaticResource StatusWarningBrush}" FontSize="12" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
                        </StackPanel>
                        <TextBlock x:Name="txtSztPozostalo" Text="0 szt" Foreground="{StaticResource StatusWarningBrush}" FontSize="11" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- ODCHYLENIE -->
                <Border Grid.Column="3" Style="{StaticResource NumberTileStyle}" Margin="5,0">
                    <StackPanel>
                        <TextBlock Text="ODCHYLENIE" Style="{StaticResource LabelStyle}"/>
                        <TextBlock x:Name="txtOdchylenie" Text="-" Style="{StaticResource BigNumberStyle}" FontSize="22" Margin="0,4,0,0"/>
                        <TextBlock x:Name="txtOdchylenieProc" Text="" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- ŚREDNIA WAGA PLAN -->
                <Border Grid.Column="4" Style="{StaticResource NumberTileStyle}" Margin="5,0" Background="#2A2A4A">
                    <StackPanel>
                        <TextBlock Text="SR.WAGA PLAN" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,0">
                            <TextBlock x:Name="txtSrWagaPlan" Text="-" Style="{StaticResource BigNumberStyle}" FontSize="24" Foreground="#9090FF"/>
                            <TextBlock Text=" kg" Foreground="#9090FF" FontSize="11" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
                        </StackPanel>
                        <TextBlock Text="na sztuke" Foreground="{StaticResource TextSecondaryBrush}" FontSize="10" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- ŚREDNIA WAGA RZECZ -->
                <Border Grid.Column="5" Style="{StaticResource NumberTileStyle}" Margin="5,0" Background="#0A4A3A">
                    <StackPanel>
                        <TextBlock Text="SR.WAGA RZECZ" Style="{StaticResource LabelStyle}"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,4,0,0">
                            <TextBlock x:Name="txtSrWagaRzecz" Text="-" Style="{StaticResource BigNumberStyle}" FontSize="24" Foreground="{StaticResource AccentGreenBrush}"/>
                            <TextBlock Text=" kg" Foreground="{StaticResource AccentGreenBrush}" FontSize="11" VerticalAlignment="Bottom" Margin="0,0,0,4"/>
                        </StackPanel>
                        <TextBlock Text="netto/lumel" Foreground="{StaticResource TextSecondaryBrush}" FontSize="10" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- REALIZACJA + PROGNOZA -->
                <StackPanel Grid.Column="6" Margin="10,0,0,0" VerticalAlignment="Center">
                    <!-- Realizacja -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <TextBlock Text="Realizacja:" Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock x:Name="txtRealizacja" Text="0%" FontSize="20" FontWeight="Bold" Foreground="{StaticResource AccentGreenBrush}"/>
                        <TextBlock x:Name="txtDostawyStatus" Text=" (0/0)" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" VerticalAlignment="Bottom" Margin="0,0,0,2"/>
                    </StackPanel>
                    <!-- Prognoza -->
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Prognoza:" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <Border Background="#0A4A3A" CornerRadius="4" Padding="8,3" Margin="0,0,5,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="A:" Foreground="{StaticResource AccentGreenBrush}" FontSize="11"/>
                                <TextBlock x:Name="txtPrognozaA" Text="0" Foreground="{StaticResource AccentGreenBrush}" FontSize="11" FontWeight="SemiBold" Margin="3,0,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#4A3A0A" CornerRadius="4" Padding="8,3">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="B:" Foreground="{StaticResource StatusWarningBrush}" FontSize="11"/>
                                <TextBlock x:Name="txtPrognozaB" Text="0" Foreground="{StaticResource StatusWarningBrush}" FontSize="11" FontWeight="SemiBold" Margin="3,0,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>

        <!-- TABELA DOSTAW -->
        <Border Grid.Row="2" Style="{StaticResource CardStyle}" Margin="10,10,10,5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Nagłówek -->
                <Grid Grid.Row="0" Margin="0,0,0,8">
                    <TextBlock Text="SZCZEGOLY DOSTAW" Style="{StaticResource SectionHeaderStyle}"/>
                    <TextBlock x:Name="txtLiczbaWynikow" Text="Wyniki: 0" HorizontalAlignment="Right"
                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
                    <TextBlock x:Name="txtDataDisplay" Text="" HorizontalAlignment="Center"
                               Foreground="{StaticResource TextSecondaryBrush}" FontSize="12"/>
                </Grid>

                <!-- DataGrid -->
                <DataGrid x:Name="dgDostawy" Grid.Row="1"
                          Style="{StaticResource ModernDataGrid}"
                          ColumnHeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                          CellStyle="{StaticResource DataGridCellStyle}"
                          RowStyle="{StaticResource DataGridRowStyle}"
                          VirtualizingPanel.IsVirtualizing="True">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="LP" Binding="{Binding NrKursu}" Width="45">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="HODOWCA" Binding="{Binding Hodowca}" Width="*" MinWidth="150">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="PLAN [kg]" Binding="{Binding KgPlan, StringFormat=N0}" Width="90">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Right"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTemplateColumn Header="RZECZ [kg]" Width="90">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding KgRzeczywiste, StringFormat=N0}" HorizontalAlignment="Right"
                                               Foreground="{Binding Status, Converter={StaticResource StatusToColorConverter}}" VerticalAlignment="Center"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="ODCHYL." Width="110">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding OdchylenieDisplay}"
                                                   Foreground="{Binding Poziom, Converter={StaticResource OdchylenieToColorConverter}}"/>
                                        <TextBlock Text="{Binding Poziom, Converter={StaticResource OdchylenieToIconConverter}}"
                                                   FontSize="11" Margin="4,0,0,0"/>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="SR.WAGA" Width="75">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding SredniaWagaRzeczywistaCalc, Converter={StaticResource NullToDashConverter}}"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTemplateColumn Header="STATUS" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border CornerRadius="4" Padding="6,2" HorizontalAlignment="Left"
                                            Background="{Binding Status, Converter={StaticResource StatusToBackgroundConverter}}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding StatusIcon}" FontSize="11"/>
                                            <TextBlock Text="{Binding StatusText}" FontSize="11" FontWeight="SemiBold" Margin="4,0,0,0"
                                                       Foreground="{Binding Status, Converter={StaticResource StatusToColorConverter}}"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <DataGridTextColumn Header="PRZYJAZD" Binding="{Binding PrzyjazdDisplay}" Width="70">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="HorizontalAlignment" Value="Center"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn Header="WAZYL" Binding="{Binding KtoWazyl}" Width="90">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Legenda -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,8,0,0">
                    <TextBlock Text="Legenda:" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" Margin="0,0,15,0"/>
                    <TextBlock Text="OK (±2%)" Foreground="{StaticResource StatusOKBrush}" FontSize="11" FontWeight="SemiBold" Margin="0,0,15,0"/>
                    <TextBlock Text="Uwaga (±5%)" Foreground="{StaticResource StatusWarningBrush}" FontSize="11" FontWeight="SemiBold" Margin="0,0,15,0"/>
                    <TextBlock Text="Problem (>5%)" Foreground="{StaticResource StatusErrorBrush}" FontSize="11" FontWeight="SemiBold"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- STOPKA -->
        <Border Grid.Row="3" Background="{StaticResource BackgroundMediumBrush}" Padding="15,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Button x:Name="btnExportExcel" Style="{StaticResource ModernButton}" Margin="0,0,8,0" Click="BtnExportExcel_Click" Content="Eksport Excel"/>
                    <Button x:Name="btnPrint" Style="{StaticResource ModernButton}" Margin="0,0,8,0" Click="BtnPrint_Click" Content="Drukuj"/>
                    <Button x:Name="btnDiagnose" Style="{StaticResource ModernButton}" Click="BtnDiagnose_Click" Background="#8B0000">
                        <TextBlock Text="DIAGNOSTYKA" Foreground="#FF6B6B"/>
                    </Button>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="Aktualizacja: " Foreground="{StaticResource TextSecondaryBrush}" FontSize="11"/>
                    <TextBlock x:Name="txtLastUpdate" Text="-" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                    <TextBlock Text="  |  Auto: 30s" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" Margin="10,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- OVERLAY ŁADOWANIA -->
        <Border x:Name="loadingOverlay" Grid.RowSpan="4" Background="#CC1A1A2E" Visibility="Collapsed">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="4" Foreground="{StaticResource AccentBlueBrush}"/>
                <TextBlock x:Name="txtLoadingMessage" Text="Ladowanie..." Foreground="White" FontSize="14" HorizontalAlignment="Center" Margin="0,15,0,0"/>
            </StackPanel>
        </Border>

        <!-- OVERLAY BŁĘDU -->
        <Border x:Name="errorOverlay" Grid.RowSpan="4" Background="#CC1A1A2E" Visibility="Collapsed">
            <Border Background="{StaticResource CardBackgroundBrush}" CornerRadius="12" Padding="30,20" HorizontalAlignment="Center" VerticalAlignment="Center" MaxWidth="450">
                <StackPanel>
                    <TextBlock Text="Blad polaczenia" FontSize="18" FontWeight="Bold" Foreground="{StaticResource StatusErrorBrush}" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                    <TextBlock x:Name="txtErrorMessage" Text="" Foreground="{StaticResource TextSecondaryBrush}" TextWrapping="Wrap" TextAlignment="Center" Margin="0,0,0,15"/>
                    <Button Content="Sprobuj ponownie" Style="{StaticResource AccentButton}" HorizontalAlignment="Center" Click="BtnRetry_Click"/>
                </StackPanel>
            </Border>
        </Border>
    </Grid>
</Window>
