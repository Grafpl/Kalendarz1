<Window x:Class="Kalendarz1.Avilog.Views.RozliczeniaAvilogWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Rozliczenia Avilog - ZPSP"
        Width="1400" Height="900"
        MinWidth="1200" MinHeight="700"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <!-- === KOLORY === -->
        <SolidColorBrush x:Key="PrimaryGreen" Color="#4CAF50"/>
        <SolidColorBrush x:Key="DarkGreen" Color="#388E3C"/>
        <SolidColorBrush x:Key="AccentGreen" Color="#5C8A3A"/>
        <SolidColorBrush x:Key="LightGreen" Color="#E8F5E9"/>
        <SolidColorBrush x:Key="TextDark" Color="#2C3E50"/>
        <SolidColorBrush x:Key="TextGray" Color="#7F8C8D"/>
        <SolidColorBrush x:Key="BorderGray" Color="#E0E0E0"/>
        <SolidColorBrush x:Key="WarningOrange" Color="#FF9800"/>
        <SolidColorBrush x:Key="ErrorRed" Color="#F44336"/>

        <!-- === STYL PRZYCISKU ZIELONY === -->
        <Style x:Key="GreenButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#4CAF50"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#388E3C"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#BDBDBD"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- === STYL PRZYCISKU SZARY === -->
        <Style x:Key="GrayButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#607D8B"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#455A64"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- === STYL PRZYCISKU POMARAÅƒCZOWY === -->
        <Style x:Key="OrangeButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF9800"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F57C00"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- === STYL NAGÅÃ“WKA DATAGRID === -->
        <Style x:Key="DataGridHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#37474F"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="8,10"/>
            <Setter Property="BorderThickness" Value="0,0,1,0"/>
            <Setter Property="BorderBrush" Value="#455A64"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

        <!-- === STYL WIERSZA DATAGRID === -->
        <Style x:Key="DataGridRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#C8E6C9"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E8F5E9"/>
                </Trigger>
                <DataTrigger Binding="{Binding JestSuma}" Value="True">
                    <Setter Property="Background" Value="#388E3C"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding MaBrakiDanych}" Value="True">
                    <Setter Property="Background" Value="#FFF3E0"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- === STYL KOMÃ“RKI DATAGRID === -->
        <Style x:Key="DataGridCellStyle" TargetType="DataGridCell">
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Background="{TemplateBinding Background}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Foreground" Value="#2C3E50"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- === STYL KART STATYSTYK === -->
        <Style x:Key="StatCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" BlurRadius="5" Opacity="0.1"/>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- === NAGÅÃ“WEK === -->
        <Border Grid.Row="0" Background="Linear Gradient" Padding="20,15">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#388E3C" Offset="0"/>
                    <GradientStop Color="#4CAF50" Offset="0.5"/>
                    <GradientStop Color="#66BB6A" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸš›" FontSize="28" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <StackPanel>
                        <TextBlock Text="ROZLICZENIA AVILOG" FontSize="22" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="Tygodniowe zestawienia transportu Å¼ywca" FontSize="12" Foreground="#E8F5E9"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock x:Name="txtStatus" Text="" Foreground="#E8F5E9" FontSize="12" VerticalAlignment="Center" Margin="0,0,15,0"/>
                    <ProgressBar x:Name="progressBar" Width="100" Height="6" IsIndeterminate="True" Visibility="Collapsed" Margin="0,0,10,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- === PANEL WYBORU OKRESU === -->
        <Border Grid.Row="1" Background="White" Padding="15" Margin="15,15,15,0">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="1" BlurRadius="8" Opacity="0.1"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Data Od -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,15,0">
                    <TextBlock Text="Od:" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,8,0"/>
                    <DatePicker x:Name="datePickerOd" Width="130" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Data Do -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,15,0">
                    <TextBlock Text="Do:" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,8,0"/>
                    <DatePicker x:Name="datePickerDo" Width="130" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Przycisk ZaÅ‚aduj -->
                <Button Grid.Column="2" Content="ðŸ” ZaÅ‚aduj" Style="{StaticResource GreenButtonStyle}"
                        Click="BtnLoad_Click" Margin="0,0,10,0" ToolTip="ZaÅ‚aduj dane (F5)"/>

                <!-- Przycisk Ten tydzieÅ„ -->
                <Button Grid.Column="3" Content="ðŸ“… Ten tydzieÅ„" Style="{StaticResource GrayButtonStyle}"
                        Click="BtnThisWeek_Click" Margin="0,0,10,0" ToolTip="Wybierz bieÅ¼Ä…cy tydzieÅ„ roboczy (pon-pt)"/>

                <!-- Przycisk Poprzedni tydzieÅ„ -->
                <Button Grid.Column="4" Content="âª Poprzedni" Style="{StaticResource GrayButtonStyle}"
                        Click="BtnPrevWeek_Click" ToolTip="Wybierz poprzedni tydzieÅ„"/>

                <!-- Separator -->
                <Border Grid.Column="5" Width="1" Background="#E0E0E0" Margin="15,5"/>

                <!-- Stawka za kg -->
                <StackPanel Grid.Column="6" Orientation="Horizontal" Margin="0,0,10,0">
                    <TextBlock Text="ðŸ’° Stawka za kg:" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="#2C3E50" Margin="0,0,8,0"/>
                    <TextBox x:Name="txtStawka" Width="80" VerticalAlignment="Center" TextAlignment="Right"
                             FontWeight="SemiBold" FontSize="14" Padding="5,3" Text="0.119"/>
                    <TextBlock Text="zÅ‚" VerticalAlignment="Center" Foreground="#7F8C8D" Margin="5,0,0,0"/>
                </StackPanel>

                <!-- Przycisk Zapisz stawkÄ™ -->
                <Button Grid.Column="7" Content="ðŸ’¾ Zapisz" Style="{StaticResource OrangeButtonStyle}"
                        Click="BtnSaveStawka_Click" Margin="0,0,10,0" ToolTip="Zapisz nowÄ… stawkÄ™"/>

                <!-- Przycisk Historia stawek -->
                <Button Grid.Column="8" Content="ðŸ“œ" Style="{StaticResource GrayButtonStyle}"
                        Click="BtnHistoriaStawek_Click" ToolTip="Historia zmian stawki" Padding="10,8"/>
            </Grid>
        </Border>

        <!-- === ZAKÅADKI === -->
        <TabControl x:Name="mainTabControl" Grid.Row="2" Margin="15,15,15,0" Background="Transparent"
                    BorderThickness="0" Padding="0">

            <!-- TAB: PODSUMOWANIE DZIENNE -->
            <TabItem Header="ðŸ“Š Podsumowanie">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <TextBlock Text="ðŸ“Š Podsumowanie" FontSize="13" FontWeight="SemiBold" Padding="10,5"/>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Border Background="White" CornerRadius="0,8,8,8" Padding="10">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="1" BlurRadius="5" Opacity="0.1"/>
                    </Border.Effect>
                    <DataGrid x:Name="dataGridDni"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              SelectionUnit="FullRow"
                              GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#EEEEEE"
                              RowHeight="40"
                              AlternatingRowBackground="#FAFAFA"
                              ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}"
                              RowStyle="{StaticResource DataGridRowStyle}"
                              CellStyle="{StaticResource DataGridCellStyle}"
                              BorderThickness="1"
                              BorderBrush="#E0E0E0"
                              MouseDoubleClick="DataGridDni_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="#" Binding="{Binding LP}" Width="40"/>
                            <DataGridTextColumn Header="DzieÅ„" Binding="{Binding DzienTygodnia}" Width="100"/>
                            <DataGridTextColumn Header="Data" Binding="{Binding DataFormatowana}" Width="90"/>
                            <DataGridTextColumn Header="Sztuki" Binding="{Binding SumaSztuk, StringFormat=N0}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Brutto kg" Binding="{Binding SumaBrutto, StringFormat=N0}" Width="90">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Tara kg" Binding="{Binding SumaTara, StringFormat=N0}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Netto kg" Binding="{Binding SumaNetto, StringFormat=N0}" Width="90">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Upadki szt" Binding="{Binding SumaUpadkowSzt, StringFormat=N0}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Foreground" Value="#E65100"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Upadki kg" Binding="{Binding SumaUpadkowKg, StringFormat=N0}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="Foreground" Value="#E65100"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="RÃ³Å¼nica kg" Binding="{Binding SumaRoznicaKg, StringFormat=N0}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#2E7D32"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="KM" Binding="{Binding SumaKM, StringFormat=N0}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Kursy" Binding="{Binding LiczbaKursow}" Width="60">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Zestawy" Binding="{Binding LiczbaZestawow}" Width="70">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Godziny" Binding="{Binding SumaGodzin, StringFormat=N2}" Width="80">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Koszt" Binding="{Binding KosztDnia, StringFormat=N2}" Width="100">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#1565C0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </TabItem>

            <!-- TAB: SZCZEGÃ“ÅY KURSÃ“W -->
            <TabItem Header="ðŸ“‹ SzczegÃ³Å‚y kursÃ³w">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <TextBlock Text="ðŸ“‹ SzczegÃ³Å‚y kursÃ³w" FontSize="13" FontWeight="SemiBold" Padding="10,5"/>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Border Background="White" CornerRadius="0,8,8,8" Padding="10">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="1" BlurRadius="5" Opacity="0.1"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Filtry -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                            <TextBlock Text="ðŸ” Filtruj:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                            <TextBox x:Name="txtFilter" Width="200" Padding="5,3" TextChanged="TxtFilter_TextChanged"
                                     ToolTip="Wpisz nazwÄ™ hodowcy, kierowcy lub numer auta"/>
                            <Button Content="âœ–" Style="{StaticResource GrayButtonStyle}" Padding="8,3" Margin="5,0,0,0"
                                    Click="BtnClearFilter_Click" ToolTip="WyczyÅ›Ä‡ filtr"/>
                        </StackPanel>

                        <DataGrid x:Name="dataGridKursy" Grid.Row="1"
                                  AutoGenerateColumns="False"
                                  IsReadOnly="True"
                                  SelectionMode="Single"
                                  SelectionUnit="FullRow"
                                  GridLinesVisibility="Horizontal"
                                  HorizontalGridLinesBrush="#EEEEEE"
                                  RowHeight="36"
                                  AlternatingRowBackground="#FAFAFA"
                                  ColumnHeaderStyle="{StaticResource DataGridHeaderStyle}"
                                  CellStyle="{StaticResource DataGridCellStyle}"
                                  BorderThickness="1"
                                  BorderBrush="#E0E0E0"
                                  MouseDoubleClick="DataGridKursy_MouseDoubleClick"
                                  EnableRowVirtualization="True">
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Setter Property="Background" Value="White"/>
                                    <Style.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#C8E6C9"/>
                                        </Trigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#E8F5E9"/>
                                        </Trigger>
                                        <DataTrigger Binding="{Binding BrakKilometrow}" Value="True">
                                            <Setter Property="Background" Value="#FFF8E1"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding BrakGodzin}" Value="True">
                                            <Setter Property="Background" Value="#FFE0B2"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding DuzaRoznicaWag}" Value="True">
                                            <Setter Property="Background" Value="#FFCDD2"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="LP" Binding="{Binding LP}" Width="45"/>
                                <DataGridTextColumn Header="Data" Binding="{Binding DataFormatowana}" Width="85"/>
                                <DataGridTextColumn Header="Hodowca" Binding="{Binding HodowcaNazwa}" Width="150"/>
                                <DataGridTextColumn Header="Szt" Binding="{Binding SztukiRazem, StringFormat=N0}" Width="60">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Brutto" Binding="{Binding BruttoHodowcy, StringFormat=N0}" Width="70">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Tara" Binding="{Binding TaraHodowcy, StringFormat=N0}" Width="65">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Netto" Binding="{Binding NettoHodowcy, StringFormat=N0}" Width="70">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Upadki" Binding="{Binding SztukiPadle}" Width="55">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="Foreground" Value="#E65100"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Upadki kg" Binding="{Binding UpadkiKg, StringFormat=N0}" Width="70">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="Foreground" Value="#E65100"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="RÃ³Å¼nica kg" Binding="{Binding RoznicaKg, StringFormat=N0}" Width="85">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="Foreground" Value="#2E7D32"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="KM" Binding="{Binding DystansKM, StringFormat=N0}" Width="55">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Start" Binding="{Binding PoczatekUslugiFormatowany}" Width="55"/>
                                <DataGridTextColumn Header="Koniec" Binding="{Binding KoniecUslugiFormatowany}" Width="55"/>
                                <DataGridTextColumn Header="Godz." Binding="{Binding CzasUslugiGodziny, StringFormat=N2}" Width="55">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="Kierowca" Binding="{Binding KierowcaNazwa}" Width="120"/>
                                <DataGridTextColumn Header="Auto" Binding="{Binding CarID}" Width="90"/>
                                <DataGridTextColumn Header="Naczepa" Binding="{Binding TrailerID}" Width="90"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </TabItem>

            <!-- TAB: STATYSTYKI -->
            <TabItem Header="ðŸ“ˆ Statystyki">
                <TabItem.HeaderTemplate>
                    <DataTemplate>
                        <TextBlock Text="ðŸ“ˆ Statystyki" FontSize="13" FontWeight="SemiBold" Padding="10,5"/>
                    </DataTemplate>
                </TabItem.HeaderTemplate>
                <Border Background="White" CornerRadius="0,8,8,8" Padding="15">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="1" BlurRadius="5" Opacity="0.1"/>
                    </Border.Effect>
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Top 5 HodowcÃ³w -->
                            <Border Grid.Column="0" Grid.Row="0" Style="{StaticResource StatCardStyle}">
                                <StackPanel>
                                    <TextBlock Text="ðŸ† Top 5 HodowcÃ³w wg tonaÅ¼u" FontSize="14" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,10"/>
                                    <ItemsControl x:Name="listTopHodowcy">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,3">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="25"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding Lp}" FontWeight="Bold" Foreground="#4CAF50"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Nazwa}" Margin="5,0"/>
                                                    <TextBlock Grid.Column="2" Text="{Binding Wartosc, StringFormat=N0}" FontWeight="SemiBold" HorizontalAlignment="Right" Margin="0,0,5,0"/>
                                                    <TextBlock Grid.Column="3" Text="kg" Foreground="#7F8C8D"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>

                            <!-- Top 5 KierowcÃ³w -->
                            <Border Grid.Column="1" Grid.Row="0" Style="{StaticResource StatCardStyle}">
                                <StackPanel>
                                    <TextBlock Text="ðŸš— Top 5 KierowcÃ³w wg KM" FontSize="14" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,10"/>
                                    <ItemsControl x:Name="listTopKierowcy">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,3">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="25"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding Lp}" FontWeight="Bold" Foreground="#1976D2"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Nazwa}" Margin="5,0"/>
                                                    <TextBlock Grid.Column="2" Text="{Binding Wartosc, StringFormat=N0}" FontWeight="SemiBold" HorizontalAlignment="Right" Margin="0,0,5,0"/>
                                                    <TextBlock Grid.Column="3" Text="km" Foreground="#7F8C8D"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>

                            <!-- Åšrednie -->
                            <Border Grid.Column="0" Grid.Row="1" Style="{StaticResource StatCardStyle}">
                                <StackPanel>
                                    <TextBlock Text="ðŸ“Š Åšrednie wartoÅ›ci" FontSize="14" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,10"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Åšrednia waga kurczaka:" Margin="0,3"/>
                                        <TextBlock x:Name="txtSredniaWaga" Grid.Row="0" Grid.Column="1" FontWeight="SemiBold" HorizontalAlignment="Right" Margin="0,3"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Åšredni dystans na kurs:" Margin="0,3"/>
                                        <TextBlock x:Name="txtSredniKM" Grid.Row="1" Grid.Column="1" FontWeight="SemiBold" HorizontalAlignment="Right" Margin="0,3"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Åšredni czas kursu:" Margin="0,3"/>
                                        <TextBlock x:Name="txtSredniCzas" Grid.Row="2" Grid.Column="1" FontWeight="SemiBold" HorizontalAlignment="Right" Margin="0,3"/>

                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Åšrednia liczba sztuk na kurs:" Margin="0,3"/>
                                        <TextBlock x:Name="txtSrednieSztuki" Grid.Row="3" Grid.Column="1" FontWeight="SemiBold" HorizontalAlignment="Right" Margin="0,3"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- OstrzeÅ¼enia -->
                            <Border Grid.Column="1" Grid.Row="1" Style="{StaticResource StatCardStyle}">
                                <StackPanel>
                                    <TextBlock Text="âš ï¸ OstrzeÅ¼enia i braki danych" FontSize="14" FontWeight="Bold" Foreground="#E65100" Margin="0,0,0,10"/>
                                    <TextBlock x:Name="txtOstrzezenia" TextWrapping="Wrap" Foreground="#5D4037"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </ScrollViewer>
                </Border>
            </TabItem>
        </TabControl>

        <!-- === PODSUMOWANIE FINANSOWE === -->
        <Border Grid.Row="3" Background="White" Margin="15,15,15,0" Padding="20">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="2" BlurRadius="10" Opacity="0.15"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Wiersz 1 -->
                <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,0,15">
                    <TextBlock Text="ðŸ“¦ Suma sztuk" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtSumaSztuk" Text="0" FontSize="20" FontWeight="Bold" Foreground="#2C3E50"/>
                </StackPanel>

                <StackPanel Grid.Row="0" Grid.Column="1" Margin="0,0,0,15">
                    <TextBlock Text="âš–ï¸ Suma netto" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtSumaNetto" Text="0 kg" FontSize="20" FontWeight="Bold" Foreground="#2C3E50"/>
                </StackPanel>

                <StackPanel Grid.Row="0" Grid.Column="2" Margin="0,0,0,15">
                    <TextBlock Text="ðŸ’€ Suma upadkÃ³w" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtSumaUpadkow" Text="0 kg" FontSize="20" FontWeight="Bold" Foreground="#E65100"/>
                </StackPanel>

                <StackPanel Grid.Row="0" Grid.Column="3" Margin="0,0,0,15">
                    <TextBlock Text="ðŸ“Š RÃ³Å¼nica kg" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtSumaRoznica" Text="0 kg" FontSize="20" FontWeight="Bold" Foreground="#2E7D32"/>
                </StackPanel>

                <!-- Wiersz 2 -->
                <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,0,15">
                    <TextBlock Text="ðŸš— Suma KM" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtSumaKM" Text="0 km" FontSize="20" FontWeight="Bold" Foreground="#2C3E50"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,0,0,15">
                    <TextBlock Text="â±ï¸ Suma godzin" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtSumaGodzin" Text="0 h" FontSize="20" FontWeight="Bold" Foreground="#2C3E50"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="2" Margin="0,0,0,15">
                    <TextBlock Text="ðŸš› Liczba kursÃ³w" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtLiczbaKursow" Text="0" FontSize="20" FontWeight="Bold" Foreground="#2C3E50"/>
                </StackPanel>

                <StackPanel Grid.Row="1" Grid.Column="3" Margin="0,0,0,15">
                    <TextBlock Text="ðŸ”§ ZestawÃ³w" Foreground="#7F8C8D" FontSize="11"/>
                    <TextBlock x:Name="txtLiczbaZestawow" Text="0" FontSize="20" FontWeight="Bold" Foreground="#2C3E50"/>
                </StackPanel>

                <!-- Wiersz 3 - DO ZAPÅATY -->
                <Border Grid.Row="2" Grid.ColumnSpan="4" Background="#E8F5E9" CornerRadius="8" Padding="15" Margin="0,10,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="ðŸ’° DO ZAPÅATY:" FontSize="18" FontWeight="Bold" Foreground="#2E7D32" VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtFormulaDoZaplaty" Text="0 kg Ã— 0.119 zÅ‚ =" FontSize="14" Foreground="#388E3C" VerticalAlignment="Center" Margin="15,0,0,0"/>
                        </StackPanel>

                        <TextBlock x:Name="txtDoZaplaty" Grid.Column="1" Text="0.00 zÅ‚" FontSize="28" FontWeight="Bold" Foreground="#1B5E20"/>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- === PRZYCISKI AKCJI === -->
        <Border Grid.Row="4" Background="White" Margin="15" Padding="15">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="1" BlurRadius="5" Opacity="0.1"/>
            </Border.Effect>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Button Content="ðŸ“Š Eksport Excel" Style="{StaticResource GreenButtonStyle}"
                        Click="BtnExportExcel_Click" Margin="0,0,10,0" ToolTip="Eksportuj do pliku Excel (Ctrl+E)"/>
                <Button Content="ðŸ–¨ï¸ Drukuj raport" Style="{StaticResource GrayButtonStyle}"
                        Click="BtnPrint_Click" Margin="0,0,10,0" ToolTip="Drukuj raport PDF (Ctrl+P)"/>
                <Button Content="ðŸ“§ WyÅ›lij e-mail" Style="{StaticResource GrayButtonStyle}"
                        Click="BtnEmail_Click" Margin="0,0,10,0" ToolTip="WyÅ›lij raport mailem"/>
                <Button Content="ðŸ“‹ Kopiuj do schowka" Style="{StaticResource GrayButtonStyle}"
                        Click="BtnCopy_Click" ToolTip="Kopiuj podsumowanie do schowka (Ctrl+C)"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
