<Window x:Class="Kalendarz1.AnalizaPrzychoduProdukcji.AnalizaPrzychoduWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        Title="Analiza Przychodu Produkcji"
        Height="900" Width="1600"
        MinHeight="700" MinWidth="1200"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        Background="#ECF0F1">

    <Window.Resources>
        <!-- Styl dla przycisków filtrow -->
        <Style x:Key="FilterButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#3498DB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2980B9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1F618D"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Styl dla przycisków eksportu -->
        <Style x:Key="ExportButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#27AE60"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="3"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#229954"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Styl dla kart statystyk -->
        <Style x:Key="StatCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Styl dla ComboBox -->
        <Style x:Key="ModernComboBox" TargetType="ComboBox">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#BDC3C7"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <!-- Styl dla DatePicker -->
        <Style x:Key="ModernDatePicker" TargetType="DatePicker">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#BDC3C7"/>
        </Style>

        <!-- Styl dla TabItem -->
        <Style TargetType="TabItem">
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- NAGLOWEK -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel>
                    <TextBlock Text="ANALIZA PRZYCHODU PRODUKCJI"
                               FontSize="24" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Kompleksowa analiza tempa produkcji, wydajnosci operatorow i przychodu towarow"
                               FontSize="12" Foreground="#BDC3C7" Margin="0,5,0,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Content="Eksport Excel" Style="{StaticResource ExportButtonStyle}"
                            Click="BtnExportExcel_Click" Margin="5,0"/>
                    <Button Content="Zamknij" Background="#E74C3C" Foreground="White"
                            Padding="15,8" Cursor="Hand" BorderThickness="0" Click="BtnClose_Click">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- PANEL FILTROW -->
        <Border Grid.Row="1" Background="White" Padding="15,10" Margin="10,10,10,0">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Wiersz 1: Daty i podstawowe filtry -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <CheckBox x:Name="chkOkresCzasu" Content="Okres czasu" VerticalAlignment="Center"
                              Margin="5" FontWeight="SemiBold" Checked="ChkOkresCzasu_Changed" Unchecked="ChkOkresCzasu_Changed"/>

                    <TextBlock x:Name="lblDataOd" Text="od:" VerticalAlignment="Center" Margin="10,5,5,5"
                               FontWeight="SemiBold" Foreground="#95A5A6"/>
                    <DatePicker x:Name="dpDataOd" Style="{StaticResource ModernDatePicker}" Width="130"
                                IsEnabled="False" Opacity="0.5" SelectedDateChanged="DatePicker_SelectedDateChanged"/>

                    <TextBlock Text="Data:" VerticalAlignment="Center" Margin="15,5,5,5" FontWeight="SemiBold"/>
                    <DatePicker x:Name="dpDataDo" Style="{StaticResource ModernDatePicker}" Width="130"
                                SelectedDateChanged="DatePicker_SelectedDateChanged"/>

                    <TextBlock Text="Towar:" VerticalAlignment="Center" Margin="20,5,5,5" FontWeight="SemiBold"/>
                    <ComboBox x:Name="cbTowar" Style="{StaticResource ModernComboBox}" Width="250"
                              DisplayMemberPath="Nazwa" SelectedValuePath="Id"
                              SelectionChanged="CbTowar_SelectionChanged"/>

                    <TextBlock Text="Operator:" VerticalAlignment="Center" Margin="20,5,5,5" FontWeight="SemiBold"/>
                    <ComboBox x:Name="cbOperator" Style="{StaticResource ModernComboBox}" Width="180"
                              DisplayMemberPath="Nazwa" SelectedValuePath="Id"/>

                    <Button Content="Odswierz filtry" Background="#9B59B6" Foreground="White"
                            Padding="15,8" Cursor="Hand" BorderThickness="0" Click="BtnRefresh_Click" Margin="20,5,5,5">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>

                <!-- Wiersz 2: Dodatkowe filtry -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,10,0,0">
                    <TextBlock Text="Partia (P1):" VerticalAlignment="Center" Margin="5" FontWeight="SemiBold"/>
                    <ComboBox x:Name="cbPartia" Style="{StaticResource ModernComboBox}" Width="150"
                              DisplayMemberPath="Nazwa" SelectedValuePath="Wartosc"/>

                    <TextBlock Text="Terminal:" VerticalAlignment="Center" Margin="20,5,5,5" FontWeight="SemiBold"/>
                    <ComboBox x:Name="cbTerminal" Style="{StaticResource ModernComboBox}" Width="120"
                              DisplayMemberPath="Nazwa" SelectedValuePath="Id"/>

                    <TextBlock Text="Godz. od:" VerticalAlignment="Center" Margin="20,5,5,5" FontWeight="SemiBold"/>
                    <ComboBox x:Name="cbGodzinaOd" Style="{StaticResource ModernComboBox}" Width="70"/>

                    <TextBlock Text="do:" VerticalAlignment="Center" Margin="5" FontWeight="SemiBold"/>
                    <ComboBox x:Name="cbGodzinaDo" Style="{StaticResource ModernComboBox}" Width="70"/>

                    <!-- Panel dla klasy kurczaka (widoczny tylko dla ArticleID=40) -->
                    <StackPanel x:Name="pnlKlasaKurczaka" Orientation="Horizontal" Visibility="Collapsed">
                        <TextBlock Text="Klasa kurczaka:" VerticalAlignment="Center" Margin="20,5,5,5"
                                   FontWeight="SemiBold" Foreground="#E67E22"/>
                        <ComboBox x:Name="cbKlasaKurczaka" Style="{StaticResource ModernComboBox}" Width="100"
                                  DisplayMemberPath="Nazwa" SelectedValuePath="Wartosc"/>
                    </StackPanel>

                    <TextBlock Text="Grupuj po:" VerticalAlignment="Center" Margin="20,5,5,5" FontWeight="SemiBold"/>
                    <ComboBox x:Name="cbGrupowanie" Style="{StaticResource ModernComboBox}" Width="150">
                        <ComboBoxItem Content="Godzina" IsSelected="True"/>
                        <ComboBoxItem Content="Operator"/>
                        <ComboBoxItem Content="Towar"/>
                        <ComboBoxItem Content="Partia"/>
                        <ComboBoxItem Content="Terminal"/>
                        <ComboBoxItem Content="Dzien"/>
                    </ComboBox>

                    <CheckBox x:Name="chkPokazSzczegoly" Content="Pokaz szczegolowe rekordy"
                              VerticalAlignment="Center" Margin="20,5,5,5"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- KARTY STATYSTYK -->
        <Border Grid.Row="2" Margin="10,10,10,0">
            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                <StackPanel Orientation="Horizontal">
                    <!-- Suma kg -->
                    <Border Style="{StaticResource StatCardStyle}" MinWidth="180">
                        <StackPanel>
                            <TextBlock Text="SUMA PRZYCHODU" FontSize="10" Foreground="#7F8C8D" FontWeight="SemiBold"/>
                            <TextBlock x:Name="txtSumaKg" Text="0 kg" FontSize="28" FontWeight="Bold" Foreground="#2C3E50"/>
                            <TextBlock x:Name="txtSumaKgInfo" Text="za wybrany okres" FontSize="10" Foreground="#95A5A6"/>
                        </StackPanel>
                    </Border>

                    <!-- Srednia na godzine -->
                    <Border Style="{StaticResource StatCardStyle}" MinWidth="180">
                        <StackPanel>
                            <TextBlock Text="SREDNIA / GODZINE" FontSize="10" Foreground="#7F8C8D" FontWeight="SemiBold"/>
                            <TextBlock x:Name="txtSredniaGodzina" Text="0 kg/h" FontSize="28" FontWeight="Bold" Foreground="#3498DB"/>
                            <TextBlock x:Name="txtSredniaGodzinaInfo" Text="srednie tempo" FontSize="10" Foreground="#95A5A6"/>
                        </StackPanel>
                    </Border>

                    <!-- Tempo na dzien -->
                    <Border Style="{StaticResource StatCardStyle}" MinWidth="180">
                        <StackPanel>
                            <TextBlock Text="SREDNIA / DZIEN" FontSize="10" Foreground="#7F8C8D" FontWeight="SemiBold"/>
                            <TextBlock x:Name="txtSredniaDzien" Text="0 kg" FontSize="28" FontWeight="Bold" Foreground="#9B59B6"/>
                            <TextBlock x:Name="txtSredniaDzienInfo" Text="dzienna produkcja" FontSize="10" Foreground="#95A5A6"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- GLOWNA ZAWARTOSC - TABS -->
        <TabControl Grid.Row="3" Margin="10" x:Name="tabControl" SelectionChanged="TabControl_SelectionChanged">

            <!-- TAB 1: Wykres godzinowy -->
            <TabItem Header="Wykres przychodu">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <lvc:CartesianChart x:Name="chartPrzychod" Margin="10">
                        <lvc:CartesianChart.Series>
                            <lvc:ColumnSeries Title="Przychod (kg)" Values="{Binding PrzychodValues}"
                                              Fill="#3498DB" MaxColumnWidth="50"/>
                        </lvc:CartesianChart.Series>
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Godzina / Okres" Labels="{Binding PrzychodLabels}"
                                      LabelsRotation="45" FontSize="11"/>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Waga (kg)" LabelFormatter="{Binding YFormatter}" FontSize="11"/>
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>

                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center" Margin="10">
                        <RadioButton x:Name="rbWykresSlupkowy" Content="Slupkowy" IsChecked="True"
                                     Margin="10,0" GroupName="ChartType" Checked="ChartType_Changed"/>
                        <RadioButton x:Name="rbWykresLiniowy" Content="Liniowy"
                                     Margin="10,0" GroupName="ChartType" Checked="ChartType_Changed"/>
                        <RadioButton x:Name="rbWykresObszarowy" Content="Obszarowy"
                                     Margin="10,0" GroupName="ChartType" Checked="ChartType_Changed"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- TAB 2: Porownanie operatorow -->
            <TabItem Header="Analiza operatorow">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>

                    <lvc:CartesianChart x:Name="chartOperatorzy" Margin="10">
                        <lvc:CartesianChart.Series>
                            <lvc:ColumnSeries Title="Suma kg" Values="{Binding OperatorSumaValues}"
                                              Fill="#9B59B6" MaxColumnWidth="60"/>
                        </lvc:CartesianChart.Series>
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Operator" Labels="{Binding OperatorLabels}"
                                      LabelsRotation="45" FontSize="11"/>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Waga (kg)" LabelFormatter="{Binding YFormatter}" FontSize="11"/>
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>

                    <!-- Ranking operatorow -->
                    <Border Grid.Column="1" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="RANKING OPERATOROW" FontSize="14" FontWeight="Bold"
                                       Foreground="#2C3E50" Margin="15,15,15,10"/>

                            <DataGrid x:Name="dgRankingOperatorow" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#F8F9FA">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="#" Binding="{Binding Pozycja}" Width="35"/>
                                    <DataGridTextColumn Header="Operator" Binding="{Binding Nazwa}" Width="*"/>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="80"/>
                                    <DataGridTextColumn Header="Liczba" Binding="{Binding LiczbaWazen}" Width="60"/>
                                    <DataGridTextColumn Header="Sred. kg" Binding="{Binding SredniaKg, StringFormat=N2}" Width="70"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- TAB 3: Analiza partii (interaktywna) -->
            <TabItem Header="Analiza partii">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="450"/>
                    </Grid.ColumnDefinitions>

                    <!-- Lista partii -->
                    <Border Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <StackPanel Margin="15,15,15,10">
                                <TextBlock Text="PARTIE (P1)" FontSize="14" FontWeight="Bold" Foreground="#2C3E50"/>
                                <TextBlock Text="Kliknij partie aby zobaczyc szczegoly, dwuklik na artykul pokazuje wazenia"
                                           FontSize="10" Foreground="#95A5A6" Margin="0,3,0,0"/>
                            </StackPanel>

                            <DataGrid x:Name="dgPartie" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#F8F9FA"
                                      SelectionChanged="DgPartie_SelectionChanged"
                                      MouseDoubleClick="DgPartie_MouseDoubleClick">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Partia" Binding="{Binding Partia}" Width="*" MinWidth="120">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                                <Setter Property="Foreground" Value="#2C3E50"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="100">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                                <Setter Property="Foreground" Value="#27AE60"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="%" Binding="{Binding Procent, StringFormat=N1}" Width="60">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Wazen" Binding="{Binding Liczba}" Width="70">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>

                    <!-- Szczegoly partii - artykuly w partii -->
                    <Border Grid.Column="1" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <StackPanel Margin="15,15,15,10">
                                <TextBlock x:Name="txtPartiaHeader" Text="SZCZEGOLY PARTII" FontSize="14"
                                           FontWeight="Bold" Foreground="#2C3E50"/>
                                <TextBlock x:Name="txtPartiaInfo" Text="Wybierz partie z listy"
                                           FontSize="10" Foreground="#95A5A6" Margin="0,3,0,0"/>
                            </StackPanel>

                            <DataGrid x:Name="dgPartieArtykuly" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#FEF9E7"
                                      MouseDoubleClick="DgPartieArtykuly_MouseDoubleClick">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Artykul" Binding="{Binding ArticleName}" Width="*" MinWidth="150"/>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="80">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                                <Setter Property="FontWeight" Value="SemiBold"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="%" Binding="{Binding Procent, StringFormat=N1}" Width="50">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTextColumn Header="Szt" Binding="{Binding LiczbaWazen}" Width="50">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>

                            <Button x:Name="btnPokazWszystkieWazenia" Grid.Row="2" Content="Pokaz wszystkie wazenia z tej partii"
                                    Margin="10,5,10,10" Padding="10,8" Background="#3498DB" Foreground="White"
                                    FontWeight="SemiBold" Cursor="Hand" BorderThickness="0"
                                    Click="BtnPokazWszystkieWazenia_Click" Visibility="Collapsed">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- TAB: Przychody wg artykulow -->
            <TabItem Header="Przychody wg artykulow">
                <Border Background="White" Margin="10" CornerRadius="8">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Margin="15,15,15,10">
                            <TextBlock Text="PRZYCHODY WG ARTYKULOW" FontSize="14" FontWeight="Bold"
                                       Foreground="#2C3E50"/>
                            <TextBlock Text="Nazwy artykulow z tabeli Article (LibraNet)" FontSize="10"
                                       Foreground="#95A5A6" Margin="0,3,0,0"/>
                        </StackPanel>

                        <DataGrid x:Name="dgPrzychodyArtykuly" Grid.Row="1" Margin="10"
                                  AutoGenerateColumns="False" IsReadOnly="True"
                                  HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                  BorderThickness="0" Background="Transparent"
                                  RowBackground="White" AlternatingRowBackground="#F8F9FA">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding ArticleID}" Width="50"/>
                                <DataGridTextColumn Header="Skrot" Binding="{Binding ShortName}" Width="120"/>
                                <DataGridTextColumn Header="Nazwa artykulu" Binding="{Binding ArticleName}" Width="*" MinWidth="250"/>
                                <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="120">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                                <DataGridTextColumn Header="%" Binding="{Binding Procent, StringFormat=N1}" Width="60"/>
                                <DataGridTextColumn Header="Liczba wazen" Binding="{Binding LiczbaWazen}" Width="100"/>
                                <DataGridTextColumn Header="Sred. kg" Binding="{Binding SredniaKg, StringFormat=N2}" Width="90"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </TabItem>

            <!-- TAB 4: Szczegolowe dane -->
            <TabItem Header="Szczegolowe dane">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <DataGrid x:Name="dgSzczegoly" Margin="10"
                              AutoGenerateColumns="False" IsReadOnly="True"
                              HeadersVisibility="Column" GridLinesVisibility="All"
                              BorderThickness="1" BorderBrush="#E0E0E0"
                              RowBackground="White" AlternatingRowBackground="#F8F9FA"
                              CanUserSortColumns="True" CanUserReorderColumns="True"
                              CanUserResizeColumns="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Data" Binding="{Binding Data, StringFormat=yyyy-MM-dd}" Width="95"/>
                            <DataGridTextColumn Header="Godzina" Binding="{Binding Godzina, StringFormat=HH:mm:ss}" Width="80"/>
                            <DataGridTextColumn Header="Towar" Binding="{Binding NazwaTowaru}" Width="*" MinWidth="200"/>
                            <DataGridTextColumn Header="Waga (kg)" Binding="{Binding ActWeight, StringFormat=N2}" Width="90">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="HorizontalAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="SemiBold"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Operator" Binding="{Binding Operator}" Width="140"/>
                            <DataGridTextColumn Header="Partia" Binding="{Binding Partia}" Width="100"/>
                            <DataGridTextColumn Header="Terminal" Binding="{Binding Terminal}" Width="70"/>
                            <DataGridTextColumn Header="Klasa" Binding="{Binding Klasa}" Width="55"/>
                            <DataGridTextColumn Header="Tara" Binding="{Binding Tara, StringFormat=N2}" Width="60"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="10">
                        <TextBlock x:Name="txtLiczbaWierszy" Text="Wyswietlono: 0 rekordow"
                                   VerticalAlignment="Center" Margin="10,0"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- TAB 5: Analiza dzienna (heatmap) -->
            <TabItem Header="Mapa cieplna">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <StackPanel Margin="15">
                        <TextBlock Text="Mapa cieplna produkcji - intensywnosc przychodu wg godzin"
                                   FontSize="14" Foreground="#7F8C8D"/>
                        <TextBlock Text="Zielony = powyzej normy, Zolty = norma, Czerwony = ponizej normy (w ramach kazdej kolumny godzinowej)"
                                   FontSize="11" Foreground="#95A5A6" Margin="0,5,0,0"/>
                    </StackPanel>

                    <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="icHeatmap" Margin="10">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Vertical"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </TabItem>

            <!-- TAB 6: Podsumowanie grupowane -->
            <TabItem Header="Podsumowanie">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Podsumowanie wg towaru -->
                    <Border Grid.Column="0" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="PODSUMOWANIE WG TOWARU" FontSize="14" FontWeight="Bold"
                                       Foreground="#2C3E50" Margin="15,15,15,10"/>

                            <DataGrid x:Name="dgPodsumowanieTowary" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#F8F9FA">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Towar" Binding="{Binding Nazwa}" Width="*"/>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="100"/>
                                    <DataGridTextColumn Header="Liczba" Binding="{Binding Liczba}" Width="70"/>
                                    <DataGridTextColumn Header="Sred." Binding="{Binding Srednia, StringFormat=N2}" Width="80"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>

                    <!-- Podsumowanie wg dnia -->
                    <Border Grid.Column="1" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="PODSUMOWANIE WG DNIA" FontSize="14" FontWeight="Bold"
                                       Foreground="#2C3E50" Margin="15,15,15,10"/>

                            <DataGrid x:Name="dgPodsumowanieDni" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#F8F9FA">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Data" Binding="{Binding Data, StringFormat=yyyy-MM-dd}" Width="100"/>
                                    <DataGridTextColumn Header="Dzien" Binding="{Binding DzienTygodnia}" Width="100"/>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="100"/>
                                    <DataGridTextColumn Header="Liczba" Binding="{Binding Liczba}" Width="70"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- TAB 7: Analiza zmian (rano/poludnie/wieczor) -->
            <TabItem Header="Analiza zmian">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>

                    <lvc:CartesianChart x:Name="chartZmiany" Margin="10">
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Zmiana" Labels="{Binding ZmianyLabels}" FontSize="11"/>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Waga (kg)" LabelFormatter="{Binding YFormatter}" FontSize="11"/>
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>

                    <!-- Statystyki zmian -->
                    <Border Grid.Column="1" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="15">
                                <TextBlock Text="STATYSTYKI ZMIAN" FontSize="14" FontWeight="Bold"
                                           Foreground="#2C3E50" Margin="0,0,0,15"/>

                                <!-- Zmiana poranna 5-13 -->
                                <Border Background="#E8F6F3" CornerRadius="5" Padding="12" Margin="0,0,0,10">
                                    <StackPanel>
                                        <TextBlock Text="ZMIANA PORANNA (5:00 - 13:00)" FontSize="11"
                                                   FontWeight="SemiBold" Foreground="#16A085"/>
                                        <TextBlock x:Name="txtZmianaPoranna" Text="0 kg" FontSize="20"
                                                   FontWeight="Bold" Foreground="#1ABC9C"/>
                                        <TextBlock x:Name="txtZmianaPorannaSzt" Text="0 wazen" FontSize="10"
                                                   Foreground="#7F8C8D"/>
                                    </StackPanel>
                                </Border>

                                <!-- Zmiana popoludniowa 13-21 -->
                                <Border Background="#FEF5E7" CornerRadius="5" Padding="12" Margin="0,0,0,10">
                                    <StackPanel>
                                        <TextBlock Text="ZMIANA POPOLUDNIOWA (13:00 - 21:00)" FontSize="11"
                                                   FontWeight="SemiBold" Foreground="#D68910"/>
                                        <TextBlock x:Name="txtZmianaPopoludniowa" Text="0 kg" FontSize="20"
                                                   FontWeight="Bold" Foreground="#F39C12"/>
                                        <TextBlock x:Name="txtZmianaPopoludniowaSzt" Text="0 wazen" FontSize="10"
                                                   Foreground="#7F8C8D"/>
                                    </StackPanel>
                                </Border>

                                <!-- Zmiana nocna 21-5 -->
                                <Border Background="#EBF5FB" CornerRadius="5" Padding="12" Margin="0,0,0,10">
                                    <StackPanel>
                                        <TextBlock Text="ZMIANA NOCNA (21:00 - 5:00)" FontSize="11"
                                                   FontWeight="SemiBold" Foreground="#2E86AB"/>
                                        <TextBlock x:Name="txtZmianaNocna" Text="0 kg" FontSize="20"
                                                   FontWeight="Bold" Foreground="#3498DB"/>
                                        <TextBlock x:Name="txtZmianaNocnaSzt" Text="0 wazen" FontSize="10"
                                                   Foreground="#7F8C8D"/>
                                    </StackPanel>
                                </Border>

                                <!-- Najlepsza zmiana -->
                                <Border Background="#FADBD8" CornerRadius="5" Padding="12" Margin="0,15,0,0">
                                    <StackPanel>
                                        <TextBlock Text="NAJLEPSZA ZMIANA" FontSize="11"
                                                   FontWeight="SemiBold" Foreground="#943126"/>
                                        <TextBlock x:Name="txtNajlepszaZmiana" Text="-" FontSize="18"
                                                   FontWeight="Bold" Foreground="#E74C3C"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </TabItem>

            <!-- TAB 8: Porownanie terminali -->
            <TabItem Header="Terminale">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>

                    <lvc:CartesianChart x:Name="chartTerminale" Margin="10">
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Terminal" Labels="{Binding TerminalLabels}" FontSize="11"/>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Waga (kg)" LabelFormatter="{Binding YFormatter}" FontSize="11"/>
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>

                    <!-- Ranking terminali -->
                    <Border Grid.Column="1" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="RANKING TERMINALI" FontSize="14" FontWeight="Bold"
                                       Foreground="#2C3E50" Margin="15,15,15,10"/>

                            <DataGrid x:Name="dgTerminale" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#F8F9FA">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="#" Binding="{Binding Pozycja}" Width="35"/>
                                    <DataGridTextColumn Header="Terminal" Binding="{Binding Nazwa}" Width="*"/>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="90"/>
                                    <DataGridTextColumn Header="Liczba" Binding="{Binding LiczbaWazen}" Width="60"/>
                                    <DataGridTextColumn Header="Sred." Binding="{Binding SredniaKg, StringFormat=N2}" Width="70"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- TAB 9: Analiza klas (dla kurczakow) -->
            <TabItem Header="Klasy kurczaka" x:Name="tabKlasyKurczaka">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="400"/>
                    </Grid.ColumnDefinitions>

                    <lvc:PieChart x:Name="chartKlasy" Margin="10" LegendLocation="Bottom"/>

                    <!-- Statystyki klas -->
                    <Border Grid.Column="1" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <StackPanel Margin="15,15,15,10">
                                <TextBlock Text="ROZKLAD KLAS KURCZAKA" FontSize="14" FontWeight="Bold"
                                           Foreground="#2C3E50"/>
                                <TextBlock Text="Dotyczy tylko ArticleID = 40" FontSize="10"
                                           Foreground="#95A5A6" Margin="0,3,0,0"/>
                            </StackPanel>

                            <DataGrid x:Name="dgKlasy" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#F8F9FA">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Klasa" Binding="{Binding Klasa}" Width="60"/>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="90"/>
                                    <DataGridTextColumn Header="%" Binding="{Binding Procent, StringFormat=N1}" Width="50"/>
                                    <DataGridTextColumn Header="Liczba" Binding="{Binding Liczba}" Width="60"/>
                                    <DataGridTextColumn Header="Sred. kg" Binding="{Binding SredniaKg, StringFormat=N2}" Width="80"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- TAB 10: Analiza dnia tygodnia -->
            <TabItem Header="Dni tygodnia">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="350"/>
                    </Grid.ColumnDefinitions>

                    <lvc:CartesianChart x:Name="chartDniTygodnia" Margin="10">
                        <lvc:CartesianChart.AxisX>
                            <lvc:Axis Title="Dzien tygodnia" Labels="{Binding DniTygodniaLabels}" FontSize="11"/>
                        </lvc:CartesianChart.AxisX>
                        <lvc:CartesianChart.AxisY>
                            <lvc:Axis Title="Srednia kg" LabelFormatter="{Binding YFormatter}" FontSize="11"/>
                        </lvc:CartesianChart.AxisY>
                    </lvc:CartesianChart>

                    <!-- Statystyki dni tygodnia -->
                    <Border Grid.Column="1" Background="White" Margin="10" CornerRadius="8">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Text="STATYSTYKI WG DNIA TYGODNIA" FontSize="14" FontWeight="Bold"
                                       Foreground="#2C3E50" Margin="15,15,15,10"/>

                            <DataGrid x:Name="dgDniTygodnia" Grid.Row="1" Margin="10"
                                      AutoGenerateColumns="False" IsReadOnly="True"
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      BorderThickness="0" Background="Transparent"
                                      RowBackground="White" AlternatingRowBackground="#F8F9FA">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Dzien" Binding="{Binding DzienTygodnia}" Width="*"/>
                                    <DataGridTextColumn Header="Suma kg" Binding="{Binding SumaKg, StringFormat=N2}" Width="90"/>
                                    <DataGridTextColumn Header="Sred. kg" Binding="{Binding SredniaKg, StringFormat=N2}" Width="80"/>
                                    <DataGridTextColumn Header="Dni" Binding="{Binding LiczbaDni}" Width="50"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- STOPKA -->
        <Border Grid.Row="4" Background="#34495E" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="txtStatus" Text="Gotowy do wczytania danych"
                               Foreground="#BDC3C7" VerticalAlignment="Center"/>
                </StackPanel>

                <TextBlock Grid.Column="1" Text="Analiza Przychodu Produkcji v1.0"
                           Foreground="#7F8C8D" VerticalAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>
</Window>
