<Window x:Class="Kalendarz1.Opakowania.Views.SaldaMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Salda Opakowań"
        Height="700" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="#F3F4F6">

    <Window.Resources>
        <!-- Style zakładek -->
        <Style x:Key="TabStyle" TargetType="TabItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" Padding="16,10" Margin="2,0" CornerRadius="8,8,0,0"
                                Background="#E5E7EB" Cursor="Hand">
                            <ContentPresenter ContentSource="Header" HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#3B82F6"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#93C5FD"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <!-- Style przycisków -->
        <Style x:Key="BtnStyle" TargetType="Button">
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Background" Value="#3B82F6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2563EB"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style DataGrid -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RowHeaderWidth" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#E5E7EB"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="IsReadOnly" Value="True"/>
        </Style>

        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="White"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F0F9FF"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#DBEAFE"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="Padding" Value="8,6"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Foreground" Value="Black"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#F9FAFB"/>
            <Setter Property="Padding" Value="8,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#374151"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Nagłówek -->
        <Border Grid.Row="0" Background="White" Padding="20,16" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Salda Opakowań" FontSize="24" FontWeight="Bold" Foreground="#1F2937"/>
                    <TextBlock Text="{Binding NazwaHandlowca, StringFormat=' - {0}'}" FontSize="16"
                               Foreground="#6B7280" VerticalAlignment="Bottom" Margin="8,0,0,2"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Odśwież" Command="{Binding OdswiezCommand}" Style="{StaticResource BtnStyle}" Margin="0,0,8,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Toolbar: szukaj + data -->
        <Border Grid.Row="1" Background="White" Padding="20,12" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Szukaj -->
                <Border Background="#F3F4F6" CornerRadius="6" Padding="12,8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Text="&#xE721;" FontFamily="Segoe MDL2 Assets" Foreground="#9CA3AF"
                                   VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBox Grid.Column="1" Text="{Binding FiltrTekst, UpdateSourceTrigger=PropertyChanged}"
                                 Background="Transparent" BorderThickness="0" VerticalAlignment="Center"
                                 FontSize="14">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Style.Triggers>
                                        <Trigger Property="Text" Value="">
                                            <Setter Property="Background">
                                                <Setter.Value>
                                                    <VisualBrush Stretch="None" AlignmentX="Left">
                                                        <VisualBrush.Visual>
                                                            <TextBlock Text="Szukaj kontrahenta..." Foreground="#9CA3AF"/>
                                                        </VisualBrush.Visual>
                                                    </VisualBrush>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBox.Style>
                        </TextBox>
                    </Grid>
                </Border>

                <!-- Data DO -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="Stan na dzień:" VerticalAlignment="Center" Margin="0,0,8,0" Foreground="#6B7280"/>
                    <DatePicker SelectedDate="{Binding DataDo}" Width="130" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Zakładki + DataGrid -->
        <TabControl Grid.Row="2" Margin="20" SelectedIndex="{Binding WybranaZakladka}">

            <!-- E2 -->
            <TabItem Header="  E2  " Style="{StaticResource TabStyle}">
                <DataGrid ItemsSource="{Binding ListaE2}" SelectedItem="{Binding WybranyKontrahent}"
                          MouseDoubleClick="DataGrid_MouseDoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Kontrahent" Binding="{Binding Kontrahent}" Width="150"/>
                        <DataGridTextColumn Header="Nazwa" Binding="{Binding Nazwa}" Width="*"/>
                        <DataGridTemplateColumn Header="E2" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding E2Tekst}" Foreground="{Binding E2Kolor}"
                                               FontWeight="Bold" HorizontalAlignment="Right"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Handlowiec" Binding="{Binding Handlowiec}" Width="120"/>
                        <DataGridTextColumn Header="Ostatni dok." Binding="{Binding OstatniDokumentTekst}" Width="90"/>
                        <DataGridTemplateColumn Header="" Width="30">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="&#xE73E;" FontFamily="Segoe MDL2 Assets"
                                               Foreground="#22C55E" FontSize="14"
                                               Visibility="{Binding E2Potwierdzone, Converter={StaticResource BoolToVisibility}}"
                                               ToolTip="{Binding E2DataPotwierdzenia, StringFormat='Potwierdzone: {0:dd.MM.yyyy}'}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- H1 -->
            <TabItem Header="  H1  " Style="{StaticResource TabStyle}">
                <DataGrid ItemsSource="{Binding ListaH1}" SelectedItem="{Binding WybranyKontrahent}"
                          MouseDoubleClick="DataGrid_MouseDoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Kontrahent" Binding="{Binding Kontrahent}" Width="150"/>
                        <DataGridTextColumn Header="Nazwa" Binding="{Binding Nazwa}" Width="*"/>
                        <DataGridTemplateColumn Header="H1" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding H1Tekst}" Foreground="{Binding H1Kolor}"
                                               FontWeight="Bold" HorizontalAlignment="Right"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Handlowiec" Binding="{Binding Handlowiec}" Width="120"/>
                        <DataGridTextColumn Header="Ostatni dok." Binding="{Binding OstatniDokumentTekst}" Width="90"/>
                        <DataGridTemplateColumn Header="" Width="30">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="&#xE73E;" FontFamily="Segoe MDL2 Assets"
                                               Foreground="#22C55E" FontSize="14"
                                               Visibility="{Binding H1Potwierdzone, Converter={StaticResource BoolToVisibility}}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- EURO -->
            <TabItem Header=" EURO " Style="{StaticResource TabStyle}">
                <DataGrid ItemsSource="{Binding ListaEURO}" SelectedItem="{Binding WybranyKontrahent}"
                          MouseDoubleClick="DataGrid_MouseDoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Kontrahent" Binding="{Binding Kontrahent}" Width="150"/>
                        <DataGridTextColumn Header="Nazwa" Binding="{Binding Nazwa}" Width="*"/>
                        <DataGridTemplateColumn Header="EURO" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding EUROTekst}" Foreground="{Binding EUROKolor}"
                                               FontWeight="Bold" HorizontalAlignment="Right"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Handlowiec" Binding="{Binding Handlowiec}" Width="120"/>
                        <DataGridTextColumn Header="Ostatni dok." Binding="{Binding OstatniDokumentTekst}" Width="90"/>
                        <DataGridTemplateColumn Header="" Width="30">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="&#xE73E;" FontFamily="Segoe MDL2 Assets"
                                               Foreground="#22C55E" FontSize="14"
                                               Visibility="{Binding EUROPotwierdzone, Converter={StaticResource BoolToVisibility}}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- PCV -->
            <TabItem Header="  PCV  " Style="{StaticResource TabStyle}">
                <DataGrid ItemsSource="{Binding ListaPCV}" SelectedItem="{Binding WybranyKontrahent}"
                          MouseDoubleClick="DataGrid_MouseDoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Kontrahent" Binding="{Binding Kontrahent}" Width="150"/>
                        <DataGridTextColumn Header="Nazwa" Binding="{Binding Nazwa}" Width="*"/>
                        <DataGridTemplateColumn Header="PCV" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding PCVTekst}" Foreground="{Binding PCVKolor}"
                                               FontWeight="Bold" HorizontalAlignment="Right"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Handlowiec" Binding="{Binding Handlowiec}" Width="120"/>
                        <DataGridTextColumn Header="Ostatni dok." Binding="{Binding OstatniDokumentTekst}" Width="90"/>
                        <DataGridTemplateColumn Header="" Width="30">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="&#xE73E;" FontFamily="Segoe MDL2 Assets"
                                               Foreground="#22C55E" FontSize="14"
                                               Visibility="{Binding PCVPotwierdzone, Converter={StaticResource BoolToVisibility}}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- DREW -->
            <TabItem Header=" DREW " Style="{StaticResource TabStyle}">
                <DataGrid ItemsSource="{Binding ListaDREW}" SelectedItem="{Binding WybranyKontrahent}"
                          MouseDoubleClick="DataGrid_MouseDoubleClick">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Kontrahent" Binding="{Binding Kontrahent}" Width="150"/>
                        <DataGridTextColumn Header="Nazwa" Binding="{Binding Nazwa}" Width="*"/>
                        <DataGridTemplateColumn Header="DREW" Width="100">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding DREWTekst}" Foreground="{Binding DREWKolor}"
                                               FontWeight="Bold" HorizontalAlignment="Right"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Handlowiec" Binding="{Binding Handlowiec}" Width="120"/>
                        <DataGridTextColumn Header="Ostatni dok." Binding="{Binding OstatniDokumentTekst}" Width="90"/>
                        <DataGridTemplateColumn Header="" Width="30">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="&#xE73E;" FontFamily="Segoe MDL2 Assets"
                                               Foreground="#22C55E" FontSize="14"
                                               Visibility="{Binding DREWPotwierdzone, Converter={StaticResource BoolToVisibility}}"/>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>

        <!-- Stopka - statystyki -->
        <Border Grid.Row="3" Background="White" Padding="20,12" BorderBrush="#E5E7EB" BorderThickness="0,1,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Kontrahentów: " Foreground="#6B7280"/>
                    <TextBlock Text="{Binding LiczbaKontrahentow}" FontWeight="Bold" Margin="0,0,20,0"/>

                    <TextBlock Text="Wydane: " Foreground="#6B7280"/>
                    <TextBlock Text="{Binding SumaWydane}" FontWeight="Bold" Foreground="#DC2626" Margin="0,0,20,0"/>

                    <TextBlock Text="Zwroty: " Foreground="#6B7280"/>
                    <TextBlock Text="{Binding SumaZwroty}" FontWeight="Bold" Foreground="#16A34A"/>
                </StackPanel>

                <TextBlock Grid.Column="1" Text="{Binding StatusLadowania}" Foreground="#6B7280"/>
            </Grid>
        </Border>

        <!-- Loading overlay -->
        <Border Grid.RowSpan="4" Background="#80FFFFFF" Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibility}}">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                <TextBlock Text="{Binding StatusLadowania}" Margin="0,8,0,0" HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
