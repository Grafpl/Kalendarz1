<Window x:Class="Kalendarz1.Opakowania.Views.SaldoOdbiorcyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
        Title="Szczegoly Salda Kontrahenta"
        Width="1400" Height="900"
        MinWidth="1200" MinHeight="700"
        WindowStartupLocation="CenterOwner"
        Background="#F5F7FA"
        FontFamily="Segoe UI"
        WindowStyle="None">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Resources/OpakowaniaStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Converter dla typu dokumentu do koloru -->
            <Style x:Key="TypDokumentuStyle" TargetType="Border">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding TypDokumentu}" Value="MW1">
                        <Setter Property="Background" Value="#FFEBEE"/>
                        <Setter Property="BorderBrush" Value="#E74C3C"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding TypDokumentu}" Value="MP">
                        <Setter Property="Background" Value="#E8F5E9"/>
                        <Setter Property="BorderBrush" Value="#27AE60"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Window.InputBindings>
        <KeyBinding Key="F5" Command="{Binding OdswiezCommand}"/>
        <KeyBinding Key="P" Modifiers="Ctrl" Command="{Binding DrukujCommand}"/>
        <KeyBinding Key="E" Modifiers="Ctrl" Command="{Binding EksportExcelCommand}"/>
        <KeyBinding Key="Escape" Command="{Binding ZamknijCommand}"/>
    </Window.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="56"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ============================================== -->
        <!-- PASEK TYTULU -->
        <!-- ============================================== -->
        <Border Grid.Row="0" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#1E88E5" Offset="0"/>
                    <GradientStop Color="#42A5F5" Offset="0.5"/>
                    <GradientStop Color="#26A69A" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                    <Border Background="#FFFFFF20" CornerRadius="8" Padding="10,6" Margin="0,0,15,0">
                        <TextBlock Text="SALDO" FontSize="14" FontWeight="Bold" Foreground="White"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="{Binding KontrahentNazwa}" FontSize="18" FontWeight="SemiBold"
                                   Foreground="White" TextTrimming="CharacterEllipsis" MaxWidth="700"/>
                        <TextBlock Text="Szczegolowy widok salda opakowan" FontSize="11" Foreground="#DDFFFFFF" Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="_" Style="{StaticResource WindowButtonStyle}" Click="MinimizeButton_Click"
                            FontSize="16" FontWeight="Bold" Width="46" Height="56"/>
                    <Button Content="[ ]" Style="{StaticResource WindowButtonStyle}" Click="MaximizeButton_Click"
                            FontSize="12" Width="46" Height="56"/>
                    <Button Content="X" Style="{StaticResource CloseButtonStyle}" Click="CloseButton_Click"
                            FontSize="14" FontWeight="Bold" Width="46" Height="56"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================== -->
        <!-- PASEK NARZEDZI -->
        <!-- ============================================== -->
        <Border Grid.Row="1" Background="White" Padding="20,12">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="1" Color="#000" Opacity="0.08" BlurRadius="8"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Background="#F8F9FA" CornerRadius="8" Padding="12,8" Margin="0,0,15,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="OD" FontSize="11" Foreground="#64748B" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <DatePicker SelectedDate="{Binding DataOd}" Style="{StaticResource ModernDatePickerStyle}" Width="120"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#F8F9FA" CornerRadius="8" Padding="12,8" Margin="0,0,15,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="DO" FontSize="11" Foreground="#64748B" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <DatePicker SelectedDate="{Binding DataDo}" Style="{StaticResource ModernDatePickerStyle}" Width="120"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#F8F9FA" CornerRadius="8" Padding="12,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="FILTR" FontSize="11" Foreground="#64748B" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox ItemsSource="{Binding FiltryDat}" SelectedItem="{Binding WybranyFiltrDaty}"
                                      DisplayMemberPath="Nazwa" Style="{StaticResource ModernComboBoxStyle}" Width="140"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Style="{StaticResource InfoButtonStyle}" Command="{Binding ZadzwonCommand}"
                            Visibility="{Binding MaTelefon, Converter={StaticResource BoolToVisibilityConverter}}"
                            ToolTip="Zadzwon do kontrahenta" Margin="0,0,8,0" Padding="12,8">
                        <TextBlock Text="Zadzwon" FontSize="12"/>
                    </Button>
                    <Button Style="{StaticResource InfoButtonStyle}" Command="{Binding WyslijEmailCommand}"
                            Visibility="{Binding MaEmail, Converter={StaticResource BoolToVisibilityConverter}}"
                            ToolTip="Wyslij email" Margin="0,0,8,0" Padding="12,8">
                        <TextBlock Text="Email" FontSize="12"/>
                    </Button>
                    <Button Style="{StaticResource InfoButtonStyle}" Command="{Binding EksportPDFCommand}"
                            ToolTip="Eksportuj do PDF" Margin="0,0,8,0" Padding="12,8">
                        <TextBlock Text="PDF" FontSize="12"/>
                    </Button>
                    <Button Style="{StaticResource InfoButtonStyle}" Command="{Binding EksportExcelCommand}"
                            ToolTip="Eksportuj do Excel" Margin="0,0,8,0" Padding="12,8">
                        <TextBlock Text="Excel" FontSize="12"/>
                    </Button>
                    <Button Style="{StaticResource PrimaryButtonStyle}" Command="{Binding OdswiezCommand}"
                            Padding="16,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Odswiez" FontSize="12" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================== -->
        <!-- KARTY SALD - AKTUALNE -->
        <!-- ============================================== -->
        <Border Grid.Row="2" Background="Transparent" Padding="20,15,20,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- E2 -->
                <Border Grid.Column="0" Margin="0,0,8,0" CornerRadius="12" Background="White">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" Color="#3498DB" Opacity="0.15" BlurRadius="12"/>
                    </Border.Effect>
                    <Grid>
                        <Border CornerRadius="12" BorderThickness="0,0,0,4" BorderBrush="#3498DB"/>
                        <StackPanel Margin="16,14">
                            <TextBlock Text="E2" FontSize="13" FontWeight="Bold" Foreground="#3498DB"/>
                            <TextBlock Text="Pojemnik drobiowy" FontSize="10" Foreground="#94A3B8" Margin="0,2,0,8"/>
                            <TextBlock Text="{Binding SaldoE2}" FontSize="28" FontWeight="Bold"
                                       Foreground="{Binding SaldoE2, Converter={StaticResource SaldoToColorConverter}}"/>
                            <TextBlock Text="{Binding SaldoE2Opis}" FontSize="11" Foreground="#64748B" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- H1 -->
                <Border Grid.Column="1" Margin="4,0" CornerRadius="12" Background="White">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" Color="#E67E22" Opacity="0.15" BlurRadius="12"/>
                    </Border.Effect>
                    <Grid>
                        <Border CornerRadius="12" BorderThickness="0,0,0,4" BorderBrush="#E67E22"/>
                        <StackPanel Margin="16,14">
                            <TextBlock Text="H1" FontSize="13" FontWeight="Bold" Foreground="#E67E22"/>
                            <TextBlock Text="Paleta H1" FontSize="10" Foreground="#94A3B8" Margin="0,2,0,8"/>
                            <TextBlock Text="{Binding SaldoH1}" FontSize="28" FontWeight="Bold"
                                       Foreground="{Binding SaldoH1, Converter={StaticResource SaldoToColorConverter}}"/>
                            <TextBlock Text="{Binding SaldoH1Opis}" FontSize="11" Foreground="#64748B" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- EURO -->
                <Border Grid.Column="2" Margin="4,0" CornerRadius="12" Background="White">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" Color="#27AE60" Opacity="0.15" BlurRadius="12"/>
                    </Border.Effect>
                    <Grid>
                        <Border CornerRadius="12" BorderThickness="0,0,0,4" BorderBrush="#27AE60"/>
                        <StackPanel Margin="16,14">
                            <TextBlock Text="EURO" FontSize="13" FontWeight="Bold" Foreground="#27AE60"/>
                            <TextBlock Text="Paleta EURO" FontSize="10" Foreground="#94A3B8" Margin="0,2,0,8"/>
                            <TextBlock Text="{Binding SaldoEURO}" FontSize="28" FontWeight="Bold"
                                       Foreground="{Binding SaldoEURO, Converter={StaticResource SaldoToColorConverter}}"/>
                            <TextBlock Text="{Binding SaldoEUROOpis}" FontSize="11" Foreground="#64748B" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- PCV -->
                <Border Grid.Column="3" Margin="4,0" CornerRadius="12" Background="White">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" Color="#9B59B6" Opacity="0.15" BlurRadius="12"/>
                    </Border.Effect>
                    <Grid>
                        <Border CornerRadius="12" BorderThickness="0,0,0,4" BorderBrush="#9B59B6"/>
                        <StackPanel Margin="16,14">
                            <TextBlock Text="PCV" FontSize="13" FontWeight="Bold" Foreground="#9B59B6"/>
                            <TextBlock Text="Paleta plastikowa" FontSize="10" Foreground="#94A3B8" Margin="0,2,0,8"/>
                            <TextBlock Text="{Binding SaldoPCV}" FontSize="28" FontWeight="Bold"
                                       Foreground="{Binding SaldoPCV, Converter={StaticResource SaldoToColorConverter}}"/>
                            <TextBlock Text="{Binding SaldoPCVOpis}" FontSize="11" Foreground="#64748B" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- DREW -->
                <Border Grid.Column="4" Margin="8,0,0,0" CornerRadius="12" Background="White">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" Color="#F39C12" Opacity="0.15" BlurRadius="12"/>
                    </Border.Effect>
                    <Grid>
                        <Border CornerRadius="12" BorderThickness="0,0,0,4" BorderBrush="#F39C12"/>
                        <StackPanel Margin="16,14">
                            <TextBlock Text="DREW" FontSize="13" FontWeight="Bold" Foreground="#F39C12"/>
                            <TextBlock Text="Paleta drewniana" FontSize="10" Foreground="#94A3B8" Margin="0,2,0,8"/>
                            <TextBlock Text="{Binding SaldoDREW}" FontSize="28" FontWeight="Bold"
                                       Foreground="{Binding SaldoDREW, Converter={StaticResource SaldoToColorConverter}}"/>
                            <TextBlock Text="{Binding SaldoDREWOpis}" FontSize="11" Foreground="#64748B" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- ============================================== -->
        <!-- GLOWNA ZAWARTOSC - TABELA I WYKRESY -->
        <!-- ============================================== -->
        <Grid Grid.Row="3" Margin="20,5,20,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="500"/>
                <ColumnDefinition Width="420"/>
            </Grid.ColumnDefinitions>

            <!-- LEWA STRONA - Historia dokumentow -->
            <Grid Grid.Column="0" Margin="0,0,15,0">

                <!-- DataGrid dokumentow -->
                <Border Grid.Row="0" Background="White" CornerRadius="12">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.06" BlurRadius="15"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Naglowek tabeli -->
                        <Border Grid.Row="0" Background="#F8FAFC" CornerRadius="12,12,0,0" Padding="16,12">
                            <Grid>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Historia dokumentow" FontSize="15" FontWeight="SemiBold"
                                               Foreground="#1E293B" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Border Background="#E0F2FE" CornerRadius="12" Padding="10,4">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding LiczbaDokumentow}" FontWeight="Bold" Foreground="#0284C7" FontSize="13"/>
                                            <TextBlock Text=" dok." Foreground="#0284C7" FontSize="12"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Tabela -->
                        <DataGrid Grid.Row="1" x:Name="dataGridDokumenty"
                                  ItemsSource="{Binding DokumentyPosortowane}"
                                  Style="{StaticResource ModernDataGridStyle}"
                                  CellStyle="{StaticResource ModernDataGridCellStyle}"
                                  GridLinesVisibility="Horizontal"
                                  HorizontalGridLinesBrush="#F1F5F9"
                                  RowHeight="40"
                                  CanUserSortColumns="False">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ModernDataGridColumnHeaderStyle}">
                                    <Setter Property="Background" Value="#1E88E5"/>
                                    <Setter Property="BorderBrush" Value="#1976D2"/>
                                    <Setter Property="Height" Value="38"/>
                                    <Setter Property="FontSize" Value="11"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow" BasedOn="{StaticResource ModernDataGridRowStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding JestSaldem}" Value="True">
                                            <Setter Property="Background" Value="#FEF9C3"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </DataTrigger>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#F0F9FF"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>
                            <DataGrid.Columns>
                                <!-- Data z dniem tygodnia -->
                                <DataGridTemplateColumn Header="Data" Width="Auto" SortMemberPath="Data">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Data, Converter={StaticResource DateWithDayOfWeekConverter}}"
                                                       VerticalAlignment="Center" Margin="6,0"
                                                       FontWeight="SemiBold" FontSize="11"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- Nr dokumentu -->
                                <DataGridTextColumn Header="Nr dokumentu" Binding="{Binding NumerDokumentu}" Width="Auto">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="VerticalAlignment" Value="Center"/>
                                            <Setter Property="Margin" Value="6,0"/>
                                            <Setter Property="Foreground" Value="#475569"/>
                                            <Setter Property="FontSize" Value="11"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>

                                <!-- Typ dokumentu -->
                                <DataGridTemplateColumn Header="Typ" Width="Auto" SortMemberPath="TypDokumentu">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="4" Padding="5,2" HorizontalAlignment="Center"
                                                    Background="{Binding TypDokumentu, Converter={StaticResource TypToBackgroundConverter}}"
                                                    Visibility="{Binding JestSaldem, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                <TextBlock Text="{Binding TypDokumentuText}" FontSize="10" FontWeight="SemiBold"
                                                           Foreground="{Binding TypDokumentu, Converter={StaticResource TypToForegroundConverter}}"
                                                           HorizontalAlignment="Center"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- E2 z etykieta -->
                                <DataGridTemplateColumn Header="E2" Width="Auto" SortMemberPath="E2">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                <TextBlock Text="{Binding E2}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                           Foreground="{Binding E2, Converter={StaticResource SaldoToColorConverter}}"
                                                           Visibility="{Binding E2, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                <TextBlock Text="{Binding E2Etykieta}" FontSize="8" Foreground="#94A3B8"
                                                           VerticalAlignment="Center" Margin="2,0,0,0"
                                                           Visibility="{Binding E2, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- H1 z etykieta -->
                                <DataGridTemplateColumn Header="H1" Width="Auto" SortMemberPath="H1">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                <TextBlock Text="{Binding H1}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                           Foreground="{Binding H1, Converter={StaticResource SaldoToColorConverter}}"
                                                           Visibility="{Binding H1, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                <TextBlock Text="{Binding H1Etykieta}" FontSize="8" Foreground="#94A3B8"
                                                           VerticalAlignment="Center" Margin="2,0,0,0"
                                                           Visibility="{Binding H1, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- EURO z etykieta -->
                                <DataGridTemplateColumn Header="EURO" Width="Auto" SortMemberPath="EURO">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                <TextBlock Text="{Binding EURO}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                           Foreground="{Binding EURO, Converter={StaticResource SaldoToColorConverter}}"
                                                           Visibility="{Binding EURO, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                <TextBlock Text="{Binding EUROEtykieta}" FontSize="8" Foreground="#94A3B8"
                                                           VerticalAlignment="Center" Margin="2,0,0,0"
                                                           Visibility="{Binding EURO, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- PCV z etykieta -->
                                <DataGridTemplateColumn Header="PCV" Width="Auto" SortMemberPath="PCV">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                <TextBlock Text="{Binding PCV}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                           Foreground="{Binding PCV, Converter={StaticResource SaldoToColorConverter}}"
                                                           Visibility="{Binding PCV, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                <TextBlock Text="{Binding PCVEtykieta}" FontSize="8" Foreground="#94A3B8"
                                                           VerticalAlignment="Center" Margin="2,0,0,0"
                                                           Visibility="{Binding PCV, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- DREW z etykieta -->
                                <DataGridTemplateColumn Header="DREW" Width="Auto" SortMemberPath="DREW">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                <TextBlock Text="{Binding DREW}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                           Foreground="{Binding DREW, Converter={StaticResource SaldoToColorConverter}}"
                                                           Visibility="{Binding DREW, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                <TextBlock Text="{Binding DREWEtykieta}" FontSize="8" Foreground="#94A3B8"
                                                           VerticalAlignment="Center" Margin="2,0,0,0"
                                                           Visibility="{Binding DREW, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>

            </Grid>

            <!-- PRAWA STRONA - Wykresy i podsumowania -->
            <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
                <StackPanel>

                    <!-- WYKRES E2 - Pojemniki drobiowe -->
                    <Border Background="White" CornerRadius="12" Margin="0,0,0,10">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.06" BlurRadius="15"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="150"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="#EBF5FF" CornerRadius="12,12,0,0" Padding="12,8">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="E2 - Pojemnik drobiowy" FontSize="13" FontWeight="SemiBold"
                                                   Foreground="#3498DB" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBlock Text="Saldo: " FontSize="11" Foreground="#64748B" VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding SaldoE2}" FontSize="14" FontWeight="Bold"
                                                   Foreground="{Binding SaldoE2, Converter={StaticResource SaldoToColorConverter}}"
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <WindowsFormsHost Grid.Row="1" x:Name="chartHostE2" Margin="4,2,4,4"/>
                        </Grid>
                    </Border>

                    <!-- WYKRES H1 - Palety -->
                    <Border Background="White" CornerRadius="12" Margin="0,0,0,10">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.06" BlurRadius="15"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="150"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="#FFF7ED" CornerRadius="12,12,0,0" Padding="12,8">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="H1 - Paleta" FontSize="13" FontWeight="SemiBold"
                                                   Foreground="#E67E22" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBlock Text="Saldo: " FontSize="11" Foreground="#64748B" VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding SaldoH1}" FontSize="14" FontWeight="Bold"
                                                   Foreground="{Binding SaldoH1, Converter={StaticResource SaldoToColorConverter}}"
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <WindowsFormsHost Grid.Row="1" x:Name="chartHostH1" Margin="4,2,4,4"/>
                        </Grid>
                    </Border>

                    <!-- Podsumowania opakowan -->
                    <Border Background="White" CornerRadius="12" Margin="0,0,0,10">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.06" BlurRadius="15"/>
                        </Border.Effect>
                        <StackPanel Margin="15">
                            <TextBlock Text="Podsumowanie sald" FontSize="13" FontWeight="SemiBold"
                                       Foreground="#1E293B" Margin="0,0,0,12"/>

                            <!-- E2 -->
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#EBF5FF" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="E2" FontWeight="Bold" Foreground="#3498DB" FontSize="11" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Pojemnik drobiowy" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="10,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoE2}" FontSize="13" FontWeight="Bold"
                                           Foreground="{Binding SaldoE2, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- H1 -->
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#FFF7ED" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="H1" FontWeight="Bold" Foreground="#E67E22" FontSize="11" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Paleta H1" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="10,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoH1}" FontSize="13" FontWeight="Bold"
                                           Foreground="{Binding SaldoH1, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- EURO -->
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#E8F5E9" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="EURO" FontWeight="Bold" Foreground="#27AE60" FontSize="11" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Paleta EURO" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="10,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoEURO}" FontSize="13" FontWeight="Bold"
                                           Foreground="{Binding SaldoEURO, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- PCV -->
                            <Grid Margin="0,0,0,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#F3E8FF" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="PCV" FontWeight="Bold" Foreground="#9B59B6" FontSize="11" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Paleta plastikowa" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="10,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoPCV}" FontSize="13" FontWeight="Bold"
                                           Foreground="{Binding SaldoPCV, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- DREW -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="60"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#FEF3C7" CornerRadius="4" Padding="8,4">
                                    <TextBlock Text="DREW" FontWeight="Bold" Foreground="#F39C12" FontSize="11" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Paleta drewniana" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="10,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoDREW}" FontSize="13" FontWeight="Bold"
                                           Foreground="{Binding SaldoDREW, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Legenda -->
                    <Border Background="White" CornerRadius="12">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.06" BlurRadius="15"/>
                        </Border.Effect>
                        <StackPanel Margin="15">
                            <TextBlock Text="Legenda" FontSize="13" FontWeight="SemiBold"
                                       Foreground="#1E293B" Margin="0,0,0,10"/>

                            <Grid Margin="0,0,0,6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border Width="28" Height="20" Background="#FEF9C3" CornerRadius="4" Margin="0,0,10,0"/>
                                <TextBlock Grid.Column="1" Text="Wiersz salda" FontSize="11" Foreground="#1E293B" VerticalAlignment="Center"/>
                            </Grid>

                            <Grid Margin="0,0,0,6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border Width="28" Height="20" Background="#FEE2E2" CornerRadius="4" Margin="0,0,10,0">
                                    <TextBlock Text="W" FontSize="9" FontWeight="Bold" Foreground="#DC2626"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Wydanie (MW1)" FontSize="11" Foreground="#DC2626" VerticalAlignment="Center"/>
                            </Grid>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Border Width="28" Height="20" Background="#DCFCE7" CornerRadius="4" Margin="0,0,10,0">
                                    <TextBlock Text="P" FontSize="9" FontWeight="Bold" Foreground="#16A34A"
                                               HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Przyjecie (MP)" FontSize="11" Foreground="#16A34A" VerticalAlignment="Center"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- ============================================== -->
        <!-- STOPKA -->
        <!-- ============================================== -->
        <Border Grid.Row="4" Background="White" Padding="20,12">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="-1" Color="#000" Opacity="0.05" BlurRadius="8"/>
            </Border.Effect>
            <Grid>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                    <Border Background="#F1F5F9" CornerRadius="6" Padding="10,5">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Dokumentow: " FontSize="12" Foreground="#64748B"/>
                            <TextBlock Text="{Binding LiczbaDokumentow, Mode=OneWay, FallbackValue=0}"
                                       FontWeight="Bold" Foreground="#1E88E5" FontSize="12"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Zamknij" Style="{StaticResource SecondaryButtonStyle}" Click="CloseButton_Click"
                            Padding="20,8" FontSize="13"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================== -->
        <!-- LOADING OVERLAY -->
        <!-- ============================================== -->
        <Grid Grid.RowSpan="5" Background="#B0FFFFFF"
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border Background="White" CornerRadius="16" Padding="40" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="0" Color="#000" Opacity="0.15" BlurRadius="30"/>
                </Border.Effect>
                <StackPanel HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Width="220" Height="4" Foreground="#1E88E5"/>
                    <TextBlock Text="Ladowanie danych..." FontSize="14" Foreground="#64748B"
                               HorizontalAlignment="Center" Margin="0,18,0,0"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
