<Window x:Class="Kalendarz1.Opakowania.Views.SaldoOdbiorcyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:wf="clr-namespace:System.Windows.Forms;assembly=System.Windows.Forms"
        Title="Szczegoly Salda Kontrahenta"
        Width="1400" Height="900"
        MinWidth="1200" MinHeight="700"
        WindowStartupLocation="CenterOwner"
        Background="#F5F7FA"
        FontFamily="Segoe UI"
        WindowStyle="None">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../Resources/OpakowaniaStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- Converter dla typu dokumentu do koloru -->
            <Style x:Key="TypDokumentuStyle" TargetType="Border">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding TypDokumentu}" Value="MW1">
                        <Setter Property="Background" Value="#FFEBEE"/>
                        <Setter Property="BorderBrush" Value="#E74C3C"/>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding TypDokumentu}" Value="MP">
                        <Setter Property="Background" Value="#E8F5E9"/>
                        <Setter Property="BorderBrush" Value="#27AE60"/>
                    </DataTrigger>
                </Style.Triggers>
            </Style>

            <!-- Styl zakladek -->
            <Style x:Key="ModernTabItemStyle" TargetType="TabItem">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="TabItem">
                            <Border x:Name="Border" Background="Transparent" BorderThickness="0,0,0,3"
                                    BorderBrush="Transparent" Padding="20,10" Cursor="Hand">
                                <ContentPresenter x:Name="ContentSite" ContentSource="Header"
                                                  HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsSelected" Value="True">
                                    <Setter TargetName="Border" Property="BorderBrush" Value="#1E88E5"/>
                                    <Setter TargetName="Border" Property="Background" Value="#E3F2FD"/>
                                </Trigger>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#F5F5F5"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Window.InputBindings>
        <KeyBinding Key="F5" Command="{Binding OdswiezCommand}"/>
        <KeyBinding Key="P" Modifiers="Ctrl" Command="{Binding DrukujCommand}"/>
        <KeyBinding Key="E" Modifiers="Ctrl" Command="{Binding EksportExcelCommand}"/>
        <KeyBinding Key="Escape" Command="{Binding ZamknijCommand}"/>
    </Window.InputBindings>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="56"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ============================================== -->
        <!-- PASEK TYTULU -->
        <!-- ============================================== -->
        <Border Grid.Row="0" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#1E88E5" Offset="0"/>
                    <GradientStop Color="#42A5F5" Offset="0.5"/>
                    <GradientStop Color="#26A69A" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <Grid>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                    <Border Background="#FFFFFF20" CornerRadius="8" Padding="10,6" Margin="0,0,15,0">
                        <TextBlock Text="SALDO" FontSize="14" FontWeight="Bold" Foreground="White"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="{Binding KontrahentNazwa}" FontSize="18" FontWeight="SemiBold"
                                   Foreground="White" TextTrimming="CharacterEllipsis" MaxWidth="700"/>
                        <TextBlock Text="Szczegolowy widok salda opakowan" FontSize="11" Foreground="#DDFFFFFF" Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="_" Style="{StaticResource WindowButtonStyle}" Click="MinimizeButton_Click"
                            FontSize="16" FontWeight="Bold" Width="46" Height="56"/>
                    <Button Content="[ ]" Style="{StaticResource WindowButtonStyle}" Click="MaximizeButton_Click"
                            FontSize="12" Width="46" Height="56"/>
                    <Button Content="X" Style="{StaticResource CloseButtonStyle}" Click="CloseButton_Click"
                            FontSize="14" FontWeight="Bold" Width="46" Height="56"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================== -->
        <!-- PASEK NARZEDZI -->
        <!-- ============================================== -->
        <Border Grid.Row="1" Background="White" Padding="20,12">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="1" Color="#000" Opacity="0.08" BlurRadius="8"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Background="#F8F9FA" CornerRadius="8" Padding="12,8" Margin="0,0,15,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="OD" FontSize="11" Foreground="#64748B" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <DatePicker SelectedDate="{Binding DataOd}" Style="{StaticResource ModernDatePickerStyle}" Width="120"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#F8F9FA" CornerRadius="8" Padding="12,8" Margin="0,0,15,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="DO" FontSize="11" Foreground="#64748B" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <DatePicker SelectedDate="{Binding DataDo}" Style="{StaticResource ModernDatePickerStyle}" Width="120"/>
                        </StackPanel>
                    </Border>
                    <Border Background="#F8F9FA" CornerRadius="8" Padding="12,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="FILTR" FontSize="11" Foreground="#64748B" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox ItemsSource="{Binding FiltryDat}" SelectedItem="{Binding WybranyFiltrDaty}"
                                      DisplayMemberPath="Nazwa" Style="{StaticResource ModernComboBoxStyle}" Width="140"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Style="{StaticResource InfoButtonStyle}" Command="{Binding EksportPDFCommand}"
                            ToolTip="Eksportuj do PDF" Margin="0,0,8,0" Padding="12,8">
                        <TextBlock Text="PDF" FontSize="12"/>
                    </Button>
                    <Button Style="{StaticResource SuccessButtonStyle}" Command="{Binding GenerujPDFiWyslijCommand}"
                            ToolTip="Generuj PDF i wyÅ›lij email" Margin="0,0,8,0" Padding="12,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ“§" FontSize="12" Margin="0,0,4,0"/>
                            <TextBlock Text="PDF + WyÅ›lij" FontSize="12"/>
                        </StackPanel>
                    </Button>
                    <Button Style="{StaticResource InfoButtonStyle}" Command="{Binding EksportExcelCommand}"
                            ToolTip="Eksportuj do Excel" Margin="0,0,8,0" Padding="12,8">
                        <TextBlock Text="Excel" FontSize="12"/>
                    </Button>
                    <Button Style="{StaticResource PrimaryButtonStyle}" Command="{Binding OdswiezCommand}"
                            Padding="16,8">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Odswiez" FontSize="12" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================== -->
        <!-- GLOWNA ZAWARTOSC - TABCONTROL -->
        <!-- ============================================== -->
        <TabControl Grid.Row="2" Margin="20,10,20,10" Background="Transparent" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabControl">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabControl">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Border Background="White" CornerRadius="8" Margin="0,0,0,10">
                                        <TabPanel IsItemsHost="True" Background="Transparent"/>
                                    </Border>
                                    <ContentPresenter Grid.Row="1" ContentSource="SelectedContent"/>
                                </Grid>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>

            <!-- ============================================== -->
            <!-- ZAKLADKA 1: DOKUMENTY -->
            <!-- ============================================== -->
            <TabItem Style="{StaticResource ModernTabItemStyle}">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,8,0"/>
                        <TextBlock Text="Dokumenty" FontSize="13" FontWeight="SemiBold"/>
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="280"/>
                    </Grid.ColumnDefinitions>

                    <!-- LEWA STRONA - Historia dokumentow -->
                    <Border Grid.Column="0" Background="White" CornerRadius="12" Margin="0,0,15,0">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.06" BlurRadius="15"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Naglowek tabeli -->
                            <Border Grid.Row="0" Background="#F8FAFC" CornerRadius="12,12,0,0" Padding="16,12">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Historia dokumentow" FontSize="15" FontWeight="SemiBold"
                                                   Foreground="#1E293B" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Border Background="#E0F2FE" CornerRadius="12" Padding="10,4">
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding LiczbaDokumentow}" FontWeight="Bold" Foreground="#0284C7" FontSize="13"/>
                                                <TextBlock Text=" dok." Foreground="#0284C7" FontSize="12"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- Tabela -->
                            <DataGrid Grid.Row="1" x:Name="dataGridDokumenty"
                                      ItemsSource="{Binding DokumentyPosortowane}"
                                      Style="{StaticResource ModernDataGridStyle}"
                                      CellStyle="{StaticResource ModernDataGridCellStyle}"
                                      GridLinesVisibility="Horizontal"
                                      HorizontalGridLinesBrush="#F1F5F9"
                                      RowHeight="40"
                                      CanUserSortColumns="False">
                                <DataGrid.ColumnHeaderStyle>
                                    <Style TargetType="DataGridColumnHeader" BasedOn="{StaticResource ModernDataGridColumnHeaderStyle}">
                                        <Setter Property="Background" Value="#1E88E5"/>
                                        <Setter Property="BorderBrush" Value="#1976D2"/>
                                        <Setter Property="Height" Value="38"/>
                                        <Setter Property="FontSize" Value="11"/>
                                    </Style>
                                </DataGrid.ColumnHeaderStyle>
                                <DataGrid.RowStyle>
                                    <Style TargetType="DataGridRow" BasedOn="{StaticResource ModernDataGridRowStyle}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding JestSaldem}" Value="True">
                                                <Setter Property="Background" Value="#FEF9C3"/>
                                                <Setter Property="FontWeight" Value="Bold"/>
                                            </DataTrigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#F0F9FF"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.RowStyle>
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Header="Data" Width="Auto" SortMemberPath="Data">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Data, Converter={StaticResource DateWithDayOfWeekConverter}}"
                                                           VerticalAlignment="Center" Margin="6,0"
                                                           FontWeight="SemiBold" FontSize="11"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="Nr dokumentu" Binding="{Binding NumerDokumentu}" Width="Auto">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="VerticalAlignment" Value="Center"/>
                                                <Setter Property="Margin" Value="6,0"/>
                                                <Setter Property="Foreground" Value="#475569"/>
                                                <Setter Property="FontSize" Value="11"/>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                    <DataGridTemplateColumn Header="Typ" Width="Auto">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Border CornerRadius="4" Padding="5,2" HorizontalAlignment="Center"
                                                        Background="{Binding TypDokumentu, Converter={StaticResource TypToBackgroundConverter}}"
                                                        Visibility="{Binding JestSaldem, Converter={StaticResource InverseBoolToVisibilityConverter}}">
                                                    <TextBlock Text="{Binding TypDokumentuText}" FontSize="10" FontWeight="SemiBold"
                                                               Foreground="{Binding TypDokumentu, Converter={StaticResource TypToForegroundConverter}}"
                                                               HorizontalAlignment="Center"/>
                                                </Border>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="E2" Width="Auto">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                    <TextBlock Text="{Binding E2}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                               Foreground="{Binding E2, Converter={StaticResource SaldoToColorConverter}}"
                                                               Visibility="{Binding E2, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                    <TextBlock Text="{Binding E2Etykieta}" FontSize="8" Foreground="#94A3B8"
                                                               VerticalAlignment="Center" Margin="2,0,0,0"
                                                               Visibility="{Binding E2, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="H1" Width="Auto">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                    <TextBlock Text="{Binding H1}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                               Foreground="{Binding H1, Converter={StaticResource SaldoToColorConverter}}"
                                                               Visibility="{Binding H1, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                    <TextBlock Text="{Binding H1Etykieta}" FontSize="8" Foreground="#94A3B8"
                                                               VerticalAlignment="Center" Margin="2,0,0,0"
                                                               Visibility="{Binding H1, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="EURO" Width="Auto">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                    <TextBlock Text="{Binding EURO}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                               Foreground="{Binding EURO, Converter={StaticResource SaldoToColorConverter}}"
                                                               Visibility="{Binding EURO, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                    <TextBlock Text="{Binding EUROEtykieta}" FontSize="8" Foreground="#94A3B8"
                                                               VerticalAlignment="Center" Margin="2,0,0,0"
                                                               Visibility="{Binding EURO, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="PCV" Width="Auto">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                    <TextBlock Text="{Binding PCV}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                               Foreground="{Binding PCV, Converter={StaticResource SaldoToColorConverter}}"
                                                               Visibility="{Binding PCV, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                    <TextBlock Text="{Binding PCVEtykieta}" FontSize="8" Foreground="#94A3B8"
                                                               VerticalAlignment="Center" Margin="2,0,0,0"
                                                               Visibility="{Binding PCV, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Header="DREW" Width="Auto">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="2,0,6,0">
                                                    <TextBlock Text="{Binding DREW}" FontWeight="SemiBold" VerticalAlignment="Center" FontSize="12"
                                                               Foreground="{Binding DREW, Converter={StaticResource SaldoToColorConverter}}"
                                                               Visibility="{Binding DREW, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                    <TextBlock Text="{Binding DREWEtykieta}" FontSize="8" Foreground="#94A3B8"
                                                               VerticalAlignment="Center" Margin="2,0,0,0"
                                                               Visibility="{Binding DREW, Converter={StaticResource NonZeroToVisibilityConverter}}"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>

                    <!-- PRAWA STRONA - Podsumowania -->
                    <Border Grid.Column="1" Background="White" CornerRadius="12">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.06" BlurRadius="15"/>
                        </Border.Effect>
                        <StackPanel Margin="15">
                            <TextBlock Text="Podsumowanie sald" FontSize="14" FontWeight="SemiBold"
                                       Foreground="#1E293B" Margin="0,0,0,15"/>

                            <!-- E2 -->
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="55"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#EBF5FF" CornerRadius="4" Padding="6,4">
                                    <TextBlock Text="E2" FontWeight="Bold" Foreground="#3498DB" FontSize="12" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Pojemnik" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoE2}" FontSize="16" FontWeight="Bold"
                                           Foreground="{Binding SaldoE2, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- H1 -->
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="55"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#FFF7ED" CornerRadius="4" Padding="6,4">
                                    <TextBlock Text="H1" FontWeight="Bold" Foreground="#E67E22" FontSize="12" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Paleta" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoH1}" FontSize="16" FontWeight="Bold"
                                           Foreground="{Binding SaldoH1, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- EURO -->
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="55"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#E8F5E9" CornerRadius="4" Padding="6,4">
                                    <TextBlock Text="EURO" FontWeight="Bold" Foreground="#27AE60" FontSize="12" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Paleta" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoEURO}" FontSize="16" FontWeight="Bold"
                                           Foreground="{Binding SaldoEURO, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- PCV -->
                            <Grid Margin="0,0,0,10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="55"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#F3E8FF" CornerRadius="4" Padding="6,4">
                                    <TextBlock Text="PCV" FontWeight="Bold" Foreground="#9B59B6" FontSize="12" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Plastik" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoPCV}" FontSize="16" FontWeight="Bold"
                                           Foreground="{Binding SaldoPCV, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- DREW -->
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="55"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Border Background="#FEF3C7" CornerRadius="4" Padding="6,4">
                                    <TextBlock Text="DREW" FontWeight="Bold" Foreground="#F39C12" FontSize="12" HorizontalAlignment="Center"/>
                                </Border>
                                <TextBlock Grid.Column="1" Text="Drewno" FontSize="11" Foreground="#64748B"
                                           VerticalAlignment="Center" Margin="8,0,0,0"/>
                                <TextBlock Grid.Column="2" Text="{Binding SaldoDREW}" FontSize="16" FontWeight="Bold"
                                           Foreground="{Binding SaldoDREW, Converter={StaticResource SaldoToColorConverter}}"
                                           VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Legenda -->
                            <Border BorderThickness="0,1,0,0" BorderBrush="#E5E7EB" Padding="0,12,0,0">
                                <StackPanel>
                                    <TextBlock Text="Legenda" FontSize="11" FontWeight="SemiBold" Foreground="#64748B" Margin="0,0,0,8"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                        <Border Width="20" Height="14" Background="#FEF9C3" CornerRadius="3" Margin="0,0,6,0"/>
                                        <TextBlock Text="Saldo" FontSize="10" Foreground="#64748B" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                        <Border Width="20" Height="14" Background="#FEE2E2" CornerRadius="3" Margin="0,0,6,0"/>
                                        <TextBlock Text="Wydanie (MW1)" FontSize="10" Foreground="#DC2626" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Border Width="20" Height="14" Background="#DCFCE7" CornerRadius="3" Margin="0,0,6,0"/>
                                        <TextBlock Text="Przyjecie (MP)" FontSize="10" Foreground="#16A34A" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ============================================== -->
            <!-- ZAKLADKA 2: WYKRESY -->
            <!-- ============================================== -->
            <TabItem Style="{StaticResource ModernTabItemStyle}">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“Š" FontSize="14" Margin="0,0,8,0"/>
                        <TextBlock Text="Wykresy" FontSize="13" FontWeight="SemiBold"/>
                    </StackPanel>
                </TabItem.Header>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- WYKRES E2 - GORA -->
                    <Border Grid.Row="0" Background="#2D2D30" CornerRadius="12" Margin="0,0,0,10">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.15" BlurRadius="15"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#DC3545" CornerRadius="12,12,0,0" Padding="16,10">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="E2 - Pojemniki" FontSize="14" FontWeight="SemiBold"
                                                   Foreground="White" VerticalAlignment="Center"/>
                                        <TextBlock Text=" | Historia sald tygodniowych" FontSize="12"
                                                   Foreground="#FFCDD2" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBlock Text="Aktualne saldo: " FontSize="12" Foreground="#FFCDD2" VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding SaldoE2}" FontSize="16" FontWeight="Bold"
                                                   Foreground="White" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            <WindowsFormsHost Grid.Row="1" x:Name="chartHostE2" Margin="8"/>
                        </Grid>
                    </Border>

                    <!-- WYKRES H1 - DOL -->
                    <Border Grid.Row="1" Background="#2D2D30" CornerRadius="12" Margin="0,10,0,0">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="2" Color="#000" Opacity="0.15" BlurRadius="15"/>
                        </Border.Effect>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            <Border Grid.Row="0" Background="#6C757D" CornerRadius="12,12,0,0" Padding="16,10">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="H1 - Palety" FontSize="14" FontWeight="SemiBold"
                                                   Foreground="White" VerticalAlignment="Center"/>
                                        <TextBlock Text=" | Historia sald tygodniowych" FontSize="12"
                                                   Foreground="#CED4DA" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBlock Text="Aktualne saldo: " FontSize="12" Foreground="#CED4DA" VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding SaldoH1}" FontSize="16" FontWeight="Bold"
                                                   Foreground="White" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            <WindowsFormsHost Grid.Row="1" x:Name="chartHostH1" Margin="8"/>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>
        </TabControl>

        <!-- ============================================== -->
        <!-- STOPKA -->
        <!-- ============================================== -->
        <Border Grid.Row="3" Background="White" Padding="20,12">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="-1" Color="#000" Opacity="0.05" BlurRadius="8"/>
            </Border.Effect>
            <Grid>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center">
                    <Border Background="#F1F5F9" CornerRadius="6" Padding="10,5">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Dokumentow: " FontSize="12" Foreground="#64748B"/>
                            <TextBlock Text="{Binding LiczbaDokumentow, Mode=OneWay, FallbackValue=0}"
                                       FontWeight="Bold" Foreground="#1E88E5" FontSize="12"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Zamknij" Style="{StaticResource SecondaryButtonStyle}" Click="CloseButton_Click"
                            Padding="20,8" FontSize="13"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ============================================== -->
        <!-- LOADING OVERLAY -->
        <!-- ============================================== -->
        <Grid Grid.RowSpan="4" Background="#B0FFFFFF"
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border Background="White" CornerRadius="16" Padding="40" HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="0" Color="#000" Opacity="0.15" BlurRadius="30"/>
                </Border.Effect>
                <StackPanel HorizontalAlignment="Center">
                    <ProgressBar IsIndeterminate="True" Width="220" Height="4" Foreground="#1E88E5"/>
                    <TextBlock Text="Ladowanie danych..." FontSize="14" Foreground="#64748B"
                               HorizontalAlignment="Center" Margin="0,18,0,0"/>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>
