<Window x:Class="Kalendarz1.Opakowania.Views.SaldaSzczegolyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding Tytul}"
        Height="650" Width="950"
        WindowStartupLocation="CenterOwner"
        Background="#F3F4F6">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>

        <!-- Styl przycisków -->
        <Style x:Key="BtnBlue" TargetType="Button">
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Background" Value="#3B82F6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2563EB"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="BtnGreen" TargetType="Button" BasedOn="{StaticResource BtnBlue}">
            <Setter Property="Background" Value="#16A34A"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#15803D"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style kart sald -->
        <Style x:Key="SaldoCard" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="4"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Nagłówek -->
        <Border Grid.Row="0" Background="White" Padding="20,16" BorderBrush="#E5E7EB" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Przycisk wstecz -->
                <Button Content="← Wróć" Command="{Binding WrocCommand}" Style="{StaticResource BtnBlue}"
                        Background="#6B7280"/>

                <!-- Tytuł -->
                <StackPanel Grid.Column="1" Margin="20,0">
                    <TextBlock Text="{Binding Kontrahent.Kontrahent}" FontSize="20" FontWeight="Bold" Foreground="#1F2937"/>
                    <TextBlock Text="{Binding Kontrahent.Nazwa}" FontSize="14" Foreground="#6B7280"/>
                </StackPanel>

                <!-- Przyciski akcji -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Content="PDF" Command="{Binding GenerujPDFCommand}" Style="{StaticResource BtnBlue}" Margin="0,0,8,0"/>
                    <Button Content="PDF + Wyślij" Command="{Binding PDFiEmailCommand}" Style="{StaticResource BtnGreen}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Karty sald -->
        <Grid Grid.Row="1" Margin="16,16,16,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- E2 -->
            <Border Grid.Column="0" Style="{StaticResource SaldoCard}">
                <StackPanel>
                    <TextBlock Text="E2" FontWeight="Bold" Foreground="#6B7280"/>
                    <TextBlock Text="{Binding Kontrahent.E2}" FontSize="28" FontWeight="Bold"
                               Foreground="{Binding Kontrahent.E2Kolor}"/>
                    <TextBlock Text="{Binding E2Opis}" FontSize="11" Foreground="#9CA3AF"/>
                </StackPanel>
            </Border>

            <!-- H1 -->
            <Border Grid.Column="1" Style="{StaticResource SaldoCard}">
                <StackPanel>
                    <TextBlock Text="H1" FontWeight="Bold" Foreground="#6B7280"/>
                    <TextBlock Text="{Binding Kontrahent.H1}" FontSize="28" FontWeight="Bold"
                               Foreground="{Binding Kontrahent.H1Kolor}"/>
                    <TextBlock Text="{Binding H1Opis}" FontSize="11" Foreground="#9CA3AF"/>
                </StackPanel>
            </Border>

            <!-- EURO -->
            <Border Grid.Column="2" Style="{StaticResource SaldoCard}">
                <StackPanel>
                    <TextBlock Text="EURO" FontWeight="Bold" Foreground="#6B7280"/>
                    <TextBlock Text="{Binding Kontrahent.EURO}" FontSize="28" FontWeight="Bold"
                               Foreground="{Binding Kontrahent.EUROKolor}"/>
                    <TextBlock Text="{Binding EUROOpis}" FontSize="11" Foreground="#9CA3AF"/>
                </StackPanel>
            </Border>

            <!-- PCV -->
            <Border Grid.Column="3" Style="{StaticResource SaldoCard}">
                <StackPanel>
                    <TextBlock Text="PCV" FontWeight="Bold" Foreground="#6B7280"/>
                    <TextBlock Text="{Binding Kontrahent.PCV}" FontSize="28" FontWeight="Bold"
                               Foreground="{Binding Kontrahent.PCVKolor}"/>
                    <TextBlock Text="{Binding PCVOpis}" FontSize="11" Foreground="#9CA3AF"/>
                </StackPanel>
            </Border>

            <!-- DREW -->
            <Border Grid.Column="4" Style="{StaticResource SaldoCard}">
                <StackPanel>
                    <TextBlock Text="DREW" FontWeight="Bold" Foreground="#6B7280"/>
                    <TextBlock Text="{Binding Kontrahent.DREW}" FontSize="28" FontWeight="Bold"
                               Foreground="{Binding Kontrahent.DREWKolor}"/>
                    <TextBlock Text="{Binding DREWOpis}" FontSize="11" Foreground="#9CA3AF"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Toolbar dat -->
        <Border Grid.Row="2" Background="White" Margin="16,16,16,0" CornerRadius="8" Padding="16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Od:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <DatePicker SelectedDate="{Binding DataOd}" Width="120"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="20,0,0,0">
                    <TextBlock Text="Do:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <DatePicker SelectedDate="{Binding DataDo}" Width="120"/>
                </StackPanel>

                <!-- Szybkie filtry -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="20,0,0,0">
                    <Button Content="Ten mies." Command="{Binding FiltrTenMiesiacCommand}"
                            Padding="12,6" Background="#E5E7EB" Foreground="#374151"
                            BorderThickness="0" Cursor="Hand" Margin="0,0,4,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Content="3 mies." Command="{Binding Filtr3MiesCommand}"
                            Padding="12,6" Background="#E5E7EB" Foreground="#374151"
                            BorderThickness="0" Cursor="Hand" Margin="0,0,4,0">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    <Button Content="6 mies." Command="{Binding Filtr6MiesCommand}"
                            Padding="12,6" Background="#E5E7EB" Foreground="#374151"
                            BorderThickness="0" Cursor="Hand">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="4" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </StackPanel>

                <TextBlock Grid.Column="3" Text="{Binding LiczbaDokumentow, StringFormat='Dokumentów: {0}'}"
                           VerticalAlignment="Center" Foreground="#6B7280"/>
            </Grid>
        </Border>

        <!-- Tabela dokumentów -->
        <Border Grid.Row="3" Background="White" Margin="16" CornerRadius="8" Padding="0">
            <DataGrid ItemsSource="{Binding Dokumenty}" AutoGenerateColumns="False"
                      IsReadOnly="True" CanUserAddRows="False" CanUserDeleteRows="False"
                      GridLinesVisibility="Horizontal" HorizontalGridLinesBrush="#E5E7EB"
                      RowHeaderWidth="0" BorderThickness="0">

                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Background" Value="{Binding TloWiersza}"/>
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F0F9FF"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.RowStyle>

                <DataGrid.CellStyle>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="8,6"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" Background="Transparent">
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </DataGrid.CellStyle>

                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#F9FAFB"/>
                        <Setter Property="Padding" Value="8,10"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="Foreground" Value="#374151"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>

                <DataGrid.Columns>
                    <DataGridTextColumn Header="Data" Binding="{Binding DataTekst}" Width="90"/>
                    <DataGridTextColumn Header="Dokument" Binding="{Binding NrDokumentu}" Width="*"/>

                    <DataGridTemplateColumn Header="E2" Width="70">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding E2Tekst}" Foreground="{Binding E2Kolor}"
                                           FontWeight="SemiBold" HorizontalAlignment="Right"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="H1" Width="70">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding H1Tekst}" Foreground="{Binding H1Kolor}"
                                           FontWeight="SemiBold" HorizontalAlignment="Right"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="EURO" Width="70">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding EUROTekst}" Foreground="{Binding EUROKolor}"
                                           FontWeight="SemiBold" HorizontalAlignment="Right"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="PCV" Width="70">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding PCVTekst}" Foreground="{Binding PCVKolor}"
                                           FontWeight="SemiBold" HorizontalAlignment="Right"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Header="DREW" Width="70">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding DREWTekst}" Foreground="{Binding DREWKolor}"
                                           FontWeight="SemiBold" HorizontalAlignment="Right"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <DataGridTextColumn Header="Opis" Binding="{Binding Opis}" Width="150"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Loading overlay -->
        <Border Grid.RowSpan="4" Background="#80FFFFFF"
                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibility}}">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                <TextBlock Text="Ładowanie..." Margin="0,8,0,0" HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
