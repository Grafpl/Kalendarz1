<Window x:Class="Kalendarz1.CRM.Dialogs.ImportFirmDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Import firm z pliku Excel" Height="600" Width="800"
        WindowStartupLocation="CenterOwner" ResizeMode="CanResize"
        Background="#0d1117" Foreground="White" MinWidth="600" MinHeight="400">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/CRM/Styles/GlassStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Border Background="#0d1117" BorderBrush="#252530" BorderThickness="1" CornerRadius="8">
        <Grid Margin="16,12">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- HEADER -->
            <TextBlock Grid.Row="0" Text="Import firm z pliku Excel" FontSize="18" FontWeight="Bold" Foreground="White" Margin="0,0,0,12"/>

            <!-- FILE SELECTION -->
            <Grid Grid.Row="1" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="Plik Excel:" FontSize="11" Foreground="#88FFFFFF" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="txtFilePath" Grid.Column="1" IsReadOnly="True" Style="{StaticResource GlassTextBox}" FontSize="11"/>
                <Button Grid.Column="2" Content="Wybierz..." Style="{StaticResource GlassButton}" Padding="12,6" FontSize="11" Margin="8,0,0,0"
                        Click="BtnSelectFile_Click"/>
            </Grid>

            <!-- PREVIEW -->
            <Border Grid.Row="2" Background="#12121A" BorderBrush="#1E1E2A" BorderThickness="1" CornerRadius="8" Margin="0,0,0,8">
                <Grid>
                    <TextBlock x:Name="txtPlaceholder" Text="Wybierz plik Excel aby zobaczyc podglad..."
                               FontSize="12" Foreground="#44FFFFFF" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <DataGrid x:Name="dgPreview" AutoGenerateColumns="True" Background="Transparent"
                              BorderThickness="0" Foreground="White" FontSize="10"
                              IsReadOnly="True" CanUserAddRows="False"
                              HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                              HorizontalGridLinesBrush="#1E1E2A" RowBackground="Transparent"
                              AlternatingRowBackground="#08FFFFFF" Visibility="Collapsed">
                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="#0A0A10"/>
                                <Setter Property="Foreground" Value="#8899AA"/>
                                <Setter Property="FontSize" Value="10"/>
                                <Setter Property="Padding" Value="6,4"/>
                                <Setter Property="BorderBrush" Value="#14FFFFFF"/>
                                <Setter Property="BorderThickness" Value="0,0,0,1"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>
                    </DataGrid>
                </Grid>
            </Border>

            <!-- STATS -->
            <StackPanel Grid.Row="3" Margin="0,0,0,8">
                <TextBlock x:Name="txtStats" Text="" FontSize="12" Foreground="#3fb950" FontWeight="SemiBold"/>
                <TextBlock x:Name="txtWarnings" Text="" FontSize="11" Foreground="#f59e0b" TextWrapping="Wrap"/>
            </StackPanel>

            <!-- OPTIONS -->
            <StackPanel Grid.Row="4" Margin="0,0,0,12">
                <CheckBox x:Name="chkOverwrite" Content="Nadpisz istniejace kontakty o tym samym NIP"
                          Style="{StaticResource GlassCheckBox}" FontSize="11" Foreground="#88FFFFFF" Margin="0,0,0,4"/>
                <CheckBox x:Name="chkMarkImport" Content="Ustaw status 'Nowy - Import' dla zaimportowanych" IsChecked="True"
                          Style="{StaticResource GlassCheckBox}" FontSize="11" Foreground="#88FFFFFF" Margin="0,0,0,4"/>
                <CheckBox x:Name="chkMarkMyImports" Content="Oznacz jako 'moje importy' (priorytet w przypomnieniach)" IsChecked="True"
                          Style="{StaticResource GlassCheckBox}" FontSize="11" Foreground="#f59e0b"/>
            </StackPanel>

            <!-- BOTTOM -->
            <Grid Grid.Row="5">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="Wymagane kolumny: Nazwa firmy *, Telefon 1 *, Miasto *, Wojewodztwo *, PKD *"
                           FontSize="9" Foreground="#44FFFFFF" VerticalAlignment="Center"/>

                <Button Grid.Column="2" Content="Anuluj" Style="{StaticResource GlassButton}" Padding="16,8" FontSize="12" Margin="0,0,8,0"
                        Click="BtnCancel_Click"/>
                <Button x:Name="btnImport" Grid.Column="3" Content="Importuj" Style="{StaticResource SuccessButton}" Padding="20,8" FontSize="12"
                        FontWeight="Bold" IsEnabled="False" Click="BtnImport_Click"/>
            </Grid>
        </Grid>
    </Border>
</Window>
