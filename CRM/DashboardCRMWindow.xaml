<Window x:Class="Kalendarz1.CRM.DashboardCRMWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CRM Dashboard - Statystyki"
        Width="1200" Height="800"
        WindowStartupLocation="CenterScreen"
        Background="#F1F5F9"
        FontFamily="Segoe UI">

    <Window.Resources>
        <SolidColorBrush x:Key="PrimaryColor" Color="#16A34A"/>
        <SolidColorBrush x:Key="PrimaryLight" Color="#DCFCE7"/>
        <SolidColorBrush x:Key="TextDark" Color="#1E293B"/>
        <SolidColorBrush x:Key="TextGray" Color="#64748B"/>
        <SolidColorBrush x:Key="BorderColor" Color="#E2E8F0"/>

        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Opacity="0.08" BlurRadius="20" ShadowDepth="4" Direction="270"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="KpiCardStyle" TargetType="Border" BasedOn="{StaticResource CardStyle}">
            <Setter Property="Padding" Value="20,16"/>
        </Style>
    </Window.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- HEADER -->
        <Grid Grid.Row="0" Margin="0,0,0,24">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="ðŸ“Š" FontSize="28" VerticalAlignment="Center" Margin="0,0,12,0"/>
                <StackPanel>
                    <TextBlock Text="Dashboard CRM" FontSize="24" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                    <TextBlock x:Name="txtPodtytul" Text="Statystyki i analiza aktywnoÅ›ci" FontSize="13" Foreground="{StaticResource TextGray}"/>
                </StackPanel>
            </StackPanel>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                <ComboBox x:Name="cmbOkres" Width="140" Padding="10,8" FontSize="12" SelectionChanged="CmbOkres_SelectionChanged">
                    <ComboBoxItem Content="Ostatnie 7 dni" IsSelected="True"/>
                    <ComboBoxItem Content="Ostatnie 14 dni"/>
                    <ComboBoxItem Content="Ostatnie 30 dni"/>
                    <ComboBoxItem Content="Ten miesiÄ…c"/>
                    <ComboBoxItem Content="Poprzedni miesiÄ…c"/>
                </ComboBox>
                <Button Content="ðŸ”„ OdÅ›wieÅ¼" Padding="16,10" Margin="12,0,0,0" Background="{StaticResource PrimaryColor}"
                        Foreground="White" FontWeight="SemiBold" BorderThickness="0" Cursor="Hand" Click="BtnOdswiez_Click">
                    <Button.Template>
                        <ControlTemplate TargetType="Button">
                            <Border Background="{TemplateBinding Background}" CornerRadius="8">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                            </Border>
                        </ControlTemplate>
                    </Button.Template>
                </Button>
            </StackPanel>
        </Grid>

        <!-- KPI CARDS -->
        <Grid Grid.Row="1" Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Wszystkie kontakty -->
            <Border Grid.Column="0" Style="{StaticResource KpiCardStyle}" Margin="0,0,12,0">
                <StackPanel>
                    <TextBlock Text="WSZYSTKIE KONTAKTY" FontSize="10" FontWeight="Bold" Foreground="{StaticResource TextGray}" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ‘¥" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <TextBlock x:Name="txtKpiWszystkie" Text="0" FontSize="32" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                    </StackPanel>
                    <TextBlock x:Name="txtKpiWszystkieTrend" Text="+0 w tym okresie" FontSize="11" Foreground="{StaticResource PrimaryColor}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- Wykonane akcje -->
            <Border Grid.Column="1" Style="{StaticResource KpiCardStyle}" Margin="0,0,12,0">
                <StackPanel>
                    <TextBlock Text="WYKONANE AKCJE" FontSize="10" FontWeight="Bold" Foreground="{StaticResource TextGray}" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="âœ…" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <TextBlock x:Name="txtKpiAkcje" Text="0" FontSize="32" FontWeight="Bold" Foreground="#16A34A"/>
                    </StackPanel>
                    <TextBlock x:Name="txtKpiAkcjeSrednia" Text="Å›r. 0/dzieÅ„" FontSize="11" Foreground="{StaticResource TextGray}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- SkutecznoÅ›Ä‡ -->
            <Border Grid.Column="2" Style="{StaticResource KpiCardStyle}" Margin="0,0,12,0">
                <StackPanel>
                    <TextBlock Text="SKUTECZNOÅšÄ†" FontSize="10" FontWeight="Bold" Foreground="{StaticResource TextGray}" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸŽ¯" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <TextBlock x:Name="txtKpiSkutecznosc" Text="0%" FontSize="32" FontWeight="Bold" Foreground="#2563EB"/>
                    </StackPanel>
                    <TextBlock Text="pozytywne / wszystkie" FontSize="11" Foreground="{StaticResource TextGray}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- Otwarte oferty -->
            <Border Grid.Column="3" Style="{StaticResource KpiCardStyle}" Margin="0,0,12,0">
                <StackPanel>
                    <TextBlock Text="OTWARTE OFERTY" FontSize="10" FontWeight="Bold" Foreground="{StaticResource TextGray}" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“„" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <TextBlock x:Name="txtKpiOferty" Text="0" FontSize="32" FontWeight="Bold" Foreground="#7C3AED"/>
                    </StackPanel>
                    <TextBlock x:Name="txtKpiOfertyWartosc" Text="do zamkniÄ™cia" FontSize="11" Foreground="{StaticResource TextGray}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- Zaniedbane -->
            <Border Grid.Column="4" Style="{StaticResource KpiCardStyle}">
                <StackPanel>
                    <TextBlock Text="ZANIEDBANE (>30 DNI)" FontSize="10" FontWeight="Bold" Foreground="{StaticResource TextGray}" Margin="0,0,0,8"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="âš ï¸" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <TextBlock x:Name="txtKpiZaniedbane" Text="0" FontSize="32" FontWeight="Bold" Foreground="#DC2626"/>
                    </StackPanel>
                    <TextBlock Text="wymaga uwagi" FontSize="11" Foreground="#DC2626" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- MAIN CONTENT -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- WYKRES AKTYWNOÅšCI -->
            <Border Grid.Column="0" Grid.Row="0" Style="{StaticResource CardStyle}" Margin="0,0,16,16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="ðŸ“ˆ AktywnoÅ›Ä‡ w czasie" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextDark}" Margin="0,0,0,16"/>
                    <Grid Grid.Row="1" x:Name="gridWykres">
                        <ItemsControl x:Name="wykresAktywnosci">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <UniformGrid Rows="1"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Grid Margin="2,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="*"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Border Grid.Row="0" VerticalAlignment="Bottom" CornerRadius="4,4,0,0"
                                                Height="{Binding Wysokosc}" Background="{Binding Kolor}" Margin="4,0">
                                            <Border.ToolTip>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Data}" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding Tooltip}"/>
                                                </StackPanel>
                                            </Border.ToolTip>
                                        </Border>
                                        <TextBlock Grid.Row="1" Text="{Binding Wartosc}" FontSize="10" FontWeight="Bold"
                                                   HorizontalAlignment="Center" Foreground="{StaticResource TextDark}" Margin="0,4,0,0"/>
                                        <TextBlock Grid.Row="2" Text="{Binding Etykieta}" FontSize="9"
                                                   HorizontalAlignment="Center" Foreground="{StaticResource TextGray}"/>
                                    </Grid>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Grid>
                </Grid>
            </Border>

            <!-- ROZKÅAD STATUSÃ“W -->
            <Border Grid.Column="1" Grid.Row="0" Style="{StaticResource CardStyle}" Margin="0,0,0,16">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="ðŸ¥§ RozkÅ‚ad statusÃ³w" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextDark}" Margin="0,0,0,16"/>
                    <ItemsControl Grid.Row="1" x:Name="listaStatusow">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,0,0,12">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Ikona}" FontSize="12" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                            <TextBlock Text="{Binding Nazwa}" FontSize="11" Foreground="{StaticResource TextDark}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <TextBlock Text="{Binding Liczba}" FontSize="11" FontWeight="Bold" Foreground="{StaticResource TextDark}"/>
                                            <TextBlock Text="{Binding Procent, StringFormat=' ({0}%)'}" FontSize="10" Foreground="{StaticResource TextGray}"/>
                                        </StackPanel>
                                    </Grid>
                                    <Border Grid.Row="1" Height="8" CornerRadius="4" Background="#F1F5F9" Margin="0,6,0,0">
                                        <Border CornerRadius="4" HorizontalAlignment="Left" Width="{Binding SzerokoscPaska}" Background="{Binding KolorPaska}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </Border>

            <!-- PORÃ“WNANIE MIESIÄ˜CY -->
            <Border Grid.Column="0" Grid.Row="1" Style="{StaticResource CardStyle}" Margin="0,0,16,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="ðŸ“… PorÃ³wnanie miesiÄ™cy" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextDark}" Margin="0,0,0,16"/>
                    <ItemsControl Grid.Row="1" x:Name="listaMiesiace">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="6"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{Binding TloKarty}" CornerRadius="8" Padding="12,16" Margin="4">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="{Binding NazwaMiesiaca}" FontSize="11" FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextDark}" HorizontalAlignment="Center"/>
                                        <TextBlock Text="{Binding LiczbaAkcji}" FontSize="24" FontWeight="Bold"
                                                   Foreground="{StaticResource PrimaryColor}" HorizontalAlignment="Center" Margin="0,8,0,4"/>
                                        <TextBlock Text="akcji" FontSize="10" Foreground="{StaticResource TextGray}" HorizontalAlignment="Center"/>
                                        <Border Background="{Binding KolorTrendu}" CornerRadius="10" Padding="8,2" Margin="0,8,0,0" HorizontalAlignment="Center">
                                            <TextBlock Text="{Binding Trend}" FontSize="9" FontWeight="Bold" Foreground="White"/>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </Border>

            <!-- TOP HANDLOWCY -->
            <Border Grid.Column="1" Grid.Row="1" Style="{StaticResource CardStyle}">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <TextBlock Text="ðŸ† Top handlowcy" FontSize="14" FontWeight="SemiBold" Foreground="{StaticResource TextDark}" Margin="0,0,0,16"/>
                    <ItemsControl Grid.Row="1" x:Name="listaTopHandlowcy">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#F8FAFC" CornerRadius="8" Padding="12,10" Margin="0,0,0,8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Border Background="{Binding KolorPozycji}" Width="28" Height="28" CornerRadius="14" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Pozycja}" FontSize="12" FontWeight="Bold" Foreground="White"
                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <StackPanel Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding Nazwa}" FontSize="12" FontWeight="SemiBold" Foreground="{StaticResource TextDark}"/>
                                            <TextBlock Text="{Binding Skutecznosc, StringFormat='SkutecznoÅ›Ä‡: {0}%'}" FontSize="10" Foreground="{StaticResource TextGray}"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                            <TextBlock Text="{Binding LiczbaAkcji}" FontSize="18" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}" HorizontalAlignment="Right"/>
                                            <TextBlock Text="akcji" FontSize="9" Foreground="{StaticResource TextGray}" HorizontalAlignment="Right"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
