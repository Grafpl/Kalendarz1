<Window x:Class="Kalendarz1.CRM.CallReminderWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Czas na telefony!"
        Width="1400" Height="900"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        WindowStyle="SingleBorderWindow"
        Background="#0d1117"
        Topmost="True"
        ResizeMode="CanResize"
        MinWidth="1100" MinHeight="750">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Styles/GlassStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <BooleanToVisibilityConverter x:Key="BoolToVisibility"/>

            <!-- Contact List Item Template -->
            <DataTemplate x:Key="ContactListItemTemplate">
                <Border x:Name="contactBorder" Background="#08FFFFFF" BorderBrush="#14FFFFFF"
                        BorderThickness="1" CornerRadius="12" Padding="16" Margin="0,4"
                        Cursor="Hand">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Priority Dot -->
                        <Ellipse x:Name="priorityDot" Grid.Column="0" Grid.RowSpan="3"
                                 Width="10" Height="10" VerticalAlignment="Top" Margin="0,4,12,0">
                            <Ellipse.Fill>
                                <SolidColorBrush Color="{Binding PriorityColor}"/>
                            </Ellipse.Fill>
                            <Ellipse.Effect>
                                <DropShadowEffect ShadowDepth="0" Color="{Binding PriorityColor}" Opacity="0.6" BlurRadius="8"/>
                            </Ellipse.Effect>
                        </Ellipse>

                        <!-- Company Name -->
                        <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Nazwa}"
                                   FontSize="14" FontWeight="Medium" Foreground="White"
                                   TextTrimming="CharacterEllipsis" MaxWidth="160"/>

                        <!-- Location + PKD -->
                        <StackPanel Grid.Column="1" Grid.Row="1" Orientation="Horizontal" Margin="0,4,0,0">
                            <TextBlock Text="ðŸ“" FontSize="11" Margin="0,0,4,0"/>
                            <TextBlock Text="{Binding Miasto}" FontSize="12" Foreground="#66FFFFFF" Margin="0,0,10,0"/>
                            <Border Background="#33a78bfa" CornerRadius="4" Padding="6,2"
                                    Visibility="{Binding HasPKD, Converter={StaticResource BoolToVisibility}}">
                                <TextBlock Text="{Binding PKD}" FontSize="10" Foreground="#a78bfa" FontFamily="Consolas"/>
                            </Border>
                        </StackPanel>

                        <!-- Phone + Status -->
                        <StackPanel Grid.Column="1" Grid.Row="2" Orientation="Horizontal" Margin="0,6,0,0">
                            <TextBlock Text="{Binding Telefon}" FontSize="13" FontWeight="Medium" Foreground="#58a6ff"/>
                            <Border x:Name="statusBadge" Background="{Binding StatusBackground}"
                                    CornerRadius="10" Padding="8,3" Margin="12,0,0,0">
                                <TextBlock Text="{Binding StatusShort}" FontSize="10" Foreground="{Binding StatusColor}"/>
                            </Border>
                        </StackPanel>

                        <!-- Completed Check -->
                        <Border Grid.Column="2" Grid.RowSpan="3" VerticalAlignment="Center"
                                Background="#2E3fb950" CornerRadius="20" Width="30" Height="30"
                                Visibility="{Binding IsCompleted, Converter={StaticResource BoolToVisibility}}">
                            <TextBlock Text="âœ“" FontSize="16" Foreground="#3fb950"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                </Border>
                <DataTemplate.Triggers>
                    <DataTrigger Binding="{Binding IsSelected}" Value="True">
                        <Setter TargetName="contactBorder" Property="Background" Value="#2658a6ff"/>
                        <Setter TargetName="contactBorder" Property="BorderBrush" Value="#4D58a6ff"/>
                    </DataTrigger>
                    <Trigger SourceName="contactBorder" Property="IsMouseOver" Value="True">
                        <Setter TargetName="contactBorder" Property="Background" Value="#14FFFFFF"/>
                    </Trigger>
                </DataTemplate.Triggers>
            </DataTemplate>
        </ResourceDictionary>
    </Window.Resources>

    <Window.Triggers>
        <EventTrigger RoutedEvent="Loaded">
            <BeginStoryboard>
                <Storyboard>
                    <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.3"/>
                </Storyboard>
            </BeginStoryboard>
        </EventTrigger>
    </Window.Triggers>

    <Border BorderThickness="0">
        <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                <GradientStop Color="#0d1117" Offset="0"/>
                <GradientStop Color="#161b22" Offset="0.5"/>
                <GradientStop Color="#0d1117" Offset="1"/>
            </LinearGradientBrush>
        </Border.Background>

        <Grid>
            <!-- Decorative Background Blobs -->
            <Ellipse Width="400" Height="400" HorizontalAlignment="Left" VerticalAlignment="Top"
                     Margin="-100,-100,0,0" Opacity="0.08" IsHitTestVisible="False">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#58a6ff" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="80"/>
                </Ellipse.Effect>
            </Ellipse>

            <Ellipse Width="300" Height="300" HorizontalAlignment="Right" VerticalAlignment="Bottom"
                     Margin="0,0,-50,-50" Opacity="0.06" IsHitTestVisible="False">
                <Ellipse.Fill>
                    <RadialGradientBrush>
                        <GradientStop Color="#a78bfa" Offset="0"/>
                        <GradientStop Color="Transparent" Offset="1"/>
                    </RadialGradientBrush>
                </Ellipse.Fill>
                <Ellipse.Effect>
                    <BlurEffect Radius="80"/>
                </Ellipse.Effect>
            </Ellipse>

            <Grid Margin="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="420"/>
                </Grid.ColumnDefinitions>

                <!-- ============================================ -->
                <!-- LEFT PANEL - Contact List                    -->
                <!-- ============================================ -->
                <Border Grid.Column="0" Background="#08FFFFFF" BorderBrush="#14FFFFFF"
                        BorderThickness="0,0,1,0" CornerRadius="20,0,0,20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Header -->
                        <Border Grid.Row="0" Padding="20,20,20,16" Background="#08FFFFFF"
                                BorderBrush="#14FFFFFF" BorderThickness="0,0,0,1" CornerRadius="20,0,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“ž" FontSize="20" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtContactsCount" Text="Kontakty (5)" FontSize="18"
                                               FontWeight="SemiBold" Foreground="White" Margin="10,0,0,0"
                                               VerticalAlignment="Center"/>
                                </StackPanel>

                                <Button Grid.Column="1" Content="ðŸ”„" Style="{StaticResource GlassButton}"
                                        Padding="10,8" Click="BtnRefresh_Click" ToolTip="OdÅ›wieÅ¼ kontakty"/>
                            </Grid>
                        </Border>

                        <!-- Filter Tabs -->
                        <Border Grid.Row="1" Background="#08FFFFFF" Padding="16,12">
                            <Border Background="#0CFFFFFF" CornerRadius="8" Padding="3">
                                <StackPanel Orientation="Horizontal">
                                    <ToggleButton x:Name="tabAll" Content="Wszystkie" Style="{StaticResource GlassToggleButton}"
                                                  IsChecked="True" Checked="FilterTab_Checked"/>
                                    <ToggleButton x:Name="tabNew" Content="Nowe" Style="{StaticResource GlassToggleButton}"
                                                  Checked="FilterTab_Checked" Margin="4,0"/>
                                    <ToggleButton x:Name="tabHot" Content="GorÄ…ce" Style="{StaticResource GlassToggleButton}"
                                                  Checked="FilterTab_Checked"/>
                                </StackPanel>
                            </Border>
                        </Border>

                        <!-- Contact List -->
                        <ScrollViewer Grid.Row="2" Style="{StaticResource GlassScrollViewer}"
                                      VerticalScrollBarVisibility="Auto" Padding="12,8">
                            <ItemsControl x:Name="contactsList" ItemTemplate="{StaticResource ContactListItemTemplate}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Progress Footer -->
                        <Border Grid.Row="3" Background="#08FFFFFF" Padding="16" BorderBrush="#14FFFFFF"
                                BorderThickness="0,1,0,0" CornerRadius="0,0,0,20">
                            <StackPanel>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock x:Name="txtProgressLabel" Text="PostÄ™p sesji" FontSize="12"
                                               Foreground="#66FFFFFF"/>
                                    <TextBlock x:Name="txtProgressCount" Grid.Column="1" Text="0/5"
                                               FontSize="12" FontWeight="SemiBold" Foreground="#3fb950"/>
                                </Grid>
                                <Border Background="#1AFFFFFF" CornerRadius="4" Height="6" Margin="0,8,0,0">
                                    <Border x:Name="progressFill" Background="#3fb950" CornerRadius="4"
                                            HorizontalAlignment="Left" Width="0">
                                        <Border.Effect>
                                            <DropShadowEffect ShadowDepth="0" Color="#3fb950" Opacity="0.5" BlurRadius="8"/>
                                        </Border.Effect>
                                    </Border>
                                </Border>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!-- ============================================ -->
                <!-- RIGHT PANEL - Contact Details                -->
                <!-- ============================================ -->
                <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto"
                              Style="{StaticResource GlassScrollViewer}">
                    <Grid x:Name="detailsPanel" Margin="20,14,20,14">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Header Row -->
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel>
                                <TextBlock x:Name="txtCompanyName" Text="Wybierz kontakt z listy"
                                           FontSize="22" FontWeight="SemiBold" Foreground="White"
                                           TextTrimming="CharacterEllipsis"/>
                                <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                    <TextBlock Text="ðŸ“" FontSize="12" Margin="0,0,4,0"/>
                                    <TextBlock x:Name="txtAddress" Text="-" FontSize="14" Foreground="#B3FFFFFF"/>
                                    <TextBlock x:Name="txtNIP" Text="" FontSize="14" Foreground="#66FFFFFF" Margin="20,0,0,0"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Status Badge (clickable) -->
                            <Border x:Name="statusBadgeMain" Grid.Column="1" CornerRadius="10"
                                    Padding="12,6" Margin="0,0,12,0" Cursor="Hand"
                                    MouseLeftButtonUp="StatusBadge_Click">
                                <TextBlock x:Name="txtStatusMain" Text="-" FontSize="12" FontWeight="Medium"/>
                            </Border>

                            <!-- Close Button -->
                            <Button Grid.Column="2" Content="âœ•" Style="{StaticResource GlassButton}"
                                    Width="40" Height="40" Padding="0" FontSize="16"
                                    Click="BtnCloseWindow_Click"/>
                        </Grid>

                        <!-- PKD Section -->
                        <Border x:Name="pkdSection" Grid.Row="1" Margin="0,10,0,0"
                                Background="#1Aa78bfa" BorderBrush="#33a78bfa" BorderThickness="1"
                                CornerRadius="12" Padding="16" Visibility="Collapsed">
                            <StackPanel Orientation="Horizontal">
                                <Border Background="#33a78bfa" CornerRadius="6" Padding="10,6">
                                    <TextBlock x:Name="txtPKDCode" Text="46.32.Z" FontSize="14"
                                               FontWeight="Bold" Foreground="#a78bfa" FontFamily="Consolas"/>
                                </Border>
                                <TextBlock x:Name="txtPKDName" Text="SprzedaÅ¼ hurtowa miÄ™sa..."
                                           FontSize="14" Foreground="#B3FFFFFF" Margin="16,0,0,0"
                                           VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                            </StackPanel>
                        </Border>

                        <!-- Phone Section -->
                        <Border Grid.Row="2" Margin="0,10,0,0" CornerRadius="14" Padding="18"
                                BorderBrush="#4D58a6ff" BorderThickness="1">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#2658a6ff" Offset="0"/>
                                    <GradientStop Color="#0D58a6ff" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>

                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Text="TELEFON GÅÃ“WNY" FontSize="11" Foreground="#66FFFFFF"
                                           FontWeight="SemiBold"/>

                                <TextBlock x:Name="txtMainPhone" Grid.Row="1" Text="-"
                                           FontSize="24" FontWeight="Bold" Foreground="#58a6ff"
                                           Margin="0,6,0,0"/>

                                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,12,0,0">
                                    <StackPanel Orientation="Horizontal" Visibility="{Binding HasPhone2, Converter={StaticResource BoolToVisibility}}">
                                        <TextBlock Text="TELEFON 2:" FontSize="12" Foreground="#66FFFFFF" FontWeight="Medium"/>
                                        <TextBlock x:Name="txtPhone2" Text="" FontSize="13" Foreground="#B3FFFFFF" Margin="8,0,24,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" x:Name="emailStack">
                                        <TextBlock Text="EMAIL:" FontSize="12" Foreground="#66FFFFFF" FontWeight="Medium"/>
                                        <TextBlock x:Name="txtEmail" Text="" FontSize="13" Foreground="#B3FFFFFF" Margin="8,0,0,0"/>
                                    </StackPanel>
                                </StackPanel>

                                <Button x:Name="btnCall" Grid.Row="3" Style="{StaticResource PrimaryButton}"
                                        Margin="0,12,0,0" Click="BtnCall_Click" IsEnabled="False">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ðŸ“ž" FontSize="18" Margin="0,0,10,0"/>
                                        <TextBlock Text="ZADZWOÅƒ TERAZ" FontSize="15" FontWeight="Bold"/>
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- Status Change Section -->
                        <Border Grid.Row="3" Margin="0,10,0,0" Background="#08FFFFFF"
                                BorderBrush="#14FFFFFF" BorderThickness="1" CornerRadius="10" Padding="12">
                            <StackPanel>
                                <TextBlock Text="ðŸ”„ ZMIEÅƒ STATUS" FontSize="11" Foreground="#66FFFFFF"
                                           FontWeight="SemiBold"/>

                                <WrapPanel x:Name="statusButtons" Margin="0,12,0,0">
                                    <!-- Status buttons will be generated in code-behind -->
                                </WrapPanel>
                            </StackPanel>
                        </Border>

                        <!-- Last Note Section -->
                        <Border x:Name="lastNoteSection" Grid.Row="4" Margin="0,10,0,0"
                                Background="#1Ad29922" BorderBrush="#33d29922" BorderThickness="1"
                                CornerRadius="12" Padding="16" Visibility="Collapsed">
                            <StackPanel>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ðŸ’¬" FontSize="12" Margin="0,0,6,0"/>
                                        <TextBlock Text="OSTATNIA NOTATKA" FontSize="11"
                                                   Foreground="#d29922" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <TextBlock x:Name="txtLastNoteAuthor" Grid.Column="1" Text=""
                                               FontSize="12" Foreground="#66FFFFFF"/>
                                </Grid>
                                <Border Height="1" Background="#33d29922" Margin="0,10,0,10"/>
                                <TextBlock x:Name="txtLastNote" Text="" FontSize="14" Foreground="#B3FFFFFF"
                                           TextWrapping="Wrap" LineHeight="22"/>
                            </StackPanel>
                        </Border>

                        <!-- New Note Section -->
                        <Border Grid.Row="5" Margin="0,10,0,0" Background="#08FFFFFF"
                                BorderBrush="#14FFFFFF" BorderThickness="1" CornerRadius="10" Padding="12">
                            <StackPanel>
                                <TextBlock Text="ðŸ“ DODAJ NOTATKÄ˜" FontSize="11" Foreground="#66FFFFFF"
                                           FontWeight="SemiBold"/>

                                <TextBox x:Name="txtNewNote" Style="{StaticResource GlassTextBox}"
                                         Margin="0,12,0,0" AcceptsReturn="True" TextWrapping="Wrap"
                                         MaxLength="500" MinHeight="60" MaxHeight="100"
                                         TextChanged="TxtNewNote_TextChanged"/>

                                <Grid Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBlock x:Name="txtNoteCharCount" Text="0/500 znakÃ³w" FontSize="12"
                                               Foreground="#66FFFFFF" VerticalAlignment="Center"/>

                                    <Button x:Name="btnSaveNote" Grid.Column="1" Click="BtnSaveNote_Click"
                                            IsEnabled="False" Padding="20,10">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Background" Value="#08FFFFFF"/>
                                                <Setter Property="Foreground" Value="#4DFFFFFF"/>
                                                <Setter Property="BorderBrush" Value="#14FFFFFF"/>
                                                <Setter Property="BorderThickness" Value="1"/>
                                                <Setter Property="Cursor" Value="Hand"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Button">
                                                            <Border x:Name="bd" Background="{TemplateBinding Background}"
                                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                                    CornerRadius="8" Padding="{TemplateBinding Padding}">
                                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                                <Style.Triggers>
                                                    <Trigger Property="IsEnabled" Value="True">
                                                        <Setter Property="Background" Value="#303fb950"/>
                                                        <Setter Property="BorderBrush" Value="#3fb950"/>
                                                        <Setter Property="Foreground" Value="#3fb950"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="ðŸ’¾" FontSize="12" Margin="0,0,6,0"/>
                                            <TextBlock Text="Zapisz notatkÄ™" FontSize="12" FontWeight="Medium"/>
                                        </StackPanel>
                                    </Button>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Quick Actions -->
                        <Grid Grid.Row="6" Margin="0,10,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0" Style="{StaticResource IconButton}" Margin="0,0,5,0"
                                    Click="BtnGoogle_Click">
                                <StackPanel>
                                    <TextBlock Text="ðŸ”" FontSize="18" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Google" FontSize="12" Foreground="#66FFFFFF"
                                               HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Button>

                            <Button Grid.Column="1" Style="{StaticResource IconButton}" Margin="5,0"
                                    Click="BtnMap_Click">
                                <StackPanel>
                                    <TextBlock Text="ðŸ—ºï¸" FontSize="18" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Mapa" FontSize="12" Foreground="#66FFFFFF"
                                               HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Button>

                            <Button Grid.Column="2" Style="{StaticResource IconButton}" Margin="5,0"
                                    Click="BtnHistory_Click">
                                <StackPanel>
                                    <TextBlock Text="ðŸ“‹" FontSize="18" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Historia" FontSize="12" Foreground="#66FFFFFF"
                                               HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Button>

                            <Button Grid.Column="3" Style="{StaticResource IconButton}" Margin="5,0"
                                    Click="BtnEmail_Click">
                                <StackPanel>
                                    <TextBlock Text="ðŸ“§" FontSize="18" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Email" FontSize="12" Foreground="#66FFFFFF"
                                               HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Button>

                            <Button Grid.Column="4" Style="{StaticResource DangerButton}" Margin="5,0,0,0"
                                    Click="BtnSkip_Click">
                                <StackPanel>
                                    <TextBlock Text="â­" FontSize="18" HorizontalAlignment="Center"/>
                                    <TextBlock Text="PomiÅ„" FontSize="12"
                                               HorizontalAlignment="Center" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Button>
                        </Grid>

                        <!-- Footer Stats -->
                        <Border Grid.Row="7" Margin="0,10,0,0" BorderBrush="#14FFFFFF"
                                BorderThickness="0,1,0,0" Padding="0,10,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“ž" FontSize="12" Margin="0,0,6,0"/>
                                    <TextBlock x:Name="txtCallCount" Text="0 poÅ‚Ä…czeÅ„" FontSize="12" Foreground="#66FFFFFF"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock Text="Ostatnie:" FontSize="12" Foreground="#66FFFFFF"/>
                                    <TextBlock x:Name="txtLastCall" Text="-" FontSize="12" Foreground="#B3FFFFFF" Margin="6,0,0,0"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" Orientation="Horizontal">
                                    <TextBlock Text="ðŸ‘¤" FontSize="12" Margin="0,0,6,0"/>
                                    <TextBlock x:Name="txtAssignedTo" Text="-" FontSize="12" Foreground="#66FFFFFF"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                    </Grid>
                </ScrollViewer>

                <!-- ============================================ -->
                <!-- FLOW PANEL - Pomocnik rozmowy                -->
                <!-- ============================================ -->
                <Border Grid.Column="2" x:Name="FlowPanel"
                        Background="#FF0A0A0F" BorderBrush="#FF1A1A24"
                        BorderThickness="1,0,0,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- ROW 0: Phase Tabs (white Path icons) -->
                        <UniformGrid Grid.Row="0" Rows="1" Columns="4" Margin="14,12,14,8">
                            <Button x:Name="btnPhase0" Tag="0" Click="PhaseTab_Click" Cursor="Hand"
                                    Background="#FF1E3A5F" Margin="0,0,4,0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="#FF3B82F6" BorderThickness="1"
                                                CornerRadius="8" Padding="8,10">
                                            <StackPanel>
                                                <Path Fill="White" Width="20" Height="20" Stretch="Uniform" HorizontalAlignment="Center"
                                                      Data="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                                                <TextBlock Text="WstÄ™p" FontSize="10" Foreground="#FFAAAAAA"
                                                           HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button x:Name="btnPhase1" Tag="1" Click="PhaseTab_Click" Cursor="Hand"
                                    Background="#FF111111" Margin="0,0,4,0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="#FF1A1A24" BorderThickness="1"
                                                CornerRadius="8" Padding="8,10">
                                            <StackPanel>
                                                <Path Fill="White" Width="20" Height="20" Stretch="Uniform" HorizontalAlignment="Center"
                                                      Data="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                                                <TextBlock Text="Potrzeby" FontSize="10" Foreground="#FF666666"
                                                           HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button x:Name="btnPhase2" Tag="2" Click="PhaseTab_Click" Cursor="Hand"
                                    Background="#FF111111" Margin="0,0,4,0">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="#FF1A1A24" BorderThickness="1"
                                                CornerRadius="8" Padding="8,10">
                                            <StackPanel>
                                                <Path Fill="White" Width="20" Height="20" Stretch="Uniform" HorizontalAlignment="Center"
                                                      Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                                <TextBlock Text="Oferta" FontSize="10" Foreground="#FF666666"
                                                           HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                            <Button x:Name="btnPhase3" Tag="3" Click="PhaseTab_Click" Cursor="Hand"
                                    Background="#FF111111">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}"
                                                BorderBrush="#FF1A1A24" BorderThickness="1"
                                                CornerRadius="8" Padding="8,10">
                                            <StackPanel>
                                                <Path Fill="White" Width="20" Height="20" Stretch="Uniform" HorizontalAlignment="Center"
                                                      Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                                                <TextBlock Text="Zamknij" FontSize="10" Foreground="#FF666666"
                                                           HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </UniformGrid>

                        <!-- ROW 1: Active Phase Content + Objections (scrollable) -->
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                                      Padding="14,0,14,0">
                            <StackPanel>
                                <!-- Phase Card -->
                                <Border Background="#FF111111" CornerRadius="12" Padding="18" Margin="0,0,0,10">
                                    <StackPanel>
                                        <!-- Phase Header -->
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,14">
                                            <Border Background="#FF1E3A5F" CornerRadius="10" Width="44" Height="44">
                                                <Path x:Name="pathPhaseIcon" Fill="White" Width="22" Height="22" Stretch="Uniform"
                                                      HorizontalAlignment="Center" VerticalAlignment="Center"
                                                      Data="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/>
                                            </Border>
                                            <StackPanel Margin="12,0,0,0" VerticalAlignment="Center">
                                                <TextBlock x:Name="txtPhaseName" Text="WstÄ™p"
                                                           Foreground="White" FontWeight="SemiBold" FontSize="18"/>
                                                <TextBlock x:Name="txtPhaseNumber" Text="Faza 1 z 4"
                                                           Foreground="#FF666666" FontSize="11"/>
                                            </StackPanel>
                                        </StackPanel>

                                        <!-- Script -->
                                        <Border Background="#FF0A0A0F" CornerRadius="10" Padding="16"
                                                BorderBrush="#FF3B82F6" BorderThickness="3,0,0,0" Margin="0,0,0,10">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                    <Path Fill="#FF3B82F6" Width="12" Height="12" Stretch="Uniform" Margin="0,0,6,0"
                                                          Data="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"/>
                                                    <TextBlock Text="POWIEDZ" Foreground="#FF3B82F6"
                                                               FontSize="10" FontWeight="Bold"/>
                                                </StackPanel>
                                                <TextBlock x:Name="txtScript" TextWrapping="Wrap"
                                                           Foreground="#FFDDDDDD" FontSize="13" LineHeight="22"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- Shuffle script button -->
                                        <Button Click="BtnShuffleScript_Click" Cursor="Hand" Margin="0,0,0,10">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="#0CFFFFFF" CornerRadius="6" Padding="10,6">
                                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                            <Path Fill="#FF888888" Width="14" Height="14" Stretch="Uniform" Margin="0,0,6,0"
                                                                  Data="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/>
                                                            <TextBlock Text="Losuj inny skrypt" Foreground="#FF888888" FontSize="11"/>
                                                        </StackPanel>
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>

                                        <!-- Tip -->
                                        <Border Background="#1A22C55E" CornerRadius="8" Padding="12,10">
                                            <StackPanel Orientation="Horizontal">
                                                <Path Fill="#FF22C55E" Width="14" Height="14" Stretch="Uniform" Margin="0,1,8,0" VerticalAlignment="Top"
                                                      Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                                                <TextBlock x:Name="txtFlowTip" Foreground="#FF86EFAC" FontSize="12"
                                                           TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </Border>

                                <!-- Objections Section -->
                                <Border Background="#19DC2626" CornerRadius="10" Padding="14" Margin="0,0,0,10">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                            <Path Fill="#FFF87171" Width="14" Height="14" Stretch="Uniform" Margin="0,0,8,0"
                                                  Data="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                                            <TextBlock Text="OBIEKCJE I RIPOSTY" Foreground="#FFF87171"
                                                       FontSize="11" FontWeight="Bold"/>
                                        </StackPanel>
                                        <StackPanel x:Name="objectionsList">
                                            <!-- Filled dynamically -->
                                        </StackPanel>
                                        <Button Click="BtnShuffleObjections_Click" Cursor="Hand" Margin="0,8,0,0">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="#14F87171" CornerRadius="6" Padding="10,6">
                                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                            <Path Fill="#FFF87171" Width="12" Height="12" Stretch="Uniform" Margin="0,0,6,0"
                                                                  Data="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/>
                                                            <TextBlock Text="PokaÅ¼ inne obiekcje" Foreground="#FFF87171" FontSize="11"/>
                                                        </StackPanel>
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- ROW 2: Navigation -->
                        <Grid Grid.Row="2" Margin="14,8,14,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Button x:Name="btnPrevPhase" Grid.Column="0"
                                    IsEnabled="False" Click="PrevPhase_Click" Cursor="Hand">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="#FF111111" CornerRadius="8" Padding="12,10">
                                            <TextBlock Text="â† Wstecz"
                                                       HorizontalAlignment="Center"
                                                       Foreground="#FF555555" FontSize="13"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>

                            <Button x:Name="btnNextPhase" Grid.Column="2"
                                    Click="NextPhase_Click" Cursor="Hand">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="#FF3B82F6" CornerRadius="8" Padding="12,10">
                                            <TextBlock Text="Dalej â†’"
                                                       HorizontalAlignment="Center"
                                                       Foreground="White" FontSize="13" FontWeight="SemiBold"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>

                        <!-- ROW 3: Stats -->
                        <Border Grid.Row="3" Background="#FF111111"
                                BorderBrush="#FF1A1A24" BorderThickness="0,1,0,0"
                                Padding="12,12">
                            <UniformGrid Columns="3">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock x:Name="txtStatToday" Text="0"
                                               Foreground="#FF22C55E" FontSize="20" FontWeight="Bold"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="dziÅ›" Foreground="#FF555555" FontSize="10"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock x:Name="txtStatStreak" Text="0"
                                               Foreground="#FFF59E0B" FontSize="20" FontWeight="Bold"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="streak" Foreground="#FF555555" FontSize="10"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock x:Name="txtStatRate" Text="0%"
                                               Foreground="#FF3B82F6" FontSize="20" FontWeight="Bold"
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="skutecznoÅ›Ä‡" Foreground="#FF555555" FontSize="10"
                                               HorizontalAlignment="Center"/>
                                </StackPanel>
                            </UniformGrid>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
