<Window x:Class="Kalendarz1.WPF.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Dashboard - Podsumowanie produktÃ³w"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#F0F2F5"
        FontFamily="Segoe UI">

    <Window.Resources>
        <!-- Styl karty produktu -->
        <Style x:Key="ProductCardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="2" Opacity="0.1" BlurRadius="15"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Styl przycisku -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#3498DB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}"
                                CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.85"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Opacity" Value="0.7"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Styl elementu listy produktÃ³w -->
        <Style x:Key="ProductListItemStyle" TargetType="ListBoxItem">
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border x:Name="Bd" Background="{TemplateBinding Background}"
                                CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#EBF5FB"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#D4EFDF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <!-- GÅÃ“WNA ZAWARTOÅšÄ† -->
        <Grid Grid.Column="0" Margin="12,8">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- NAGÅÃ“WEK - kompaktowy -->
            <Border Grid.Row="0" CornerRadius="8" Margin="0,0,0,8">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#2c3e50" Offset="0"/>
                        <GradientStop Color="#27ae60" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid Margin="20,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="DASHBOARD PRODUKTÃ“W" FontSize="20" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                        <TextBlock x:Name="txtSelectedDate" Text="Data: -" FontSize="12" Foreground="#A3E4D7" Margin="20,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- KPI w nagÅ‚Ã³wku -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Background="#27AE60" CornerRadius="6" Padding="12,6" Margin="5,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="DO SPRZEDANIA:" FontSize="11" Foreground="White" VerticalAlignment="Center"/>
                                <TextBlock x:Name="txtDoSprzedania" Text="0 kg" FontSize="16" Foreground="White" FontWeight="Bold" Margin="6,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <Border Background="#3498DB" CornerRadius="6" Padding="12,6" Margin="5,0">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ZAMÃ“WIONE:" FontSize="11" Foreground="White" VerticalAlignment="Center"/>
                                <TextBlock x:Name="txtZamowione" Text="0 kg" FontSize="16" Foreground="White" FontWeight="Bold" Margin="6,0,0,0" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- PASEK FILTRÃ“W - kompaktowy -->
            <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="15,8" Margin="0,0,0,8">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="1" Opacity="0.08" BlurRadius="8"/>
                </Border.Effect>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,30,0">
                        <TextBlock Text="Data:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold" FontSize="13"/>
                        <DatePicker x:Name="dpData" Width="140" FontSize="13" SelectedDateChanged="DpData_SelectedDateChanged"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,30,0">
                        <TextBlock Text="Bilans wg:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold" FontSize="13"/>
                        <RadioButton x:Name="rbBilansZamowienia" Content="ZamÃ³wienia" IsChecked="True"
                                     VerticalAlignment="Center" Margin="0,0,15,0" FontSize="13"
                                     Checked="RbBilans_Checked"/>
                        <RadioButton x:Name="rbBilansWydania" Content="Wydania"
                                     VerticalAlignment="Center" FontSize="13"
                                     Checked="RbBilans_Checked"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <TextBlock Text="Widok:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold" FontSize="13"/>
                        <ComboBox x:Name="cmbWidok" Width="180" FontSize="13" Height="30"
                                  SelectionChanged="CmbWidok_SelectionChanged"/>
                        <Button Content="Zapisz" Style="{StaticResource ModernButtonStyle}"
                                Background="#27AE60" Margin="10,0,0,0" Padding="12,6"
                                Click="BtnSaveView_Click"/>
                        <Button Content="UsuÅ„" Style="{StaticResource ModernButtonStyle}"
                                Background="#E74C3C" Margin="5,0,0,0" Padding="12,6"
                                Click="BtnDeleteView_Click"/>

                        <!-- PrzeÅ‚Ä…cznik Karty/Tabela -->
                        <Border Background="#ECF0F1" CornerRadius="6" Margin="20,0,0,0" Padding="3">
                            <StackPanel Orientation="Horizontal">
                                <RadioButton x:Name="rbViewCards" Content="Karty" IsChecked="True"
                                             GroupName="ViewMode" Padding="12,6" Margin="2,0"
                                             Checked="RbViewMode_Checked"/>
                                <RadioButton x:Name="rbViewTable" Content="Tabela"
                                             GroupName="ViewMode" Padding="12,6" Margin="2,0"
                                             Checked="RbViewMode_Checked"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <StackPanel Grid.Column="4" Orientation="Horizontal">
                        <Button x:Name="btnRefresh" Content="âŸ³ OdÅ›wieÅ¼" Style="{StaticResource ModernButtonStyle}"
                                Background="#3498DB" Margin="0,0,10,0"
                                Click="BtnRefresh_Click"/>
                        <Button x:Name="btnExport" Content="ðŸ“Š Excel" Style="{StaticResource ModernButtonStyle}"
                                Background="#27AE60" Margin="0,0,10,0"
                                Click="BtnExport_Click"/>
                        <Button x:Name="btnScreenshot" Content="ðŸ“·" Style="{StaticResource ModernButtonStyle}"
                                Background="#9B59B6" Margin="0,0,10,0" Padding="10,6"
                                ToolTip="ZrÃ³b screenshot do udostÄ™pnienia"
                                Click="BtnScreenshot_Click"/>
                        <Button x:Name="btnTogglePanel" Content="Wybierz produkty â–¶" Style="{StaticResource ModernButtonStyle}"
                                Background="#8E44AD" Margin="0,0,10,0"
                                Click="BtnTogglePanel_Click"/>
                        <Button Content="Zamknij" Style="{StaticResource ModernButtonStyle}"
                                Background="#7F8C8D"
                                Click="BtnClose_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- DYNAMICZNE KARTY PRODUKTÃ“W -->
            <ScrollViewer Grid.Row="2" x:Name="svCards" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <ItemsControl x:Name="icProducts">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </ScrollViewer>

            <!-- WIDOK TABELI -->
            <DataGrid Grid.Row="2" x:Name="dgProducts" Visibility="Collapsed"
                      AutoGenerateColumns="False" IsReadOnly="True"
                      Background="White" RowBackground="White" AlternatingRowBackground="#F8F9FA"
                      GridLinesVisibility="Horizontal" HorizontalGridLinesBrush="#E0E0E0"
                      BorderThickness="1" BorderBrush="#DDD" CanUserAddRows="False"
                      FontSize="13" RowHeight="36" HeadersVisibility="Column"
                      SelectionMode="Single" SelectionUnit="FullRow"
                      MouseDoubleClick="DgProducts_MouseDoubleClick">
                <DataGrid.ColumnHeaderStyle>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#2C3E50"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="Padding" Value="12,10"/>
                        <Setter Property="BorderThickness" Value="0,0,1,0"/>
                        <Setter Property="BorderBrush" Value="#34495E"/>
                    </Style>
                </DataGrid.ColumnHeaderStyle>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Kod" Binding="{Binding Kod}" Width="120"/>
                    <DataGridTextColumn Header="Nazwa" Binding="{Binding Nazwa}" Width="*"/>
                    <DataGridTextColumn Header="Plan" Binding="{Binding Plan, StringFormat=N0}" Width="90">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Padding" Value="0,0,10,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Fakt" Binding="{Binding Fakt, StringFormat=N0}" Width="90">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Padding" Value="0,0,10,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Stan" Binding="{Binding Stan, StringFormat=N0}" Width="90">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Padding" Value="0,0,10,0"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="ZamÃ³wienia" Binding="{Binding Zamowienia, StringFormat=N0}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Padding" Value="0,0,10,0"/>
                                <Setter Property="Foreground" Value="#2980B9"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Bilans" Binding="{Binding Bilans, StringFormat=N0}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Right"/>
                                <Setter Property="Padding" Value="0,0,10,0"/>
                                <Setter Property="FontWeight" Value="Bold"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Odbiorcy" Binding="{Binding OdbiorcyCount}" Width="80">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Placeholder gdy brak produktÃ³w -->
            <Border Grid.Row="2" x:Name="placeholderPanel" Background="White" CornerRadius="12"
                    HorizontalAlignment="Center" VerticalAlignment="Center" Padding="60,40">
                <Border.Effect>
                    <DropShadowEffect ShadowDepth="2" Opacity="0.1" BlurRadius="15"/>
                </Border.Effect>
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="ðŸ“Š" FontSize="60" HorizontalAlignment="Center" Margin="0,0,0,20"/>
                    <TextBlock Text="Brak wybranych produktÃ³w" FontSize="20" FontWeight="SemiBold"
                               Foreground="#2C3E50" HorizontalAlignment="Center"/>
                    <TextBlock Text="Kliknij 'Wybierz produkty' aby dodaÄ‡ produkty do dashboardu"
                               FontSize="14" Foreground="#7F8C8D" HorizontalAlignment="Center" Margin="0,10,0,20"/>
                    <Button Content="Wybierz produkty" Style="{StaticResource ModernButtonStyle}"
                            Background="#9B59B6" HorizontalAlignment="Center"
                            Click="BtnTogglePanel_Click"/>
                </StackPanel>
            </Border>

            <!-- Loading overlay -->
            <Border Grid.Row="2" x:Name="loadingOverlay" Background="#80FFFFFF" Visibility="Collapsed">
                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Border Background="White" CornerRadius="12" Padding="40,30">
                        <Border.Effect>
                            <DropShadowEffect ShadowDepth="3" Opacity="0.2" BlurRadius="20"/>
                        </Border.Effect>
                        <StackPanel HorizontalAlignment="Center">
                            <TextBlock x:Name="txtLoadingIcon" Text="âŸ³" FontSize="40"
                                       HorizontalAlignment="Center" Foreground="#3498DB">
                                <TextBlock.RenderTransform>
                                    <RotateTransform x:Name="loadingRotate" CenterX="12" CenterY="12"/>
                                </TextBlock.RenderTransform>
                            </TextBlock>
                            <TextBlock Text="Åadowanie danych..." FontSize="16" FontWeight="SemiBold"
                                       Foreground="#2C3E50" HorizontalAlignment="Center" Margin="0,15,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
        </Grid>

        <!-- PANEL BOCZNY - WYBÃ“R PRODUKTÃ“W -->
        <Border Grid.Column="1" x:Name="sidePanel" Width="350" Background="White" Visibility="Collapsed">
            <Border.Effect>
                <DropShadowEffect ShadowDepth="-3" Opacity="0.15" BlurRadius="10" Direction="180"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- NagÅ‚Ã³wek panelu -->
                <Border Grid.Row="0" Padding="20,15">
                    <Border.Background>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                            <GradientStop Color="#9B59B6" Offset="0"/>
                            <GradientStop Color="#8E44AD" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                    <Grid>
                        <TextBlock Text="WYBÃ“R PRODUKTÃ“W" FontSize="16" FontWeight="Bold" Foreground="White"/>
                        <Button Content="âœ•" HorizontalAlignment="Right" Background="Transparent"
                                Foreground="White" BorderThickness="0" FontSize="16" Cursor="Hand"
                                Click="BtnClosePanel_Click"/>
                    </Grid>
                </Border>

                <!-- Filtr wyszukiwania -->
                <Border Grid.Row="1" Padding="15,10">
                    <StackPanel>
                        <TextBox x:Name="txtSearchProduct" Height="35" FontSize="13"
                                 VerticalContentAlignment="Center" Padding="10,0"
                                 TextChanged="TxtSearchProduct_TextChanged"/>
                        <TextBlock Text="Wpisz nazwÄ™ produktu aby wyszukaÄ‡..." FontSize="11"
                                   Foreground="#95A5A6" Margin="5,5,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Lista produktÃ³w -->
                <ListBox Grid.Row="2" x:Name="lstProducts"
                         SelectionMode="Multiple"
                         ItemContainerStyle="{StaticResource ProductListItemStyle}"
                         BorderThickness="0" Margin="10,0"
                         ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <CheckBox Grid.Column="0" IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                          VerticalAlignment="Center" Margin="0,0,10,0"
                                          Checked="ProductCheckBox_Changed" Unchecked="ProductCheckBox_Changed"/>
                                <StackPanel Grid.Column="1">
                                    <TextBlock Text="{Binding Kod}" FontWeight="SemiBold" FontSize="13"/>
                                    <TextBlock Text="{Binding Nazwa}" FontSize="11" Foreground="#7F8C8D" TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <!-- Wybrane produkty -->
                <Border Grid.Row="3" Background="#F8F9FA" Padding="15,10">
                    <StackPanel>
                        <TextBlock FontSize="12" FontWeight="SemiBold" Foreground="#2C3E50">
                            <Run Text="Wybrano: "/>
                            <Run x:Name="txtSelectedCount" Text="0" Foreground="#27AE60"/>
                            <Run Text=" produktÃ³w"/>
                        </TextBlock>
                    </StackPanel>
                </Border>

                <!-- Przyciski akcji -->
                <Border Grid.Row="4" Padding="15">
                    <StackPanel>
                        <Button Content="Zastosuj wybÃ³r" Style="{StaticResource ModernButtonStyle}"
                                Background="#27AE60" HorizontalAlignment="Stretch"
                                Click="BtnApplySelection_Click"/>
                        <Button Content="WyczyÅ›Ä‡ wybÃ³r" Style="{StaticResource ModernButtonStyle}"
                                Background="#E74C3C" HorizontalAlignment="Stretch" Margin="0,8,0,0"
                                Click="BtnClearSelection_Click"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
    </Grid>
</Window>
