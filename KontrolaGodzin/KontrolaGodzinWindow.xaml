<Window x:Class="Kalendarz1.KontrolaGodzin.KontrolaGodzinWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Kontrola Czasu Pracy - UNICARD" 
        Height="900" Width="1500"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#F5F7FA"
        FontFamily="Segoe UI"
        Loaded="Window_Loaded">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- NAGLOWEK -->
        <Border Grid.Row="0" Background="#263238" CornerRadius="8" Padding="20,15" Margin="0,0,0,12">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="⏱️" FontSize="32" VerticalAlignment="Center" Margin="0,0,15,0"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="KONTROLA CZASU PRACY" FontSize="22" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="System UNICARD - rejestracja wejsc/wyjsc pracownikow" 
                                   FontSize="12" Foreground="#B0BEC5" Margin="0,3,0,0"/>
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <TextBlock x:Name="txtAktualnaData" Text="" FontSize="12" Foreground="#B0BEC5" VerticalAlignment="Center" Margin="0,0,20,0"/>
                    <TextBlock x:Name="txtAktualnaGodzina" Text="" FontSize="18" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- FILTRY -->
        <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,12">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Od:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <DatePicker x:Name="dpOd" Width="120" VerticalAlignment="Center"/>

                    <TextBlock Text="Do:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="20,0,8,0"/>
                    <DatePicker x:Name="dpDo" Width="120" VerticalAlignment="Center"/>

                    <CheckBox x:Name="chkTylkoDzisiaj" Content="Tylko dzis" IsChecked="True" 
                              VerticalAlignment="Center" Margin="20,0,0,0" FontWeight="SemiBold"
                              Checked="ChkTylkoDzisiaj_Changed" Unchecked="ChkTylkoDzisiaj_Changed"/>

                    <TextBlock Text="Grupa:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="30,0,8,0"/>
                    <ComboBox x:Name="cmbGrupa" Width="220" VerticalAlignment="Center"
                              SelectionChanged="CmbGrupa_SelectionChanged"/>

                    <TextBlock Text="Szukaj:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="20,0,8,0"/>
                    <TextBox x:Name="txtSzukaj" Width="180" VerticalAlignment="Center" Padding="8,6"
                             TextChanged="TxtSzukaj_TextChanged"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="btnOdswiez" Content="Odswiez" Padding="15,8" Margin="0,0,10,0"
                            Background="#2196F3" Foreground="White" FontWeight="SemiBold"
                            BorderThickness="0" Click="BtnOdswiez_Click"/>
                    <Button x:Name="btnExport" Content="Export CSV" Padding="15,8"
                            Background="#4CAF50" Foreground="White" FontWeight="SemiBold"
                            BorderThickness="0" Click="BtnExport_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- STATYSTYKI -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,12">
            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Rejestracji" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatRejestracje" Text="0" FontSize="24" FontWeight="Bold" Foreground="#2196F3"/>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Obecnych" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatObecni" Text="0" FontSize="24" FontWeight="Bold" Foreground="#4CAF50"/>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Suma godzin" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatGodziny" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#FF9800"/>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Pracownikow" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatPracownicy" Text="0" FontSize="24" FontWeight="Bold" Foreground="#9C27B0"/>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Alertow" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatAlerty" Text="0" FontSize="24" FontWeight="Bold" Foreground="#F44336"/>
                </StackPanel>
            </Border>

            <Border x:Name="panelLadowanie" Background="White" CornerRadius="8" Padding="15" Width="160" Visibility="Collapsed">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="Ladowanie..." FontSize="11" Foreground="#78909C" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- ZAKLADKI -->
        <Border Grid.Row="3" Background="White" CornerRadius="8" Padding="5">
            <TabControl x:Name="tabControl" BorderThickness="0">
                
                <TabItem Header="Rejestracje">
                    <DataGrid x:Name="gridRejestracje" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Godzina" Binding="{Binding Godzina}" Width="90"/>
                            <DataGridTextColumn Header="Typ" Binding="{Binding Typ}" Width="60"/>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="200"/>
                            <DataGridTextColumn Header="Dzial / Agencja" Binding="{Binding Grupa}" Width="180"/>
                            <DataGridTextColumn Header="Punkt dostepu" Binding="{Binding PunktDostepu}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Godziny Pracy">
                    <DataGrid x:Name="gridGodzinyPracy" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="200"/>
                            <DataGridTextColumn Header="Dzial / Agencja" Binding="{Binding Grupa}" Width="160"/>
                            <DataGridTextColumn Header="Data" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="100"/>
                            <DataGridTextColumn Header="Wejscie" Binding="{Binding PierwszeWejscie}" Width="80"/>
                            <DataGridTextColumn Header="Wyjscie" Binding="{Binding OstatnieWyjscie}" Width="80"/>
                            <DataGridTextColumn Header="Czas pracy" Binding="{Binding CzasPracy}" Width="100"/>
                            <DataGridTextColumn Header="Wejsc" Binding="{Binding LiczbaWejsc}" Width="60"/>
                            <DataGridTextColumn Header="Wyjsc" Binding="{Binding LiczbaWyjsc}" Width="60"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Obecnie na Terenie">
                    <DataGrid x:Name="gridObecni" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="200"/>
                            <DataGridTextColumn Header="Dzial / Agencja" Binding="{Binding Grupa}" Width="180"/>
                            <DataGridTextColumn Header="Wejscie" Binding="{Binding Godzina}" Width="100"/>
                            <DataGridTextColumn Header="Na terenie" Binding="{Binding CzasNaTerenie}" Width="120"/>
                            <DataGridTextColumn Header="Punkt dostepu" Binding="{Binding PunktDostepu}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Podsumowanie Agencji">
                    <DataGrid x:Name="gridPodsumowanie" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Dzial / Agencja" Binding="{Binding Grupa}" Width="200"/>
                            <DataGridTextColumn Header="Pracownicy" Binding="{Binding LiczbaPracownikow}" Width="100"/>
                            <DataGridTextColumn Header="Suma godzin" Binding="{Binding SumaGodzin, StringFormat=N1}" Width="120"/>
                            <DataGridTextColumn Header="Srednia/os." Binding="{Binding SredniaGodzin, StringFormat=N1}" Width="100"/>
                            <DataGridTextColumn Header="Teraz obecni" Binding="{Binding Obecni}" Width="110"/>
                            <DataGridTextColumn Header="Braki wyjsc" Binding="{Binding BrakiWyjsc}" Width="100"/>
                            <DataGridTextColumn Header="Przekroczenia" Binding="{Binding Przekroczenia}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Alerty">
                    <DataGrid x:Name="gridAlerty" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Typ alertu" Binding="{Binding Typ}" Width="160"/>
                            <DataGridTextColumn Header="Priorytet" Binding="{Binding Priorytet}" Width="90"/>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="180"/>
                            <DataGridTextColumn Header="Dzial / Agencja" Binding="{Binding Grupa}" Width="160"/>
                            <DataGridTextColumn Header="Data" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="100"/>
                            <DataGridTextColumn Header="Opis problemu" Binding="{Binding Opis}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>
                
            </TabControl>
        </Border>
    </Grid>
</Window>
