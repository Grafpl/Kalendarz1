<Window x:Class="Kalendarz1.KontrolaGodzin.KontrolaGodzinWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Kontrola Czasu Pracy - UNICARD" 
        Height="900" Width="1600"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#F5F7FA"
        FontFamily="Segoe UI"
        Loaded="Window_Loaded">

    <Window.Resources>
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#E8EDF3"/>
            <Setter Property="Foreground" Value="#2D3748"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#CBD5E0"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#3182CE"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#2B6CB0"/>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#38A169"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#2F855A"/>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="#E53E3E"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#C53030"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#2D3748"/>
            <Setter Property="BorderBrush" Value="#CBD5E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#2D3748"/>
            <Setter Property="BorderBrush" Value="#CBD5E0"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style TargetType="DatePicker">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#2D3748"/>
            <Setter Property="BorderBrush" Value="#CBD5E0"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="#2D3748"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Foreground" Value="#4A5568"/>
            <Setter Property="Padding" Value="14,8"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" Background="Transparent" 
                                BorderThickness="0,0,0,3" BorderBrush="Transparent"
                                Padding="{TemplateBinding Padding}" Margin="1,0">
                            <ContentPresenter ContentSource="Header" HorizontalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Foreground" Value="#3182CE"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#3182CE"/>
                                <Setter TargetName="Border" Property="Background" Value="#EBF8FF"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#EDF2F7"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#2D3748"/>
            <Setter Property="BorderBrush" Value="#E2E8F0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="RowBackground" Value="White"/>
            <Setter Property="AlternatingRowBackground" Value="#F7FAFC"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#E2E8F0"/>
            <Setter Property="RowHeaderWidth" Value="0"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="RowHeight" Value="28"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#EDF2F7"/>
            <Setter Property="Foreground" Value="#1A202C"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="BorderBrush" Value="#E2E8F0"/>
            <Setter Property="BorderThickness" Value="0,0,1,2"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="Padding" Value="10,4"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#BEE3F8"/>
                    <Setter Property="Foreground" Value="#1A202C"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridRow">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#EBF8FF"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Styl kafelka Dashboard -->
        <Style x:Key="DashboardTile" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="BorderBrush" Value="#E2E8F0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1" Direction="270"/>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- NAGÅÃ“WEK -->
        <Border Grid.Row="0" Background="White" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1">
            <Grid Margin="20,12">
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="#3182CE" CornerRadius="10" Padding="10" Margin="0,0,12,0">
                        <TextBlock Text="â±" FontSize="22" Foreground="White"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="KONTROLA CZASU PRACY" FontSize="20" FontWeight="Bold" Foreground="#1A202C"/>
                        <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                            <TextBlock Text="UNICARD" FontSize="11" Foreground="#3182CE" FontWeight="SemiBold"/>
                            <TextBlock Text=" â€¢ " FontSize="11" Foreground="#A0AEC0"/>
                            <TextBlock x:Name="txtZakresDat" Text="Zakres: dziÅ›" FontSize="11" Foreground="#38A169" FontWeight="SemiBold"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <!-- Nowe przyciski -->
                    <Button Content="ðŸ“Š Timeline" Style="{StaticResource ModernButton}" Margin="0,0,8,0" Click="BtnTimeline_Click"/>
                    <Button Content="ðŸ“ˆ Statystyki" Style="{StaticResource ModernButton}" Margin="0,0,8,0" Click="BtnStatystyki_Click"/>
                    <Button Content="ðŸ’³ Karty" Style="{StaticResource ModernButton}" Margin="0,0,8,0" Click="BtnZarzadzanieKartami_Click"/>
                    <Button Content="ðŸ–¨ï¸ Karta RCP" Style="{StaticResource ModernButton}" Margin="0,0,8,0" Click="BtnKartaRCP_Click"/>
                    <Button Content="âš™ï¸ Stawki" Style="{StaticResource ModernButton}" Margin="0,0,20,0" Click="BtnUstawieniaStawek_Click"/>
                    
                    <StackPanel HorizontalAlignment="Right" Margin="0,0,20,0">
                        <TextBlock x:Name="txtAktualnaData" Text="" FontSize="11" Foreground="#718096" HorizontalAlignment="Right"/>
                        <TextBlock x:Name="txtAktualnaGodzina" Text="" FontSize="28" FontWeight="Light" Foreground="#1A202C"/>
                    </StackPanel>
                    <Border Background="#38A169" CornerRadius="20" Padding="16,8">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="8" Height="8" Fill="White" Margin="0,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock x:Name="txtLiczbaObecnych" Text="0 obecnych" FontSize="13" Foreground="White" FontWeight="Bold"/>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>

        <!-- FILTRY -->
        <Border Grid.Row="1" Background="#FAFBFC" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1" Padding="20,12">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <StackPanel Orientation="Horizontal" Margin="0,0,15,0">
                        <TextBlock Text="Od:" FontSize="11" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <DatePicker x:Name="dpOd" Width="120" SelectedDateChanged="DpOd_SelectedDateChanged"/>
                        <TextBlock Text="Do:" FontSize="11" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="12,0,6,0"/>
                        <DatePicker x:Name="dpDo" Width="120" SelectedDateChanged="DpDo_SelectedDateChanged"/>
                    </StackPanel>

                    <Border Background="#E2E8F0" Width="1" Margin="8,0"/>
                    <StackPanel Orientation="Horizontal" Margin="15,0">
                        <CheckBox x:Name="chkTylkoDzisiaj" Content="DziÅ›" IsChecked="True" VerticalAlignment="Center" Margin="0,0,10,0"
                                  Checked="ChkTylkoDzisiaj_Changed" Unchecked="ChkTylkoDzisiaj_Changed"/>
                        <Button Content="Wczoraj" Style="{StaticResource ModernButton}" Margin="0,0,5,0" Click="BtnWczoraj_Click"/>
                        <Button Content="TydzieÅ„" Style="{StaticResource ModernButton}" Margin="0,0,5,0" Click="BtnTydzien_Click"/>
                        <Button Content="MiesiÄ…c" Style="{StaticResource ModernButton}" Click="BtnMiesiac_Click"/>
                    </StackPanel>

                    <Border Background="#E2E8F0" Width="1" Margin="8,0"/>
                    <StackPanel Orientation="Horizontal" Margin="15,0">
                        <TextBlock Text="DziaÅ‚:" FontSize="11" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <ComboBox x:Name="cmbGrupa" Width="180" SelectionChanged="CmbGrupa_SelectionChanged"/>
                    </StackPanel>

                    <Border Background="#E2E8F0" Width="1" Margin="8,0"/>
                    <StackPanel Orientation="Horizontal" Margin="15,0">
                        <TextBlock Text="ðŸ”" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBox x:Name="txtSzukaj" Width="160" TextChanged="TxtSzukaj_TextChanged"/>
                        <Button Content="âœ•" Style="{StaticResource ModernButton}" Padding="8,6" Margin="5,0,0,0" Click="BtnWyczyscSzukaj_Click"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <CheckBox x:Name="chkAutoRefresh" Content="Auto 30s" VerticalAlignment="Center" Margin="0,0,15,0" 
                              Checked="ChkAutoRefresh_Changed" Unchecked="ChkAutoRefresh_Changed"/>
                    <Button x:Name="btnOdswiez" Content="âŸ³ OdÅ›wieÅ¼" Style="{StaticResource PrimaryButton}" Margin="0,0,8,0" Click="BtnOdswiez_Click"/>
                    <Button x:Name="btnExport" Content="ðŸ“¥ Export" Style="{StaticResource SuccessButton}" Click="BtnExport_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ZAWARTOÅšÄ† -->
        <TabControl x:Name="tabControl" Grid.Row="2" Margin="15,10,15,5" Background="Transparent" BorderThickness="0">
            
            <!-- ==================== DASHBOARD ==================== -->
            <TabItem Header="ðŸ  Dashboard">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- GÅ‚Ã³wne statystyki -->
                        <UniformGrid Grid.Row="0" Columns="5" Margin="0,5,0,10">
                            <Border Style="{StaticResource DashboardTile}">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ‘¥ OBECNI TERAZ" FontSize="10" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashObecni" Text="0" FontSize="48" FontWeight="Bold" Foreground="#38A169" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashObecniZmiana" Text="â–² +5 vs wczoraj" FontSize="10" Foreground="#38A169" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸšª WEJÅšCIA DZIÅš" FontSize="10" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashWejscia" Text="0" FontSize="48" FontWeight="Bold" Foreground="#3182CE" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashWejsciaGodzina" Text="Ostatnie: --:--" FontSize="10" Foreground="#718096" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸš¶ WYJÅšCIA DZIÅš" FontSize="10" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashWyjscia" Text="0" FontSize="48" FontWeight="Bold" Foreground="#E53E3E" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashWyjsciaGodzina" Text="Ostatnie: --:--" FontSize="10" Foreground="#718096" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="â° SUMA GODZIN" FontSize="10" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashGodziny" Text="0h" FontSize="48" FontWeight="Bold" Foreground="#805AD5" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashGodzinySrednia" Text="Åšr./osobÄ™: 0h" FontSize="10" Foreground="#718096" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="âš ï¸ ALERTY" FontSize="10" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashAlerty" Text="0" FontSize="48" FontWeight="Bold" Foreground="#DD6B20" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashAlertyTyp" Text="Brak problemÃ³w" FontSize="10" Foreground="#38A169" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </UniformGrid>

                        <!-- ObecnoÅ›Ä‡ wg lokalizacji -->
                        <TextBlock Grid.Row="1" Text="ðŸ“ OBECNOÅšÄ† WG LOKALIZACJI" FontSize="12" FontWeight="Bold" Foreground="#2D3748" Margin="10,10,0,5"/>
                        <UniformGrid Grid.Row="2" Columns="6" Margin="0,0,0,10">
                            <Border Style="{StaticResource DashboardTile}" Background="#F0FFF4" BorderBrush="#C6F6D5">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ­ PRODUKCJA" FontSize="10" Foreground="#276749" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashProdukcja" Text="0" FontSize="36" FontWeight="Bold" Foreground="#276749" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}" Background="#EBF8FF" BorderBrush="#BEE3F8">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ§¹ CZYSTA" FontSize="10" Foreground="#2B6CB0" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashCzysta" Text="0" FontSize="36" FontWeight="Bold" Foreground="#2B6CB0" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}" Background="#FFFAF0" BorderBrush="#FEEBC8">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ§¼ BRUDNA" FontSize="10" Foreground="#C05621" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashBrudna" Text="0" FontSize="36" FontWeight="Bold" Foreground="#C05621" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}" Background="#FAF5FF" BorderBrush="#E9D8FD">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸš¿ MYJKA" FontSize="10" Foreground="#6B46C1" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashMyjka" Text="0" FontSize="36" FontWeight="Bold" Foreground="#6B46C1" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}" Background="#FFF5F5" BorderBrush="#FED7D7">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ”§ MECHANICY" FontSize="10" Foreground="#C53030" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashMechanicy" Text="0" FontSize="36" FontWeight="Bold" Foreground="#C53030" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Style="{StaticResource DashboardTile}" Background="#E6FFFA" BorderBrush="#B2F5EA">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ¢ BIURO" FontSize="10" Foreground="#234E52" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtDashBiuro" Text="0" FontSize="36" FontWeight="Bold" Foreground="#234E52" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </UniformGrid>

                        <!-- Ostatnie rejestracje -->
                        <Grid Grid.Row="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" Style="{StaticResource DashboardTile}" Margin="5">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Text="ðŸšª OSTATNIE WEJÅšCIA" FontSize="11" FontWeight="Bold" Foreground="#276749" Margin="0,0,0,10"/>
                                    <DataGrid x:Name="gridDashWejscia" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True" MaxHeight="200">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="GODZINA" Binding="{Binding Godzina}" Width="70"/>
                                            <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="*"/>
                                            <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Border>
                            
                            <Border Grid.Column="1" Style="{StaticResource DashboardTile}" Margin="5">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <TextBlock Text="ðŸš¶ OSTATNIE WYJÅšCIA" FontSize="11" FontWeight="Bold" Foreground="#C53030" Margin="0,0,0,10"/>
                                    <DataGrid x:Name="gridDashWyjscia" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True" MaxHeight="200">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="GODZINA" Binding="{Binding Godzina}" Width="70"/>
                                            <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="*"/>
                                            <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="120"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- ==================== REJESTRACJE ==================== -->
            <TabItem Header="ðŸ“‹ Rejestracje">
                <Border Background="White" CornerRadius="8" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                    <DataGrid x:Name="gridRejestracje" Margin="1" AutoGenerateColumns="False" IsReadOnly="True"
                              MouseDoubleClick="GridRejestracje_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="DATA" Binding="{Binding DataCzas, StringFormat=dd.MM.yyyy}" Width="90"/>
                            <DataGridTextColumn Header="GODZINA" Binding="{Binding DataCzas, StringFormat=HH:mm:ss}" Width="80"/>
                            <DataGridTextColumn Header="TYP" Binding="{Binding Typ}" Width="80"/>
                            <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="200"/>
                            <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="180"/>
                            <DataGridTextColumn Header="PUNKT DOSTÄ˜PU" Binding="{Binding PunktDostepu}" Width="150"/>
                            <DataGridTextColumn Header="URZÄ„DZENIE" Binding="{Binding Urzadzenie}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </TabItem>

            <!-- ==================== GODZINY PRACY ==================== -->
            <TabItem Header="â° Godziny Pracy">
                <Border Background="White" CornerRadius="8" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                    <DataGrid x:Name="gridGodzinyPracy" Margin="1" AutoGenerateColumns="False" IsReadOnly="True"
                              MouseDoubleClick="GridGodzinyPracy_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="DATA" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="90"/>
                            <DataGridTextColumn Header="DZIEÅƒ" Binding="{Binding DzienTygodnia}" Width="60"/>
                            <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="200"/>
                            <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="150"/>
                            <DataGridTextColumn Header="WEJÅšCIE" Binding="{Binding PierwszeWejscie}" Width="70"/>
                            <DataGridTextColumn Header="WYJÅšCIE" Binding="{Binding OstatnieWyjscie}" Width="70"/>
                            <DataGridTextColumn Header="CZAS PRACY" Binding="{Binding CzasPracy}" Width="90"/>
                            <DataGridTextColumn Header="PRZERWY" Binding="{Binding Przerwy}" Width="70"/>
                            <DataGridTextColumn Header="EFEKTYWNY" Binding="{Binding CzasEfektywny}" Width="90"/>
                            <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </TabItem>

            <!-- ==================== AGENCJE ==================== -->
            <TabItem Header="ðŸ¢ Agencje">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Filtr agencji -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Agencja:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox x:Name="cmbAgencja" Width="250" SelectionChanged="CmbAgencja_SelectionChanged"/>
                            <TextBlock Text="MiesiÄ…c:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="25,0,10,0"/>
                            <ComboBox x:Name="cmbAgencjaMiesiac" Width="120"/>
                            <TextBlock Text="Rok:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="15,0,10,0"/>
                            <ComboBox x:Name="cmbAgencjaRok" Width="80"/>
                            <Button Content="ðŸ“Š Generuj raport" Style="{StaticResource PrimaryButton}" Margin="20,0,0,0" Click="BtnGenerujRaportAgencji_Click"/>
                            <Button Content="ðŸ“¥ Export Excel" Style="{StaticResource SuccessButton}" Margin="10,0,0,0" Click="BtnExportAgencja_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- Podsumowanie agencji -->
                    <Border Grid.Row="1" Background="#EBF8FF" CornerRadius="8" Padding="20" Margin="0,0,0,10" BorderBrush="#BEE3F8" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <StackPanel Margin="0,0,50,0" HorizontalAlignment="Center">
                                <TextBlock Text="PRACOWNIKÃ“W" FontSize="10" Foreground="#2B6CB0" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtAgencjaPracownikow" Text="0" FontSize="32" FontWeight="Bold" Foreground="#2C5282" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="0,0,50,0" HorizontalAlignment="Center">
                                <TextBlock Text="DNI ROBOCZYCH" FontSize="10" Foreground="#2B6CB0" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtAgencjaDni" Text="0" FontSize="32" FontWeight="Bold" Foreground="#2C5282" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="0,0,50,0" HorizontalAlignment="Center">
                                <TextBlock Text="SUMA GODZIN" FontSize="10" Foreground="#276749" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtAgencjaGodziny" Text="0h" FontSize="32" FontWeight="Bold" Foreground="#276749" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="0,0,50,0" HorizontalAlignment="Center">
                                <TextBlock Text="NADGODZINY" FontSize="10" Foreground="#C05621" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtAgencjaNadgodziny" Text="0h" FontSize="32" FontWeight="Bold" Foreground="#C05621" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="DO WYPÅATY" FontSize="10" Foreground="#6B46C1" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtAgencjaDoWyplaty" Text="0 zÅ‚" FontSize="32" FontWeight="Bold" Foreground="#6B46C1" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Tabela pracownikÃ³w agencji -->
                    <Border Grid.Row="2" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridAgencje" Margin="1" AutoGenerateColumns="False" IsReadOnly="True"
                                  MouseDoubleClick="GridAgencje_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="200"/>
                                <DataGridTextColumn Header="DNI PRACY" Binding="{Binding DniPracy}" Width="90"/>
                                <DataGridTextColumn Header="NORMALNE" Binding="{Binding GodzinyNormalne, StringFormat=N1}" Width="100"/>
                                <DataGridTextColumn Header="NADGODZINY" Binding="{Binding Nadgodziny, StringFormat=N1}" Width="100"/>
                                <DataGridTextColumn Header="NOCNE" Binding="{Binding GodzinyNocne, StringFormat=N1}" Width="80"/>
                                <DataGridTextColumn Header="SUMA" Binding="{Binding SumaGodzin, StringFormat=N1}" Width="80"/>
                                <DataGridTextColumn Header="ÅšR./DZIEÅƒ" Binding="{Binding SredniaDziennie, StringFormat=N1}" Width="90"/>
                                <DataGridTextColumn Header="SPÃ“Å¹NIENIA" Binding="{Binding Spoznienia}" Width="90"/>
                                <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <!-- Stopka z listÄ… agencji -->
                    <Border Grid.Row="3" Background="White" CornerRadius="8" Padding="15" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="Rozpoznane agencje:" FontSize="11" Foreground="#718096" VerticalAlignment="Center" Margin="0,0,15,0"/>
                            <ItemsControl x:Name="icAgencje">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#EDF2F7" CornerRadius="4" Padding="8,4" Margin="3,0">
                                            <TextBlock Text="{Binding}" FontSize="11" Foreground="#4A5568"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== HISTORIA PRACOWNIKA ==================== -->
            <TabItem Header="ðŸ‘¤ Historia">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- WybÃ³r pracownika -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Pracownik:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <ComboBox x:Name="cmbHistoriaPracownik" Width="300" SelectionChanged="CmbHistoriaPracownik_SelectionChanged"/>
                            <TextBlock Text="Okres:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="25,0,10,0"/>
                            <ComboBox x:Name="cmbHistoriaOkres" Width="150" SelectedIndex="0" SelectionChanged="CmbHistoriaOkres_SelectionChanged">
                                <ComboBoxItem Content="Ostatnie 7 dni"/>
                                <ComboBoxItem Content="Ostatnie 30 dni"/>
                                <ComboBoxItem Content="Ten miesiÄ…c"/>
                                <ComboBoxItem Content="Poprzedni miesiÄ…c"/>
                                <ComboBoxItem Content="Ostatnie 3 miesiÄ…ce"/>
                                <ComboBoxItem Content="CaÅ‚y rok"/>
                            </ComboBox>
                            <Button Content="ðŸ“Š PokaÅ¼ historiÄ™" Style="{StaticResource PrimaryButton}" Margin="20,0,0,0" Click="BtnPokazHistorie_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- Statystyki pracownika -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Info o pracowniku -->
                            <StackPanel Grid.Column="0" Margin="0,0,30,0">
                                <TextBlock x:Name="txtHistoriaNazwisko" Text="Wybierz pracownika" FontSize="20" FontWeight="Bold" Foreground="#1A202C"/>
                                <TextBlock x:Name="txtHistoriaDzial" Text="" FontSize="12" Foreground="#3182CE" FontWeight="SemiBold" Margin="0,3,0,0"/>
                                <TextBlock x:Name="txtHistoriaAgencja" Text="" FontSize="11" Foreground="#718096" Margin="0,3,0,0"/>
                            </StackPanel>

                            <!-- Statystyki -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                                <Border Background="#F0FFF4" CornerRadius="8" Padding="20,10" Margin="0,0,10,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="SUMA GODZIN" FontSize="9" Foreground="#276749" FontWeight="Bold" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtHistoriaGodziny" Text="0h" FontSize="28" FontWeight="Bold" Foreground="#276749" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#FFFAF0" CornerRadius="8" Padding="20,10" Margin="0,0,10,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="NADGODZINY" FontSize="9" Foreground="#C05621" FontWeight="Bold" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtHistoriaNadgodziny" Text="0h" FontSize="28" FontWeight="Bold" Foreground="#C05621" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#EBF8FF" CornerRadius="8" Padding="20,10" Margin="0,0,10,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="DNI PRACY" FontSize="9" Foreground="#2B6CB0" FontWeight="Bold" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtHistoriaDni" Text="0" FontSize="28" FontWeight="Bold" Foreground="#2B6CB0" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#FAF5FF" CornerRadius="8" Padding="20,10" Margin="0,0,10,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ÅšR./DZIEÅƒ" FontSize="9" Foreground="#6B46C1" FontWeight="Bold" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtHistoriaSrednia" Text="0h" FontSize="28" FontWeight="Bold" Foreground="#6B46C1" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#FFF5F5" CornerRadius="8" Padding="20,10">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="SPÃ“Å¹NIENIA" FontSize="9" Foreground="#C53030" FontWeight="Bold" HorizontalAlignment="Center"/>
                                        <TextBlock x:Name="txtHistoriaSpoznienia" Text="0" FontSize="28" FontWeight="Bold" Foreground="#C53030" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Historia dni -->
                    <Border Grid.Row="2" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridHistoria" Margin="1" AutoGenerateColumns="False" IsReadOnly="True"
                                  MouseDoubleClick="GridHistoria_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="DATA" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="90"/>
                                <DataGridTextColumn Header="DZIEÅƒ" Binding="{Binding DzienTygodnia}" Width="80"/>
                                <DataGridTextColumn Header="WEJÅšCIE" Binding="{Binding Wejscie}" Width="70"/>
                                <DataGridTextColumn Header="WYJÅšCIE" Binding="{Binding Wyjscie}" Width="70"/>
                                <DataGridTextColumn Header="CZAS PRACY" Binding="{Binding CzasPracy}" Width="90"/>
                                <DataGridTextColumn Header="PRZERWY" Binding="{Binding Przerwy}" Width="70"/>
                                <DataGridTextColumn Header="EFEKTYWNY" Binding="{Binding Efektywny}" Width="90"/>
                                <DataGridTextColumn Header="NADGODZINY" Binding="{Binding Nadgodziny}" Width="100"/>
                                <DataGridTextColumn Header="UWAGI" Binding="{Binding Uwagi}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== OBECNI ==================== -->
            <TabItem Header="ðŸ‘¥ Obecni">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Border Background="#EBF8FF" CornerRadius="8" Padding="30,15" Margin="0,0,20,0">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="OBECNI TERAZ" FontSize="10" Foreground="#3182CE" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtObecniTeraz" Text="0" FontSize="42" FontWeight="Bold" Foreground="#2B6CB0" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#F0FFF4" CornerRadius="8" Padding="30,15" Margin="0,0,20,0">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="WEJÅšCIA DZIÅš" FontSize="10" Foreground="#38A169" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtWejsciaDzis" Text="0" FontSize="42" FontWeight="Bold" Foreground="#276749" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#FFFAF0" CornerRadius="8" Padding="30,15">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="WYJÅšCIA DZIÅš" FontSize="10" Foreground="#DD6B20" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="txtWyjsciaDzis" Text="0" FontSize="42" FontWeight="Bold" Foreground="#C05621" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridObecni" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="220"/>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="180"/>
                                <DataGridTextColumn Header="WEJÅšCIE" Binding="{Binding GodzinaWejscia}" Width="80"/>
                                <DataGridTextColumn Header="CZAS OBECNOÅšCI" Binding="{Binding CzasObecnosci}" Width="120"/>
                                <DataGridTextColumn Header="PUNKT WEJÅšCIA" Binding="{Binding PunktWejscia}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== ALERTY ==================== -->
            <TabItem Header="âš ï¸ Alerty">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#FFF5F5" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#FED7D7" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="âš ï¸" FontSize="18" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <StackPanel>
                                <TextBlock Text="SYSTEM ALERTÃ“W" FontWeight="Bold" Foreground="#C53030" FontSize="12"/>
                                <TextBlock Text="Brak wyjÅ›cia â€¢ Praca &gt;12h â€¢ SpÃ³Åºnienia &gt;15min â€¢ ZbliÅ¼anie do limitu nadgodzin 150h/rok" 
                                           Foreground="#9B2C2C" FontSize="10" Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridAlertyPodglad" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRIORYTET" Binding="{Binding Priorytet}" Width="80"/>
                                <DataGridTextColumn Header="DATA" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="90"/>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="180"/>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="140"/>
                                <DataGridTextColumn Header="TYP ALERTU" Binding="{Binding TypAlertu}" Width="160"/>
                                <DataGridTextColumn Header="OPIS" Binding="{Binding Opis}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== NADGODZINY ==================== -->
            <TabItem Header="ðŸ’° Nadgodziny">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#FFFAF0" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#FEEBC8" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ’°" FontSize="18" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <StackPanel>
                                <TextBlock Text="ROZLICZENIE NADGODZIN" FontWeight="Bold" Foreground="#C05621" FontSize="12"/>
                                <TextBlock Text="Dzienne &gt;8h = nadgodziny â€¢ Tygodniowe &gt;40h = nadgodziny â€¢ Roczny limit: 150h â€¢ Nocne: 22:00-06:00" 
                                           Foreground="#9C4221" FontSize="10" Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridNadgodzinyPodglad" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="180"/>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="140"/>
                                <DataGridTextColumn Header="NORMALNE" Binding="{Binding GodzinyNormalne, StringFormat=N1}" Width="90"/>
                                <DataGridTextColumn Header="NADGODZINY" Binding="{Binding Nadgodziny, StringFormat=N1}" Width="100"/>
                                <DataGridTextColumn Header="NOCNE" Binding="{Binding GodzinyNocne, StringFormat=N1}" Width="70"/>
                                <DataGridTextColumn Header="SUMA" Binding="{Binding SumaGodzin, StringFormat=N1}" Width="70"/>
                                <DataGridTextColumn Header="ROCZNE" Binding="{Binding NadgodzinyRoczne, StringFormat=N0}" Width="70"/>
                                <DataGridTextColumn Header="DO LIMITU" Binding="{Binding DoLimitu}" Width="80"/>
                                <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== RAPORT MIESIÄ˜CZNY ==================== -->
            <TabItem Header="ðŸ“… Raport Mies.">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="MiesiÄ…c:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="cmbMiesiac" Width="130" SelectionChanged="CmbMiesiac_SelectionChanged"/>
                            <TextBlock Text="Rok:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="20,0,8,0"/>
                            <ComboBox x:Name="cmbRok" Width="90" SelectionChanged="CmbRok_SelectionChanged"/>
                            <Button Content="ðŸ“Š Generuj" Style="{StaticResource PrimaryButton}" Margin="20,0,0,0" Click="BtnGenerujRaportMiesieczny_Click"/>
                            <Button Content="ðŸ“¥ Excel" Style="{StaticResource SuccessButton}" Margin="8,0,0,0" Click="BtnExportRaportMiesieczny_Click"/>
                            <Button Content="ðŸ–¨ï¸ Drukuj" Style="{StaticResource ModernButton}" Margin="8,0,0,0" Click="BtnDrukujRaport_Click"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridRaportMiesieczny" Margin="1" AutoGenerateColumns="False" IsReadOnly="True"
                                  MouseDoubleClick="GridRaportMiesieczny_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="180"/>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="130"/>
                                <DataGridTextColumn Header="DNI" Binding="{Binding DniPracy}" Width="50"/>
                                <DataGridTextColumn Header="NORMALNE" Binding="{Binding GodzinyNormalne, StringFormat=N1}" Width="90"/>
                                <DataGridTextColumn Header="NADGODZ." Binding="{Binding Nadgodziny, StringFormat=N1}" Width="90"/>
                                <DataGridTextColumn Header="NOCNE" Binding="{Binding GodzinyNocne, StringFormat=N1}" Width="70"/>
                                <DataGridTextColumn Header="SUMA" Binding="{Binding SumaGodzin, StringFormat=N1}" Width="70"/>
                                <DataGridTextColumn Header="URLOP" Binding="{Binding DniUrlopu}" Width="60"/>
                                <DataGridTextColumn Header="CHOROBA" Binding="{Binding DniChoroby}" Width="70"/>
                                <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== PORÃ“WNANIE MIESIÄ˜CY ==================== -->
            <TabItem Header="ðŸ“ˆ PorÃ³wnanie">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="PorÃ³wnaj:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="cmbPorownanieMiesiac1" Width="130"/>
                            <TextBlock Text="z" FontSize="12" Foreground="#4A5568" VerticalAlignment="Center" Margin="10,0"/>
                            <ComboBox x:Name="cmbPorownanieMiesiac2" Width="130"/>
                            <Button Content="ðŸ“Š PorÃ³wnaj" Style="{StaticResource PrimaryButton}" Margin="20,0,0,0" Click="BtnPorownajMiesiace_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- Karty porÃ³wnania -->
                    <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,10">
                        <Border Style="{StaticResource DashboardTile}">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="GODZINY ÅÄ„CZNIE" FontSize="9" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock x:Name="txtPorownGodziny1" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                    <TextBlock Text=" vs " FontSize="14" Foreground="#A0AEC0" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtPorownGodziny2" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                </StackPanel>
                                <TextBlock x:Name="txtPorownGodzinyZmiana" Text="â–² +0%" FontSize="11" Foreground="#38A169" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource DashboardTile}">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="PRACOWNIKÃ“W" FontSize="9" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock x:Name="txtPorownPracownikow1" Text="0" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                    <TextBlock Text=" vs " FontSize="14" Foreground="#A0AEC0" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtPorownPracownikow2" Text="0" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                </StackPanel>
                                <TextBlock x:Name="txtPorownPracownikowZmiana" Text="â–² +0" FontSize="11" Foreground="#38A169" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource DashboardTile}">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="ÅšREDNIA/OSOBÄ˜" FontSize="9" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock x:Name="txtPorownSrednia1" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                    <TextBlock Text=" vs " FontSize="14" Foreground="#A0AEC0" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtPorownSrednia2" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                </StackPanel>
                                <TextBlock x:Name="txtPorownSredniaZmiana" Text="â–² +0%" FontSize="11" Foreground="#38A169" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource DashboardTile}">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="NADGODZINY" FontSize="9" Foreground="#718096" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                    <TextBlock x:Name="txtPorownNadgodziny1" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                    <TextBlock Text=" vs " FontSize="14" Foreground="#A0AEC0" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtPorownNadgodziny2" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#2D3748"/>
                                </StackPanel>
                                <TextBlock x:Name="txtPorownNadgodzinyZmiana" Text="â–² +0%" FontSize="11" Foreground="#38A169" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>

                    <!-- PorÃ³wnanie dziaÅ‚Ã³w -->
                    <Border Grid.Row="2" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridPorownanie" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="180"/>
                                <DataGridTextColumn Header="GODZINY M1" Binding="{Binding GodzinyM1, StringFormat=N0}" Width="100"/>
                                <DataGridTextColumn Header="GODZINY M2" Binding="{Binding GodzinyM2, StringFormat=N0}" Width="100"/>
                                <DataGridTextColumn Header="ZMIANA" Binding="{Binding Zmiana}" Width="90"/>
                                <DataGridTextColumn Header="PRACOWN. M1" Binding="{Binding PracownicyM1}" Width="100"/>
                                <DataGridTextColumn Header="PRACOWN. M2" Binding="{Binding PracownicyM2}" Width="100"/>
                                <DataGridTextColumn Header="TREND" Binding="{Binding Trend}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== RANKING ==================== -->
            <TabItem Header="ðŸ† Ranking">
                <Border Background="White" CornerRadius="8" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                    <DataGrid x:Name="gridRanking" Margin="1" AutoGenerateColumns="False" IsReadOnly="True"
                              MouseDoubleClick="GridRanking_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="#" Binding="{Binding Pozycja}" Width="40"/>
                            <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="200"/>
                            <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="160"/>
                            <DataGridTextColumn Header="GODZINY" Binding="{Binding SumaGodzin, StringFormat=N1}" Width="90"/>
                            <DataGridTextColumn Header="DNI PRACY" Binding="{Binding DniPracy}" Width="80"/>
                            <DataGridTextColumn Header="ÅšR. DZIENNIE" Binding="{Binding SredniaDziennie, StringFormat=N1}" Width="100"/>
                            <DataGridTextColumn Header="PUNKTUALNOÅšÄ†" Binding="{Binding Punktualnosc}" Width="110"/>
                            <DataGridTextColumn Header="OCENA" Binding="{Binding Ocena}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </Border>
            </TabItem>

            <!-- ==================== KARTA EWIDENCJI ==================== -->
            <TabItem Header="ðŸ“‡ Ewidencja">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="Pracownik:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="cmbPracownikEwidencja" Width="260" SelectionChanged="CmbPracownikEwidencja_SelectionChanged"/>
                            <TextBlock Text="MiesiÄ…c:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="20,0,8,0"/>
                            <ComboBox x:Name="cmbMiesiacEwidencja" Width="130"/>
                            <TextBlock Text="Rok:" FontSize="12" Foreground="#4A5568" FontWeight="SemiBold" VerticalAlignment="Center" Margin="12,0,8,0"/>
                            <ComboBox x:Name="cmbRokEwidencja" Width="80"/>
                            <Button Content="ðŸ“‹ Generuj" Style="{StaticResource PrimaryButton}" Margin="20,0,0,0" Click="BtnGenerujKarteEwidencji_Click"/>
                            <Button Content="ðŸ–¨ï¸ Drukuj" Style="{StaticResource ModernButton}" Margin="8,0,0,0" Click="BtnDrukujKarteEwidencji_Click"/>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="#EBF8FF" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#BEE3F8" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <StackPanel Margin="0,0,40,0">
                                <TextBlock Text="PRZEPRACOWANE" FontSize="9" Foreground="#2B6CB0" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtEwidencjaPrzepracowane" Text="0h" FontSize="28" FontWeight="Bold" Foreground="#2C5282" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="0,0,40,0">
                                <TextBlock Text="NORMALNE" FontSize="9" Foreground="#276749" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtEwidencjaNormalne" Text="0h" FontSize="28" FontWeight="Bold" Foreground="#276749" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel Margin="0,0,40,0">
                                <TextBlock Text="NADGODZINY" FontSize="9" Foreground="#C05621" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtEwidencjaNadgodziny" Text="0h" FontSize="28" FontWeight="Bold" Foreground="#C05621" HorizontalAlignment="Center"/>
                            </StackPanel>
                            <StackPanel>
                                <TextBlock Text="NOCNE" FontSize="9" Foreground="#6B46C1" FontWeight="Bold" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="txtEwidencjaNocne" Text="0h" FontSize="28" FontWeight="Bold" Foreground="#6B46C1" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="2" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridKartaEwidencji" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="DATA" Binding="{Binding Data, StringFormat=dd.MM}" Width="60"/>
                                <DataGridTextColumn Header="DZIEÅƒ" Binding="{Binding DzienTygodnia}" Width="60"/>
                                <DataGridTextColumn Header="WEJÅšCIE" Binding="{Binding Wejscie}" Width="65"/>
                                <DataGridTextColumn Header="WYJÅšCIE" Binding="{Binding Wyjscie}" Width="65"/>
                                <DataGridTextColumn Header="PRZERWY" Binding="{Binding Przerwy}" Width="65"/>
                                <DataGridTextColumn Header="NORMAL." Binding="{Binding GodzinyNormalne, StringFormat=N2}" Width="70"/>
                                <DataGridTextColumn Header="NADGODZ." Binding="{Binding Nadgodziny, StringFormat=N2}" Width="80"/>
                                <DataGridTextColumn Header="NOCNE" Binding="{Binding GodzinyNocne, StringFormat=N2}" Width="65"/>
                                <DataGridTextColumn Header="SUMA" Binding="{Binding SumaGodzin, StringFormat=N2}" Width="65"/>
                                <DataGridTextColumn Header="UWAGI" Binding="{Binding Uwagi}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== PUNKTUALNOÅšÄ† ==================== -->
            <TabItem Header="â±ï¸ PunktualnoÅ›Ä‡">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#F0FFF4" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#C6F6D5" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="â±ï¸" FontSize="18" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <StackPanel>
                                <TextBlock Text="ANALIZA PUNKTUALNOÅšCI" FontWeight="Bold" Foreground="#276749" FontSize="12"/>
                                <TextBlock Text="SpÃ³Åºnienie = wejÅ›cie po 06:10 â€¢ â­â­â­ &gt;95% â€¢ â­â­ &gt;85% â€¢ â­ &gt;70%" 
                                           Foreground="#2F855A" FontSize="10" Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridPunktualnosc" Margin="1" AutoGenerateColumns="False" IsReadOnly="True"
                                  MouseDoubleClick="GridPunktualnosc_MouseDoubleClick">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="200"/>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="160"/>
                                <DataGridTextColumn Header="DNI" Binding="{Binding DniPracy}" Width="50"/>
                                <DataGridTextColumn Header="SPÃ“Å¹NIENIA" Binding="{Binding Spoznienia}" Width="90"/>
                                <DataGridTextColumn Header="SUMA MIN" Binding="{Binding SumaSpoznienMin}" Width="90"/>
                                <DataGridTextColumn Header="WCZ. WYJÅšCIA" Binding="{Binding WczesniejszeWyjscia}" Width="100"/>
                                <DataGridTextColumn Header="%" Binding="{Binding ProcentPunktualnosci, StringFormat={}{0:N0}%}" Width="60"/>
                                <DataGridTextColumn Header="OCENA" Binding="{Binding Ocena}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== NIEOBECNOÅšCI ==================== -->
            <TabItem Header="ðŸ  NieobecnoÅ›ci">
                <Grid Margin="0,10,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="#FFF5F5" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#FED7D7" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ " FontSize="18" VerticalAlignment="Center" Margin="0,0,10,0"/>
                            <StackPanel>
                                <TextBlock Text="WYKRYWANIE NIEOBECNOÅšCI" FontWeight="Bold" Foreground="#C53030" FontSize="12"/>
                                <TextBlock Text="Dni robocze bez rejestracji â€¢ Weekendy pomijane â€¢ ðŸ–ï¸ Urlop | ðŸ¤’ Choroba | â“ Nieusprawiedliwiona" 
                                           Foreground="#9B2C2C" FontSize="10" Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridNieobecnosci" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="DATA" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="90"/>
                                <DataGridTextColumn Header="DZIEÅƒ" Binding="{Binding Data, StringFormat=ddd}" Width="70"/>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="200"/>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding Grupa}" Width="160"/>
                                <DataGridTextColumn Header="TYP" Binding="{Binding TypNieobecnosci}" Width="150"/>
                                <DataGridTextColumn Header="STATUS" Binding="{Binding Status}" Width="120"/>
                                <DataGridTextColumn Header="UWAGI" Binding="{Binding Uwagi}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <Border Grid.Row="2" Background="White" CornerRadius="8" Padding="15" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Border Background="#FED7D7" CornerRadius="6" Padding="20,8" Margin="0,0,12,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="â“ Nieusprawiedliwione:" Foreground="#C53030" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtNieobecnosciNieusp" Text="0" Foreground="#C53030" FontWeight="Bold" FontSize="18" Margin="8,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#FEEBC8" CornerRadius="6" Padding="20,8" Margin="0,0,12,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ¤’ Chorobowe:" Foreground="#C05621" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtNieobecnosciChoroba" Text="0" Foreground="#C05621" FontWeight="Bold" FontSize="18" Margin="8,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#C6F6D5" CornerRadius="6" Padding="20,8">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ–ï¸ Urlopy:" Foreground="#276749" FontWeight="SemiBold" FontSize="12" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtNieobecnosciUrlop" Text="0" Foreground="#276749" FontWeight="Bold" FontSize="18" Margin="8,0,0,0" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== URLOPY I NIEOBECNOÅšCI ==================== -->
            <TabItem Header="ðŸ–ï¸ Urlopy">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Toolbar -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="âž• Dodaj nieobecnoÅ›Ä‡" Style="{StaticResource PrimaryButton}" Click="BtnDodajNieobecnosc_Click" Margin="0,0,10,0"/>
                                <Button Content="âœ… ZatwierdÅº" Style="{StaticResource SuccessButton}" Click="BtnZatwierdzNieobecnosc_Click" Margin="0,0,10,0"/>
                                <Button Content="âŒ OdrzuÄ‡" Style="{StaticResource DangerButton}" Click="BtnOdrzucNieobecnosc_Click" Margin="0,0,20,0"/>
                                
                                <ComboBox x:Name="cmbTypNieobecnosci" Width="180" Margin="0,0,10,0"/>
                                <ComboBox x:Name="cmbStatusNieobecnosci" Width="120" Margin="0,0,10,0">
                                    <ComboBoxItem Content="Wszystkie" IsSelected="True"/>
                                    <ComboBoxItem Content="OczekujÄ…ce"/>
                                    <ComboBoxItem Content="Zatwierdzone"/>
                                    <ComboBoxItem Content="Odrzucone"/>
                                </ComboBox>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <TextBlock Text="MiesiÄ…c:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <ComboBox x:Name="cmbUrlopyMiesiac" Width="100" SelectionChanged="CmbUrlopyMiesiac_Changed"/>
                                <ComboBox x:Name="cmbUrlopyRok" Width="80" Margin="5,0,0,0" SelectionChanged="CmbUrlopyRok_Changed"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Lista nieobecnoÅ›ci -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridUrlopy" Margin="1" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding PracownikNazwa}" Width="180"/>
                                <DataGridTextColumn Header="TYP" Binding="{Binding TypNazwa}" Width="150"/>
                                <DataGridTextColumn Header="OD" Binding="{Binding DataOd, StringFormat=dd.MM.yyyy}" Width="90"/>
                                <DataGridTextColumn Header="DO" Binding="{Binding DataDo, StringFormat=dd.MM.yyyy}" Width="90"/>
                                <DataGridTextColumn Header="DNI" Binding="{Binding IloscDni}" Width="50"/>
                                <DataGridTemplateColumn Header="STATUS" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="4" Padding="8,4" HorizontalAlignment="Left"
                                                    Background="{Binding StatusKolor}">
                                                <TextBlock Text="{Binding Status}" FontSize="11" FontWeight="SemiBold" Foreground="White"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="UWAGI" Binding="{Binding Uwagi}" Width="*"/>
                                <DataGridTextColumn Header="DATA WNIOSKU" Binding="{Binding DataUtworzenia, StringFormat=dd.MM.yyyy HH:mm}" Width="130"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <!-- Podsumowanie -->
                    <Border Grid.Row="2" Background="White" CornerRadius="8" Padding="15" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                        <UniformGrid Columns="5">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Urlop wypoczynkowy" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtUrlopyWypoczynkowe" Text="0 dni" FontSize="18" FontWeight="Bold" Foreground="#38A169"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Na Å¼Ä…danie" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtUrlopyNaZadanie" Text="0 / 4 dni" FontSize="18" FontWeight="Bold" Foreground="#DD6B20"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Chorobowe" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtUrlopyChorobowe" Text="0 dni" FontSize="18" FontWeight="Bold" Foreground="#E53E3E"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="OkolicznoÅ›ciowe" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtUrlopyOkolicznosciowe" Text="0 dni" FontSize="18" FontWeight="Bold" Foreground="#805AD5"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="OczekujÄ…ce wnioski" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtUrlopyOczekujace" Text="0" FontSize="18" FontWeight="Bold" Foreground="#3182CE"/>
                            </StackPanel>
                        </UniformGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== KARTOTEKA NADGODZIN ==================== -->
            <TabItem Header="â° Nadgodziny">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Toolbar -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="âž• Dodaj nadgodziny" Style="{StaticResource PrimaryButton}" Click="BtnDodajNadgodziny_Click" Margin="0,0,10,0"/>
                                <Button Content="âœ… Odbierz godziny" Style="{StaticResource SuccessButton}" Click="BtnOdbierzNadgodziny_Click" Margin="0,0,10,0"/>
                                <Button Content="ðŸ”„ Przelicz automatycznie" Style="{StaticResource ModernButton}" Click="BtnPrzeliczNadgodziny_Click" Margin="0,0,20,0"/>
                                
                                <ComboBox x:Name="cmbNadgodzinyStatus" Width="150">
                                    <ComboBoxItem Content="Do odbioru" IsSelected="True"/>
                                    <ComboBoxItem Content="CzÄ™Å›ciowo odebrane"/>
                                    <ComboBoxItem Content="Odebrane"/>
                                    <ComboBoxItem Content="Wszystkie"/>
                                </ComboBox>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <TextBlock Text="Pracownik:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <ComboBox x:Name="cmbNadgodzinyPracownik" Width="200"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Lista nadgodzin -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridNadgodziny" Margin="1" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding PracownikNazwa}" Width="180"/>
                                <DataGridTextColumn Header="DATA NABICIA" Binding="{Binding DataNabicia, StringFormat=dd.MM.yyyy}" Width="100"/>
                                <DataGridTextColumn Header="GODZIN" Binding="{Binding IloscGodzin, StringFormat=N2}" Width="80"/>
                                <DataGridTextColumn Header="ODEBRANO" Binding="{Binding IloscOdebrana, StringFormat=N2}" Width="80"/>
                                <DataGridTextColumn Header="ZOSTAÅO" Binding="{Binding DoOdebrania, StringFormat=N2}" Width="80"/>
                                <DataGridTemplateColumn Header="STATUS" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="4" Padding="8,4" HorizontalAlignment="Left"
                                                    Background="{Binding StatusKolor}">
                                                <TextBlock Text="{Binding StatusNazwa}" FontSize="11" FontWeight="SemiBold" Foreground="White"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="DATA ODBIORU" Binding="{Binding DataOdbioru, StringFormat=dd.MM.yyyy}" Width="100"/>
                                <DataGridTextColumn Header="UWAGI" Binding="{Binding Uwagi}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <!-- Podsumowanie -->
                    <Border Grid.Row="2" Background="White" CornerRadius="8" Padding="15" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                        <UniformGrid Columns="4">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Suma do odbioru" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtNadgodzinySuma" Text="0.00 h" FontSize="24" FontWeight="Bold" Foreground="#DD6B20"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Pracownicy z nadgodzinami" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtNadgodzinyPracownicy" Text="0" FontSize="24" FontWeight="Bold" Foreground="#3182CE"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Odebrano w tym miesiÄ…cu" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtNadgodzinyOdebrane" Text="0.00 h" FontSize="24" FontWeight="Bold" Foreground="#38A169"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Najstarsze nieodebrane" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtNadgodzinyNajstarsze" Text="-" FontSize="18" FontWeight="Bold" Foreground="#E53E3E"/>
                            </StackPanel>
                        </UniformGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== ROZLICZENIA AGENCJI ==================== -->
            <TabItem Header="ðŸ¢ Agencje">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Alert przekroczeÅ„ -->
                    <Border x:Name="panelAlertAgencje" Grid.Row="0" Background="#FFF5F5" CornerRadius="8" Padding="15" Margin="0,0,0,10" 
                            BorderBrush="#FED7D7" BorderThickness="1" Visibility="Collapsed">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="âš ï¸" FontSize="24" VerticalAlignment="Center" Margin="0,0,15,0"/>
                            <StackPanel>
                                <TextBlock Text="PRZEKROCZENIA CZASU PRACY!" FontWeight="Bold" Foreground="#C53030" FontSize="14"/>
                                <TextBlock x:Name="txtAlertAgencjeOpis" Text="Wykryto pracownikÃ³w przekraczajÄ…cych limit godzin" Foreground="#9B2C2C" FontSize="12"/>
                            </StackPanel>
                            <Button Content="PokaÅ¼ szczegÃ³Å‚y" Style="{StaticResource DangerButton}" Margin="20,0,0,0" VerticalAlignment="Center"
                                    Click="BtnPokazPrzekroczenia_Click"/>
                        </StackPanel>
                    </Border>

                    <!-- Toolbar -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="TydzieÅ„:" VerticalAlignment="Center" Margin="0,0,8,0" FontWeight="SemiBold"/>
                                <ComboBox x:Name="cmbAgencjaTydzien" Width="200" SelectionChanged="CmbAgencjaTydzien_Changed"/>
                                <Button Content="â—€" Style="{StaticResource ModernButton}" Margin="10,0,5,0" Click="BtnAgencjaPoprzedniTydzien_Click"/>
                                <Button Content="â–¶" Style="{StaticResource ModernButton}" Click="BtnAgencjaNastepnyTydzien_Click"/>
                                <Button Content="BieÅ¼Ä…cy tydzieÅ„" Style="{StaticResource ModernButton}" Margin="10,0,0,0" Click="BtnAgencjaBiezacyTydzien_Click"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <TextBlock Text="Agencja:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <ComboBox x:Name="cmbAgencjaFiltr" Width="180" SelectionChanged="CmbAgencjaFiltr_Changed"/>
                                <Button Content="ðŸ“¥ Export Excel" Style="{StaticResource SuccessButton}" Margin="15,0,0,0" Click="BtnExportAgencjeTydzien_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Tabela tygodniowa -->
                    <Border Grid.Row="2" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridAgencjeTydzien" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding Pracownik}" Width="180"/>
                                <DataGridTextColumn Header="AGENCJA" Binding="{Binding Agencja}" Width="120"/>
                                <DataGridTemplateColumn Header="PN" Width="65">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding PnKolor}" CornerRadius="3" Padding="4,2">
                                                <TextBlock Text="{Binding Pn, StringFormat=N1}" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="WT" Width="65">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding WtKolor}" CornerRadius="3" Padding="4,2">
                                                <TextBlock Text="{Binding Wt, StringFormat=N1}" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="ÅšR" Width="65">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding SrKolor}" CornerRadius="3" Padding="4,2">
                                                <TextBlock Text="{Binding Sr, StringFormat=N1}" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="CZ" Width="65">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding CzKolor}" CornerRadius="3" Padding="4,2">
                                                <TextBlock Text="{Binding Cz, StringFormat=N1}" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="PT" Width="65">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding PtKolor}" CornerRadius="3" Padding="4,2">
                                                <TextBlock Text="{Binding Pt, StringFormat=N1}" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="SB" Width="65">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding SbKolor}" CornerRadius="3" Padding="4,2">
                                                <TextBlock Text="{Binding Sb, StringFormat=N1}" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="ND" Width="65">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border Background="{Binding NdKolor}" CornerRadius="3" Padding="4,2">
                                                <TextBlock Text="{Binding Nd, StringFormat=N1}" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="SUMA" Binding="{Binding Suma, StringFormat=N1}" Width="70" FontWeight="Bold"/>
                                <DataGridTemplateColumn Header="ALERT" Width="80">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Alert}" FontSize="16" HorizontalAlignment="Center"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== SPÃ“Å¹NIENIA ==================== -->
            <TabItem Header="â±ï¸ SpÃ³Åºnienia">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Toolbar -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <Grid>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="ðŸ” Wykryj spÃ³Åºnienia" Style="{StaticResource PrimaryButton}" Click="BtnWykryjSpoznienia_Click" Margin="0,0,10,0"/>
                                <Button Content="âœ… Usprawiedliw" Style="{StaticResource SuccessButton}" Click="BtnUsprawiedliwSpoznienie_Click" Margin="0,0,20,0"/>
                                
                                <TextBlock Text="Tolerancja:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <ComboBox x:Name="cmbTolerancjaSpoznienia" Width="80" SelectedIndex="1">
                                    <ComboBoxItem Content="0 min"/>
                                    <ComboBoxItem Content="5 min"/>
                                    <ComboBoxItem Content="10 min"/>
                                    <ComboBoxItem Content="15 min"/>
                                </ComboBox>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <TextBlock Text="MiesiÄ…c:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <ComboBox x:Name="cmbSpoznieniaMiesiac" Width="100" SelectionChanged="CmbSpoznieniaMiesiac_Changed"/>
                                <ComboBox x:Name="cmbSpoznieniaRok" Width="80" Margin="5,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Lista spÃ³ÅºnieÅ„ -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridSpoznienia" Margin="1" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="DATA" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="90"/>
                                <DataGridTextColumn Header="DZIEÅƒ" Binding="{Binding DzienTygodnia}" Width="70"/>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding PracownikNazwa}" Width="180"/>
                                <DataGridTextColumn Header="DZIAÅ" Binding="{Binding GrupaNazwa}" Width="120"/>
                                <DataGridTextColumn Header="PLANOWANA" Binding="{Binding PlanowanaGodzina, StringFormat=HH\\:mm}" Width="90"/>
                                <DataGridTextColumn Header="RZECZYWISTA" Binding="{Binding RzeijczystaGodzina, StringFormat=HH\\:mm}" Width="100"/>
                                <DataGridTemplateColumn Header="SPÃ“Å¹NIENIE" Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="4" Padding="8,4" HorizontalAlignment="Left"
                                                    Background="{Binding SpoznienieKolor}">
                                                <TextBlock Text="{Binding SpoznienieMin, StringFormat={}{0} min}" FontWeight="SemiBold" Foreground="White"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="STATUS" Width="120">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding StatusIkona}" FontSize="14"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="UWAGI" Binding="{Binding Uwagi}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>

                    <!-- Statystyki -->
                    <Border Grid.Row="2" Background="White" CornerRadius="8" Padding="15" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                        <UniformGrid Columns="5">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="SpÃ³ÅºnieÅ„ w miesiÄ…cu" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtSpoznieniaIlosc" Text="0" FontSize="24" FontWeight="Bold" Foreground="#E53E3E"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Suma minut" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtSpoznieniaMinuty" Text="0" FontSize="24" FontWeight="Bold" Foreground="#DD6B20"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Usprawiedliwione" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtSpoznieniaUspraw" Text="0" FontSize="24" FontWeight="Bold" Foreground="#38A169"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="RecydywiÅ›ci (>3)" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtSpoznieniaRecydywisci" Text="0" FontSize="24" FontWeight="Bold" Foreground="#C53030"/>
                            </StackPanel>
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="Åšrednie spÃ³Åºnienie" FontSize="10" Foreground="#718096"/>
                                <TextBlock x:Name="txtSpoznieniaSrednia" Text="0 min" FontSize="24" FontWeight="Bold" Foreground="#3182CE"/>
                            </StackPanel>
                        </UniformGrid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== PRZERWY ==================== -->
            <TabItem Header="â˜• Przerwy">
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="350"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Panel harmonogramu -->
                    <Border Grid.Column="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,10,0" BorderBrush="#E2E8F0" BorderThickness="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="ðŸ“… HARMONOGRAM PRZERW" FontWeight="Bold" FontSize="14" Margin="0,0,0,15"/>
                            
                            <ListBox x:Name="listHarmonogramPrzerw" Grid.Row="1" BorderThickness="0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#F7FAFC" CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel Grid.Column="0">
                                                    <TextBlock Text="{Binding Nazwa}" FontWeight="SemiBold" FontSize="13"/>
                                                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                        <TextBlock Text="{Binding GodzinaOd, StringFormat=HH\\:mm}" Foreground="#3182CE" FontWeight="Bold"/>
                                                        <TextBlock Text=" - " Foreground="#718096"/>
                                                        <TextBlock Text="{Binding GodzinaDo, StringFormat=HH\\:mm}" Foreground="#3182CE" FontWeight="Bold"/>
                                                        <TextBlock Text="{Binding CzasTrwaniaMin, StringFormat=' ({0} min)'}" Foreground="#718096"/>
                                                    </StackPanel>
                                                </StackPanel>
                                                <Button Grid.Column="1" Content="âœï¸" Style="{StaticResource ModernButton}" Padding="8,4" 
                                                        Click="BtnEdytujPrzerwe_Click" Tag="{Binding Id}"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>

                            <StackPanel Grid.Row="2" Margin="0,10,0,0">
                                <Button Content="âž• Dodaj przerwÄ™" Style="{StaticResource PrimaryButton}" Click="BtnDodajHarmonogramPrzerwy_Click"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Lista wyjÅ›Ä‡ poza harmonogramem -->
                    <Grid Grid.Column="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Toolbar -->
                        <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                            <Grid>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="ðŸ” Analizuj przerwy" Style="{StaticResource PrimaryButton}" Click="BtnAnalizujPrzerwy_Click" Margin="0,0,15,0"/>
                                    <CheckBox x:Name="chkTylkoPozaHarmonogramem" Content="Tylko poza harmonogramem" VerticalAlignment="Center"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <DatePicker x:Name="dpPrzerwyData" Width="120"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <!-- Lista -->
                        <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                            <DataGrid x:Name="gridPrzerwy" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding PracownikNazwa}" Width="180"/>
                                    <DataGridTextColumn Header="WYJÅšCIE" Binding="{Binding GodzinaWyjscia, StringFormat=HH\\:mm}" Width="80"/>
                                    <DataGridTextColumn Header="WEJÅšCIE" Binding="{Binding GodzinaWejscia, StringFormat=HH\\:mm}" Width="80"/>
                                    <DataGridTextColumn Header="CZAS" Binding="{Binding CzasTrwaniaMin, StringFormat={}{0} min}" Width="70"/>
                                    <DataGridTemplateColumn Header="STATUS" Width="150">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Border CornerRadius="4" Padding="8,4" HorizontalAlignment="Left"
                                                        Background="{Binding StatusKolor}">
                                                    <TextBlock Text="{Binding StatusTekst}" FontSize="11" FontWeight="SemiBold" Foreground="White"/>
                                                </Border>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="PRZYPISANA PRZERWA" Binding="{Binding HarmonogramNazwa}" Width="*"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <!-- Statystyki -->
                        <Border Grid.Row="2" Background="White" CornerRadius="8" Padding="15" Margin="0,10,0,0" BorderBrush="#E2E8F0" BorderThickness="1">
                            <UniformGrid Columns="4">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="W harmonogramie" FontSize="10" Foreground="#718096"/>
                                    <TextBlock x:Name="txtPrzerwyWHarmonogramie" Text="0" FontSize="20" FontWeight="Bold" Foreground="#38A169"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Poza harmonogramem" FontSize="10" Foreground="#718096"/>
                                    <TextBlock x:Name="txtPrzerwyPozaHarmonogramem" Text="0" FontSize="20" FontWeight="Bold" Foreground="#E53E3E"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="Åšredni czas przerwy" FontSize="10" Foreground="#718096"/>
                                    <TextBlock x:Name="txtPrzerwySredniCzas" Text="0 min" FontSize="20" FontWeight="Bold" Foreground="#3182CE"/>
                                </StackPanel>
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="NajdÅ‚uÅ¼sza przerwa" FontSize="10" Foreground="#718096"/>
                                    <TextBlock x:Name="txtPrzerwyNajdluzsza" Text="0 min" FontSize="20" FontWeight="Bold" Foreground="#DD6B20"/>
                                </StackPanel>
                            </UniformGrid>
                        </Border>
                    </Grid>
                </Grid>
            </TabItem>

            <!-- ==================== ALERTY ==================== -->
            <TabItem Header="ðŸš¨ Alerty">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Podsumowanie alertÃ³w -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <UniformGrid Columns="5">
                            <Border Background="#FFF5F5" CornerRadius="8" Padding="15" Margin="0,0,8,0">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸ”´ Agencja >12h" FontSize="11" Foreground="#C53030" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="txtAlertAgencja12" Text="0" FontSize="28" FontWeight="Bold" Foreground="#C53030"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#FFFAF0" CornerRadius="8" Padding="15" Margin="0,0,8,0">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="ðŸŸ  WÅ‚asny >13h" FontSize="11" Foreground="#C05621" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="txtAlertWlasny13" Text="0" FontSize="28" FontWeight="Bold" Foreground="#C05621"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#FFF5F5" CornerRadius="8" Padding="15" Margin="0,0,8,0">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="âŒ Brak wyjÅ›cia" FontSize="11" Foreground="#C53030" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="txtAlertBrakWyjscia" Text="0" FontSize="28" FontWeight="Bold" Foreground="#C53030"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#FFF5F5" CornerRadius="8" Padding="15" Margin="0,0,8,0">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="âŒ Brak wejÅ›cia" FontSize="11" Foreground="#C53030" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="txtAlertBrakWejscia" Text="0" FontSize="28" FontWeight="Bold" Foreground="#C53030"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#FFFAF0" CornerRadius="8" Padding="15">
                                <StackPanel HorizontalAlignment="Center">
                                    <TextBlock Text="â° SpÃ³Åºnienia" FontSize="11" Foreground="#C05621" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="txtAlertSpoznienia" Text="0" FontSize="28" FontWeight="Bold" Foreground="#C05621"/>
                                </StackPanel>
                            </Border>
                        </UniformGrid>
                    </Border>

                    <!-- Lista alertÃ³w -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <Border Grid.Row="0" Background="#F7FAFC" Padding="15">
                                <Grid>
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="ðŸ”„ Skanuj alerty" Style="{StaticResource PrimaryButton}" Click="BtnSkanujAlerty_Click" Margin="0,0,10,0"/>
                                        <Button Content="âœ… Oznacz przeczytane" Style="{StaticResource ModernButton}" Click="BtnOznaczPrzeczytane_Click"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <CheckBox x:Name="chkTylkoNieprzeczytane" Content="Tylko nieprzeczytane" IsChecked="True" VerticalAlignment="Center" Margin="0,0,15,0"
                                                  Checked="ChkAlertyFiltr_Changed" Unchecked="ChkAlertyFiltr_Changed"/>
                                        <ComboBox x:Name="cmbAlertyTyp" Width="150" SelectionChanged="CmbAlertyTyp_Changed">
                                            <ComboBoxItem Content="Wszystkie typy" IsSelected="True"/>
                                            <ComboBoxItem Content="Przekroczenie 12h"/>
                                            <ComboBoxItem Content="Przekroczenie 13h"/>
                                            <ComboBoxItem Content="Brak wejÅ›cia"/>
                                            <ComboBoxItem Content="Brak wyjÅ›cia"/>
                                            <ComboBoxItem Content="SpÃ³Åºnienie"/>
                                        </ComboBox>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <DataGrid x:Name="gridAlerty" Grid.Row="1" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Header="" Width="30">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Ikona}" FontSize="16" HorizontalAlignment="Center"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="DATA" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="90"/>
                                    <DataGridTextColumn Header="TYP" Binding="{Binding TypAlertu}" Width="130"/>
                                    <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding PracownikNazwa}" Width="180"/>
                                    <DataGridTextColumn Header="DZIAÅ/AGENCJA" Binding="{Binding GrupaNazwa}" Width="150"/>
                                    <DataGridTextColumn Header="WARTOÅšÄ†" Binding="{Binding WartoscTekst}" Width="100"/>
                                    <DataGridTextColumn Header="OPIS" Binding="{Binding Opis}" Width="*"/>
                                    <DataGridTemplateColumn Header="STATUS" Width="80">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding StatusIkona}" FontSize="14" HorizontalAlignment="Center"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ==================== PRZESUNIÄ˜CIA GODZIN ==================== -->
            <TabItem Header="ðŸ”„ PrzesuniÄ™cia">
                <Grid Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Toolbar -->
                    <Border Grid.Row="0" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="âž• Nowe przesuniÄ™cie" Style="{StaticResource PrimaryButton}" Click="BtnDodajPrzesuniecie_Click" Margin="0,0,10,0"/>
                            <Button Content="âŒ Anuluj" Style="{StaticResource DangerButton}" Click="BtnAnulujPrzesuniecie_Click" Margin="0,0,20,0"/>
                            
                            <TextBlock Text="Pokazuj:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="cmbPrzesunieciaStatus" Width="120" SelectionChanged="CmbPrzesunieciaStatus_Changed">
                                <ComboBoxItem Content="Aktywne" IsSelected="True"/>
                                <ComboBoxItem Content="ZakoÅ„czone"/>
                                <ComboBoxItem Content="Anulowane"/>
                                <ComboBoxItem Content="Wszystkie"/>
                            </ComboBox>
                        </StackPanel>
                    </Border>

                    <!-- Lista przesuniÄ™Ä‡ -->
                    <Border Grid.Row="1" Background="White" CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1">
                        <DataGrid x:Name="gridPrzesuniecia" Margin="1" AutoGenerateColumns="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                                <DataGridTextColumn Header="PRACOWNIK" Binding="{Binding PracownikNazwa}" Width="180"/>
                                <DataGridTextColumn Header="OD DNIA" Binding="{Binding DataPrzesunieciaOd, StringFormat=dd.MM.yyyy}" Width="100"/>
                                <DataGridTextColumn Header="DO DNIA" Binding="{Binding DataPrzesunieciaDo, StringFormat=dd.MM.yyyy}" Width="100"/>
                                <DataGridTextColumn Header="NOWA GODZINA" Binding="{Binding NowaGodzinaStart, StringFormat=HH\\:mm}" Width="110"/>
                                <DataGridTextColumn Header="POWÃ“D" Binding="{Binding Powod}" Width="200"/>
                                <DataGridTemplateColumn Header="STATUS" Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Border CornerRadius="4" Padding="8,4" HorizontalAlignment="Left"
                                                    Background="{Binding StatusKolor}">
                                                <TextBlock Text="{Binding Status}" FontSize="11" FontWeight="SemiBold" Foreground="White"/>
                                            </Border>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="UTWORZONO" Binding="{Binding DataUtworzenia, StringFormat=dd.MM.yyyy HH:mm}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Border>
                </Grid>
            </TabItem>

        </TabControl>

        <!-- STOPKA -->
        <Border Grid.Row="3" Background="White" BorderBrush="#E2E8F0" BorderThickness="0,1,0,0" Padding="20,8">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="UNICARD v2.0" FontSize="10" Foreground="#718096"/>
                    <TextBlock Text=" â€¢ " FontSize="10" Foreground="#CBD5E0"/>
                    <TextBlock Text="192.168.0.23\SQLEXPRESS" FontSize="10" Foreground="#718096"/>
                    <TextBlock Text=" â€¢ " FontSize="10" Foreground="#CBD5E0"/>
                    <TextBlock x:Name="txtStatusPolaczenia" Text="ðŸŸ¢ PoÅ‚Ä…czono" FontSize="10" Foreground="#38A169" FontWeight="SemiBold"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <TextBlock x:Name="txtLiczbaRejestracjiFooter" Text="0 rejestracji" FontSize="10" Foreground="#718096"/>
                    <TextBlock Text=" â€¢ " FontSize="10" Foreground="#CBD5E0"/>
                    <TextBlock x:Name="txtOstatnieOdswiezenie" Text="OdÅ›wieÅ¼ono: --:--:--" FontSize="10" Foreground="#718096"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
