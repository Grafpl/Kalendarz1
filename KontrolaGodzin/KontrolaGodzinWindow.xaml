<Window x:Class="Kalendarz1.KontrolaGodzin.KontrolaGodzinWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Kontrola Czasu Pracy - UNICARD" 
        Height="900" Width="1500"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="#F5F7FA"
        FontFamily="Segoe UI"
        Loaded="Window_Loaded">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- NAGLOWEK -->
        <Border Grid.Row="0" Background="#263238" CornerRadius="8" Padding="20,15" Margin="0,0,0,12">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="⏱️" FontSize="32" VerticalAlignment="Center" Margin="0,0,15,0"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="KONTROLA CZASU PRACY" FontSize="22" FontWeight="Bold" Foreground="White"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="System UNICARD" FontSize="12" Foreground="#B0BEC5" Margin="0,3,0,0"/>
                            <TextBlock Text=" | " FontSize="12" Foreground="#546E7A" Margin="0,3,0,0"/>
                            <TextBlock x:Name="txtZakresDat" Text="Dane z: dziś" FontSize="12" Foreground="#4FC3F7" Margin="0,3,0,0" FontWeight="SemiBold"/>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <TextBlock x:Name="txtAktualnaData" Text="" FontSize="12" Foreground="#B0BEC5" VerticalAlignment="Center" Margin="0,0,20,0"/>
                    <TextBlock x:Name="txtAktualnaGodzina" Text="" FontSize="18" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- FILTRY -->
        <Border Grid.Row="1" Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,12">
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Od:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <DatePicker x:Name="dpOd" Width="120" VerticalAlignment="Center"
                                SelectedDateChanged="DpOd_SelectedDateChanged"/>

                    <TextBlock Text="Do:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="20,0,8,0"/>
                    <DatePicker x:Name="dpDo" Width="120" VerticalAlignment="Center"
                                SelectedDateChanged="DpDo_SelectedDateChanged"/>

                    <CheckBox x:Name="chkTylkoDzisiaj" Content="Tylko dziś" IsChecked="True" 
                              VerticalAlignment="Center" Margin="20,0,0,0" FontWeight="SemiBold"
                              Checked="ChkTylkoDzisiaj_Changed" Unchecked="ChkTylkoDzisiaj_Changed"/>

                    <Button Content="Wczoraj" Padding="8,4" Margin="15,0,0,0" FontSize="11"
                            Background="#ECEFF1" BorderThickness="0" Click="BtnWczoraj_Click"/>
                    <Button Content="Tydzień" Padding="8,4" Margin="5,0,0,0" FontSize="11"
                            Background="#ECEFF1" BorderThickness="0" Click="BtnTydzien_Click"/>
                    <Button Content="Miesiąc" Padding="8,4" Margin="5,0,0,0" FontSize="11"
                            Background="#ECEFF1" BorderThickness="0" Click="BtnMiesiac_Click"/>

                    <TextBlock Text="Grupa:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="30,0,8,0"/>
                    <ComboBox x:Name="cmbGrupa" Width="220" VerticalAlignment="Center"
                              SelectionChanged="CmbGrupa_SelectionChanged"/>

                    <TextBlock Text="Szukaj:" FontWeight="SemiBold" VerticalAlignment="Center" Margin="20,0,8,0"/>
                    <TextBox x:Name="txtSzukaj" Width="150" VerticalAlignment="Center" Padding="8,6"
                             TextChanged="TxtSzukaj_TextChanged"/>
                    <Button Content="✕" Padding="6,4" Margin="3,0,0,0" FontSize="10"
                            Background="#FFCDD2" BorderThickness="0" Click="BtnWyczyscSzukaj_Click"
                            ToolTip="Wyczyść filtr"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="btnOdswiez" Content="Odśwież" Padding="15,8" Margin="0,0,10,0"
                            Background="#2196F3" Foreground="White" FontWeight="SemiBold"
                            BorderThickness="0" Click="BtnOdswiez_Click"/>
                    <Button x:Name="btnExport" Content="Export CSV" Padding="15,8"
                            Background="#4CAF50" Foreground="White" FontWeight="SemiBold"
                            BorderThickness="0" Click="BtnExport_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- STATYSTYKI -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,12">
            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Rejestracji" FontSize="11" Foreground="#78909C"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="txtStatRejestracje" Text="0" FontSize="24" FontWeight="Bold" Foreground="#2196F3"/>
                        <TextBlock x:Name="txtStatRejestracjeFiltr" Text="" FontSize="12" Foreground="#90A4AE" VerticalAlignment="Bottom" Margin="5,0,0,3"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Obecnych" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatObecni" Text="0" FontSize="24" FontWeight="Bold" Foreground="#4CAF50"/>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Godz. efektywne" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatGodziny" Text="0h" FontSize="24" FontWeight="Bold" Foreground="#FF9800"/>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Pracowników" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatPracownicy" Text="0" FontSize="24" FontWeight="Bold" Foreground="#9C27B0"/>
                </StackPanel>
            </Border>

            <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,12,0" Width="160">
                <StackPanel>
                    <TextBlock Text="Alertów" FontSize="11" Foreground="#78909C"/>
                    <TextBlock x:Name="txtStatAlerty" Text="0" FontSize="24" FontWeight="Bold" Foreground="#F44336"/>
                </StackPanel>
            </Border>

            <Border x:Name="panelLadowanie" Background="White" CornerRadius="8" Padding="15" Width="160" Visibility="Collapsed">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    <TextBlock Text="Ładowanie..." FontSize="11" Foreground="#78909C" HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- ZAKLADKI -->
        <Border Grid.Row="3" Background="White" CornerRadius="8" Padding="5">
            <TabControl x:Name="tabControl" BorderThickness="0">
                
                <TabItem Header="Rejestracje">
                    <DataGrid x:Name="gridRejestracje" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Data" Binding="{Binding DataCzas, StringFormat=dd.MM}" Width="55"/>
                            <DataGridTextColumn Header="Godzina" Binding="{Binding Godzina}" Width="70"/>
                            <DataGridTextColumn Header="Typ" Binding="{Binding Typ}" Width="65"/>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="170"/>
                            <DataGridTextColumn Header="Dział / Agencja" Binding="{Binding Grupa}" Width="140"/>
                            <DataGridTextColumn Header="Punkt dostępu" Binding="{Binding PunktDostepu}" Width="140"/>
                            <DataGridTextColumn Header="Rodzaj" Binding="{Binding TypPunktu}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Godziny Pracy">
                    <DataGrid x:Name="gridGodzinyPracy" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="160"/>
                            <DataGridTextColumn Header="Dział" Binding="{Binding Grupa}" Width="100"/>
                            <DataGridTextColumn Header="Data" Binding="{Binding Data, StringFormat=dd.MM}" Width="50"/>
                            <DataGridTextColumn Header="Wejście" Binding="{Binding PierwszeWejscie}" Width="55"/>
                            <DataGridTextColumn Header="Wyjście" Binding="{Binding OstatnieWyjscie}" Width="55"/>
                            <DataGridTextColumn Header="Na miejscu" Binding="{Binding CzasPracy}" Width="75"/>
                            <DataGridTextColumn Header="Przerwy" Binding="{Binding LiczbaPrzerw}" Width="50"/>
                            <DataGridTextColumn Header="Czas przerw" Binding="{Binding CzasPrzerw}" Width="75"/>
                            <DataGridTextColumn Header="Efektywnie" Binding="{Binding CzasEfektywny}" Width="75"/>
                            <DataGridTextColumn Header="We" Binding="{Binding LiczbaWejsc}" Width="35"/>
                            <DataGridTextColumn Header="Wy" Binding="{Binding LiczbaWyjsc}" Width="35"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Obecnie na Terenie">
                    <DataGrid x:Name="gridObecni" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="180"/>
                            <DataGridTextColumn Header="Dział / Agencja" Binding="{Binding Grupa}" Width="160"/>
                            <DataGridTextColumn Header="Wejście" Binding="{Binding Godzina}" Width="90"/>
                            <DataGridTextColumn Header="Na terenie" Binding="{Binding CzasNaTerenie}" Width="100"/>
                            <DataGridTextColumn Header="Punkt dostępu" Binding="{Binding PunktDostepu}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Podsumowanie Agencji">
                    <DataGrid x:Name="gridPodsumowanie" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Dział / Agencja" Binding="{Binding Grupa}" Width="160"/>
                            <DataGridTextColumn Header="Pracownicy" Binding="{Binding LiczbaPracownikow}" Width="80"/>
                            <DataGridTextColumn Header="Godz. efekt." Binding="{Binding SumaGodzin, StringFormat=N1}" Width="90"/>
                            <DataGridTextColumn Header="Średnia/os." Binding="{Binding SredniaGodzin, StringFormat=N1}" Width="80"/>
                            <DataGridTextColumn Header="Godz. przerw" Binding="{Binding SumaPrzerw, StringFormat=N1}" Width="90"/>
                            <DataGridTextColumn Header="Teraz obecni" Binding="{Binding Obecni}" Width="90"/>
                            <DataGridTextColumn Header="Braki wyjść" Binding="{Binding BrakiWyjsc}" Width="80"/>
                            <DataGridTextColumn Header="Problemy" Binding="{Binding Przekroczenia}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>

                <TabItem Header="Alerty">
                    <DataGrid x:Name="gridAlerty" AutoGenerateColumns="False" IsReadOnly="True"
                              CanUserAddRows="False" RowHeaderWidth="0" GridLinesVisibility="Horizontal"
                              BorderThickness="0">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Typ alertu" Binding="{Binding Typ}" Width="140"/>
                            <DataGridTextColumn Header="Priorytet" Binding="{Binding Priorytet}" Width="80"/>
                            <DataGridTextColumn Header="Pracownik" Binding="{Binding Pracownik}" Width="160"/>
                            <DataGridTextColumn Header="Dział / Agencja" Binding="{Binding Grupa}" Width="140"/>
                            <DataGridTextColumn Header="Data" Binding="{Binding Data, StringFormat=dd.MM.yyyy}" Width="90"/>
                            <DataGridTextColumn Header="Opis problemu" Binding="{Binding Opis}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </TabItem>
                
            </TabControl>
        </Border>
    </Grid>
</Window>
